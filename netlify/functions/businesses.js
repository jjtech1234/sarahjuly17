"use strict";var Zn=Object.defineProperty;var Qu=Object.getOwnPropertyDescriptor;var qu=Object.getOwnPropertyNames;var Fu=Object.prototype.hasOwnProperty;var Uu=(r,e)=>{for(var t in e)Zn(r,t,{get:e[t],enumerable:!0})},zu=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of qu(e))!Fu.call(r,s)&&s!==t&&Zn(r,s,{get:()=>e[s],enumerable:!(n=Qu(e,s))||n.enumerable});return r};var Vu=r=>zu(Zn({},"__esModule",{value:!0}),r);var wh={};Uu(wh,{handler:()=>vh});module.exports=Vu(wh);var Ku=Object.create,er=Object.defineProperty,Zu=Object.getOwnPropertyDescriptor,Wu=Object.getOwnPropertyNames,Gu=Object.getPrototypeOf,Hu=Object.prototype.hasOwnProperty,Ju=(r,e,t)=>e in r?er(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,m=(r,e)=>er(r,"name",{value:e,configurable:!0}),je=(r,e)=>()=>(r&&(e=r(r=0)),e),le=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Je=(r,e)=>{for(var t in e)er(r,t,{get:e[t],enumerable:!0})},fo=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Wu(e))!Hu.call(r,s)&&s!==t&&er(r,s,{get:()=>e[s],enumerable:!(n=Zu(e,s))||n.enumerable});return r},tr=(r,e,t)=>(t=r!=null?Ku(Gu(r)):{},fo(e||!r||!r.__esModule?er(t,"default",{value:r,enumerable:!0}):t,r)),ke=r=>fo(er({},"__esModule",{value:!0}),r),se=(r,e,t)=>Ju(r,typeof e!="symbol"?e+"":e,t),Xu=le(r=>{"use strict";X(),r.byteLength=h,r.toByteArray=f,r.fromByteArray=w;var e=[],t=[],n=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(i=0,a=s.length;i<a;++i)e[i]=s[i],t[s.charCodeAt(i)]=i;var i,a;t[45]=62,t[95]=63;function o(g){var l=g.length;if(l%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=g.indexOf("=");v===-1&&(v=l);var S=v===l?0:4-v%4;return[v,S]}m(o,"getLens");function h(g){var l=o(g),v=l[0],S=l[1];return(v+S)*3/4-S}m(h,"byteLength");function p(g,l,v){return(l+v)*3/4-v}m(p,"_byteLength");function f(g){var l,v=o(g),S=v[0],x=v[1],T=new n(p(g,S,x)),O=0,L=x>0?S-4:S,_;for(_=0;_<L;_+=4)l=t[g.charCodeAt(_)]<<18|t[g.charCodeAt(_+1)]<<12|t[g.charCodeAt(_+2)]<<6|t[g.charCodeAt(_+3)],T[O++]=l>>16&255,T[O++]=l>>8&255,T[O++]=l&255;return x===2&&(l=t[g.charCodeAt(_)]<<2|t[g.charCodeAt(_+1)]>>4,T[O++]=l&255),x===1&&(l=t[g.charCodeAt(_)]<<10|t[g.charCodeAt(_+1)]<<4|t[g.charCodeAt(_+2)]>>2,T[O++]=l>>8&255,T[O++]=l&255),T}m(f,"toByteArray");function y(g){return e[g>>18&63]+e[g>>12&63]+e[g>>6&63]+e[g&63]}m(y,"tripletToBase64");function b(g,l,v){for(var S,x=[],T=l;T<v;T+=3)S=(g[T]<<16&16711680)+(g[T+1]<<8&65280)+(g[T+2]&255),x.push(y(S));return x.join("")}m(b,"encodeChunk");function w(g){for(var l,v=g.length,S=v%3,x=[],T=16383,O=0,L=v-S;O<L;O+=T)x.push(b(g,O,O+T>L?L:O+T));return S===1?(l=g[v-1],x.push(e[l>>2]+e[l<<4&63]+"==")):S===2&&(l=(g[v-2]<<8)+g[v-1],x.push(e[l>>10]+e[l>>4&63]+e[l<<2&63]+"=")),x.join("")}m(w,"fromByteArray")}),Yu=le(r=>{X(),r.read=function(e,t,n,s,i){var a,o,h=i*8-s-1,p=(1<<h)-1,f=p>>1,y=-7,b=n?i-1:0,w=n?-1:1,g=e[t+b];for(b+=w,a=g&(1<<-y)-1,g>>=-y,y+=h;y>0;a=a*256+e[t+b],b+=w,y-=8);for(o=a&(1<<-y)-1,a>>=-y,y+=s;y>0;o=o*256+e[t+b],b+=w,y-=8);if(a===0)a=1-f;else{if(a===p)return o?NaN:(g?-1:1)*(1/0);o=o+Math.pow(2,s),a=a-f}return(g?-1:1)*o*Math.pow(2,a-s)},r.write=function(e,t,n,s,i,a){var o,h,p,f=a*8-i-1,y=(1<<f)-1,b=y>>1,w=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=s?0:a-1,l=s?1:-1,v=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(h=isNaN(t)?1:0,o=y):(o=Math.floor(Math.log(t)/Math.LN2),t*(p=Math.pow(2,-o))<1&&(o--,p*=2),o+b>=1?t+=w/p:t+=w*Math.pow(2,1-b),t*p>=2&&(o++,p/=2),o+b>=y?(h=0,o=y):o+b>=1?(h=(t*p-1)*Math.pow(2,i),o=o+b):(h=t*Math.pow(2,b-1)*Math.pow(2,i),o=0));i>=8;e[n+g]=h&255,g+=l,h/=256,i-=8);for(o=o<<i|h,f+=i;f>0;e[n+g]=o&255,g+=l,o/=256,f-=8);e[n+g-l]|=v*128}}),el=le(r=>{"use strict";X();var e=Xu(),t=Yu(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=o,r.SlowBuffer=x,r.INSPECT_MAX_BYTES=50;var s=2147483647;r.kMaxLength=s,o.TYPED_ARRAY_SUPPORT=i(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{let u=new Uint8Array(1),c={foo:m(function(){return 42},"foo")};return Object.setPrototypeOf(c,Uint8Array.prototype),Object.setPrototypeOf(u,c),u.foo()===42}catch{return!1}}m(i,"typedArraySupport"),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:m(function(){if(o.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:m(function(){if(o.isBuffer(this))return this.byteOffset},"get")});function a(u){if(u>s)throw new RangeError('The value "'+u+'" is invalid for option "size"');let c=new Uint8Array(u);return Object.setPrototypeOf(c,o.prototype),c}m(a,"createBuffer");function o(u,c,d){if(typeof u=="number"){if(typeof c=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(u)}return h(u,c,d)}m(o,"Buffer"),o.poolSize=8192;function h(u,c,d){if(typeof u=="string")return b(u,c);if(ArrayBuffer.isView(u))return g(u);if(u==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof u);if(He(u,ArrayBuffer)||u&&He(u.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(He(u,SharedArrayBuffer)||u&&He(u.buffer,SharedArrayBuffer)))return l(u,c,d);if(typeof u=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let A=u.valueOf&&u.valueOf();if(A!=null&&A!==u)return o.from(A,c,d);let k=v(u);if(k)return k;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof u[Symbol.toPrimitive]=="function")return o.from(u[Symbol.toPrimitive]("string"),c,d);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof u)}m(h,"from"),o.from=function(u,c,d){return h(u,c,d)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array);function p(u){if(typeof u!="number")throw new TypeError('"size" argument must be of type number');if(u<0)throw new RangeError('The value "'+u+'" is invalid for option "size"')}m(p,"assertSize");function f(u,c,d){return p(u),u<=0?a(u):c!==void 0?typeof d=="string"?a(u).fill(c,d):a(u).fill(c):a(u)}m(f,"alloc"),o.alloc=function(u,c,d){return f(u,c,d)};function y(u){return p(u),a(u<0?0:S(u)|0)}m(y,"allocUnsafe"),o.allocUnsafe=function(u){return y(u)},o.allocUnsafeSlow=function(u){return y(u)};function b(u,c){if((typeof c!="string"||c==="")&&(c="utf8"),!o.isEncoding(c))throw new TypeError("Unknown encoding: "+c);let d=T(u,c)|0,A=a(d),k=A.write(u,c);return k!==d&&(A=A.slice(0,k)),A}m(b,"fromString");function w(u){let c=u.length<0?0:S(u.length)|0,d=a(c);for(let A=0;A<c;A+=1)d[A]=u[A]&255;return d}m(w,"fromArrayLike");function g(u){if(He(u,Uint8Array)){let c=new Uint8Array(u);return l(c.buffer,c.byteOffset,c.byteLength)}return w(u)}m(g,"fromArrayView");function l(u,c,d){if(c<0||u.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(u.byteLength<c+(d||0))throw new RangeError('"length" is outside of buffer bounds');let A;return c===void 0&&d===void 0?A=new Uint8Array(u):d===void 0?A=new Uint8Array(u,c):A=new Uint8Array(u,c,d),Object.setPrototypeOf(A,o.prototype),A}m(l,"fromArrayBuffer");function v(u){if(o.isBuffer(u)){let c=S(u.length)|0,d=a(c);return d.length===0||u.copy(d,0,0,c),d}if(u.length!==void 0)return typeof u.length!="number"||Xr(u.length)?a(0):w(u);if(u.type==="Buffer"&&Array.isArray(u.data))return w(u.data)}m(v,"fromObject");function S(u){if(u>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return u|0}m(S,"checked");function x(u){return+u!=u&&(u=0),o.alloc(+u)}m(x,"SlowBuffer"),o.isBuffer=m(function(u){return u!=null&&u._isBuffer===!0&&u!==o.prototype},"isBuffer"),o.compare=m(function(u,c){if(He(u,Uint8Array)&&(u=o.from(u,u.offset,u.byteLength)),He(c,Uint8Array)&&(c=o.from(c,c.offset,c.byteLength)),!o.isBuffer(u)||!o.isBuffer(c))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(u===c)return 0;let d=u.length,A=c.length;for(let k=0,D=Math.min(d,A);k<D;++k)if(u[k]!==c[k]){d=u[k],A=c[k];break}return d<A?-1:A<d?1:0},"compare"),o.isEncoding=m(function(u){switch(String(u).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),o.concat=m(function(u,c){if(!Array.isArray(u))throw new TypeError('"list" argument must be an Array of Buffers');if(u.length===0)return o.alloc(0);let d;if(c===void 0)for(c=0,d=0;d<u.length;++d)c+=u[d].length;let A=o.allocUnsafe(c),k=0;for(d=0;d<u.length;++d){let D=u[d];if(He(D,Uint8Array))k+D.length>A.length?(o.isBuffer(D)||(D=o.from(D)),D.copy(A,k)):Uint8Array.prototype.set.call(A,D,k);else if(o.isBuffer(D))D.copy(A,k);else throw new TypeError('"list" argument must be an Array of Buffers');k+=D.length}return A},"concat");function T(u,c){if(o.isBuffer(u))return u.length;if(ArrayBuffer.isView(u)||He(u,ArrayBuffer))return u.byteLength;if(typeof u!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof u);let d=u.length,A=arguments.length>2&&arguments[2]===!0;if(!A&&d===0)return 0;let k=!1;for(;;)switch(c){case"ascii":case"latin1":case"binary":return d;case"utf8":case"utf-8":return Jr(u).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d*2;case"hex":return d>>>1;case"base64":return Kn(u).length;default:if(k)return A?-1:Jr(u).length;c=(""+c).toLowerCase(),k=!0}}m(T,"byteLength"),o.byteLength=T;function O(u,c,d){let A=!1;if((c===void 0||c<0)&&(c=0),c>this.length||((d===void 0||d>this.length)&&(d=this.length),d<=0)||(d>>>=0,c>>>=0,d<=c))return"";for(u||(u="utf8");;)switch(u){case"hex":return pe(this,c,d);case"utf8":case"utf-8":return M(this,c,d);case"ascii":return ie(this,c,d);case"latin1":case"binary":return fe(this,c,d);case"base64":return W(this,c,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Pe(this,c,d);default:if(A)throw new TypeError("Unknown encoding: "+u);u=(u+"").toLowerCase(),A=!0}}m(O,"slowToString"),o.prototype._isBuffer=!0;function L(u,c,d){let A=u[c];u[c]=u[d],u[d]=A}m(L,"swap"),o.prototype.swap16=m(function(){let u=this.length;if(u%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let c=0;c<u;c+=2)L(this,c,c+1);return this},"swap16"),o.prototype.swap32=m(function(){let u=this.length;if(u%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let c=0;c<u;c+=4)L(this,c,c+3),L(this,c+1,c+2);return this},"swap32"),o.prototype.swap64=m(function(){let u=this.length;if(u%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let c=0;c<u;c+=8)L(this,c,c+7),L(this,c+1,c+6),L(this,c+2,c+5),L(this,c+3,c+4);return this},"swap64"),o.prototype.toString=m(function(){let u=this.length;return u===0?"":arguments.length===0?M(this,0,u):O.apply(this,arguments)},"toString"),o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=m(function(u){if(!o.isBuffer(u))throw new TypeError("Argument must be a Buffer");return this===u?!0:o.compare(this,u)===0},"equals"),o.prototype.inspect=m(function(){let u="",c=r.INSPECT_MAX_BYTES;return u=this.toString("hex",0,c).replace(/(.{2})/g,"$1 ").trim(),this.length>c&&(u+=" ... "),"<Buffer "+u+">"},"inspect"),n&&(o.prototype[n]=o.prototype.inspect),o.prototype.compare=m(function(u,c,d,A,k){if(He(u,Uint8Array)&&(u=o.from(u,u.offset,u.byteLength)),!o.isBuffer(u))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof u);if(c===void 0&&(c=0),d===void 0&&(d=u?u.length:0),A===void 0&&(A=0),k===void 0&&(k=this.length),c<0||d>u.length||A<0||k>this.length)throw new RangeError("out of range index");if(A>=k&&c>=d)return 0;if(A>=k)return-1;if(c>=d)return 1;if(c>>>=0,d>>>=0,A>>>=0,k>>>=0,this===u)return 0;let D=k-A,Q=d-c,be=Math.min(D,Q),Ie=this.slice(A,k),we=u.slice(c,d);for(let ve=0;ve<be;++ve)if(Ie[ve]!==we[ve]){D=Ie[ve],Q=we[ve];break}return D<Q?-1:Q<D?1:0},"compare");function _(u,c,d,A,k){if(u.length===0)return-1;if(typeof d=="string"?(A=d,d=0):d>2147483647?d=2147483647:d<-2147483648&&(d=-2147483648),d=+d,Xr(d)&&(d=k?0:u.length-1),d<0&&(d=u.length+d),d>=u.length){if(k)return-1;d=u.length-1}else if(d<0)if(k)d=0;else return-1;if(typeof c=="string"&&(c=o.from(c,A)),o.isBuffer(c))return c.length===0?-1:I(u,c,d,A,k);if(typeof c=="number")return c=c&255,typeof Uint8Array.prototype.indexOf=="function"?k?Uint8Array.prototype.indexOf.call(u,c,d):Uint8Array.prototype.lastIndexOf.call(u,c,d):I(u,[c],d,A,k);throw new TypeError("val must be string, number or Buffer")}m(_,"bidirectionalIndexOf");function I(u,c,d,A,k){let D=1,Q=u.length,be=c.length;if(A!==void 0&&(A=String(A).toLowerCase(),A==="ucs2"||A==="ucs-2"||A==="utf16le"||A==="utf-16le")){if(u.length<2||c.length<2)return-1;D=2,Q/=2,be/=2,d/=2}function Ie(ve,Te){return D===1?ve[Te]:ve.readUInt16BE(Te*D)}m(Ie,"read");let we;if(k){let ve=-1;for(we=d;we<Q;we++)if(Ie(u,we)===Ie(c,ve===-1?0:we-ve)){if(ve===-1&&(ve=we),we-ve+1===be)return ve*D}else ve!==-1&&(we-=we-ve),ve=-1}else for(d+be>Q&&(d=Q-be),we=d;we>=0;we--){let ve=!0;for(let Te=0;Te<be;Te++)if(Ie(u,we+Te)!==Ie(c,Te)){ve=!1;break}if(ve)return we}return-1}m(I,"arrayIndexOf"),o.prototype.includes=m(function(u,c,d){return this.indexOf(u,c,d)!==-1},"includes"),o.prototype.indexOf=m(function(u,c,d){return _(this,u,c,d,!0)},"indexOf"),o.prototype.lastIndexOf=m(function(u,c,d){return _(this,u,c,d,!1)},"lastIndexOf");function P(u,c,d,A){d=Number(d)||0;let k=u.length-d;A?(A=Number(A),A>k&&(A=k)):A=k;let D=c.length;A>D/2&&(A=D/2);let Q;for(Q=0;Q<A;++Q){let be=parseInt(c.substr(Q*2,2),16);if(Xr(be))return Q;u[d+Q]=be}return Q}m(P,"hexWrite");function E(u,c,d,A){return wr(Jr(c,u.length-d),u,d,A)}m(E,"utf8Write");function $(u,c,d,A){return wr(oo(c),u,d,A)}m($,"asciiWrite");function R(u,c,d,A){return wr(Kn(c),u,d,A)}m(R,"base64Write");function Z(u,c,d,A){return wr(ao(c,u.length-d),u,d,A)}m(Z,"ucs2Write"),o.prototype.write=m(function(u,c,d,A){if(c===void 0)A="utf8",d=this.length,c=0;else if(d===void 0&&typeof c=="string")A=c,d=this.length,c=0;else if(isFinite(c))c=c>>>0,isFinite(d)?(d=d>>>0,A===void 0&&(A="utf8")):(A=d,d=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let k=this.length-c;if((d===void 0||d>k)&&(d=k),u.length>0&&(d<0||c<0)||c>this.length)throw new RangeError("Attempt to write outside buffer bounds");A||(A="utf8");let D=!1;for(;;)switch(A){case"hex":return P(this,u,c,d);case"utf8":case"utf-8":return E(this,u,c,d);case"ascii":case"latin1":case"binary":return $(this,u,c,d);case"base64":return R(this,u,c,d);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z(this,u,c,d);default:if(D)throw new TypeError("Unknown encoding: "+A);A=(""+A).toLowerCase(),D=!0}},"write"),o.prototype.toJSON=m(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function W(u,c,d){return c===0&&d===u.length?e.fromByteArray(u):e.fromByteArray(u.slice(c,d))}m(W,"base64Slice");function M(u,c,d){d=Math.min(u.length,d);let A=[],k=c;for(;k<d;){let D=u[k],Q=null,be=D>239?4:D>223?3:D>191?2:1;if(k+be<=d){let Ie,we,ve,Te;switch(be){case 1:D<128&&(Q=D);break;case 2:Ie=u[k+1],(Ie&192)===128&&(Te=(D&31)<<6|Ie&63,Te>127&&(Q=Te));break;case 3:Ie=u[k+1],we=u[k+2],(Ie&192)===128&&(we&192)===128&&(Te=(D&15)<<12|(Ie&63)<<6|we&63,Te>2047&&(Te<55296||Te>57343)&&(Q=Te));break;case 4:Ie=u[k+1],we=u[k+2],ve=u[k+3],(Ie&192)===128&&(we&192)===128&&(ve&192)===128&&(Te=(D&15)<<18|(Ie&63)<<12|(we&63)<<6|ve&63,Te>65535&&Te<1114112&&(Q=Te))}}Q===null?(Q=65533,be=1):Q>65535&&(Q-=65536,A.push(Q>>>10&1023|55296),Q=56320|Q&1023),A.push(Q),k+=be}return J(A)}m(M,"utf8Slice");var F=4096;function J(u){let c=u.length;if(c<=F)return String.fromCharCode.apply(String,u);let d="",A=0;for(;A<c;)d+=String.fromCharCode.apply(String,u.slice(A,A+=F));return d}m(J,"decodeCodePointsArray");function ie(u,c,d){let A="";d=Math.min(u.length,d);for(let k=c;k<d;++k)A+=String.fromCharCode(u[k]&127);return A}m(ie,"asciiSlice");function fe(u,c,d){let A="";d=Math.min(u.length,d);for(let k=c;k<d;++k)A+=String.fromCharCode(u[k]);return A}m(fe,"latin1Slice");function pe(u,c,d){let A=u.length;(!c||c<0)&&(c=0),(!d||d<0||d>A)&&(d=A);let k="";for(let D=c;D<d;++D)k+=ju[u[D]];return k}m(pe,"hexSlice");function Pe(u,c,d){let A=u.slice(c,d),k="";for(let D=0;D<A.length-1;D+=2)k+=String.fromCharCode(A[D]+A[D+1]*256);return k}m(Pe,"utf16leSlice"),o.prototype.slice=m(function(u,c){let d=this.length;u=~~u,c=c===void 0?d:~~c,u<0?(u+=d,u<0&&(u=0)):u>d&&(u=d),c<0?(c+=d,c<0&&(c=0)):c>d&&(c=d),c<u&&(c=u);let A=this.subarray(u,c);return Object.setPrototypeOf(A,o.prototype),A},"slice");function ye(u,c,d){if(u%1!==0||u<0)throw new RangeError("offset is not uint");if(u+c>d)throw new RangeError("Trying to access beyond buffer length")}m(ye,"checkOffset"),o.prototype.readUintLE=o.prototype.readUIntLE=m(function(u,c,d){u=u>>>0,c=c>>>0,d||ye(u,c,this.length);let A=this[u],k=1,D=0;for(;++D<c&&(k*=256);)A+=this[u+D]*k;return A},"readUIntLE"),o.prototype.readUintBE=o.prototype.readUIntBE=m(function(u,c,d){u=u>>>0,c=c>>>0,d||ye(u,c,this.length);let A=this[u+--c],k=1;for(;c>0&&(k*=256);)A+=this[u+--c]*k;return A},"readUIntBE"),o.prototype.readUint8=o.prototype.readUInt8=m(function(u,c){return u=u>>>0,c||ye(u,1,this.length),this[u]},"readUInt8"),o.prototype.readUint16LE=o.prototype.readUInt16LE=m(function(u,c){return u=u>>>0,c||ye(u,2,this.length),this[u]|this[u+1]<<8},"readUInt16LE"),o.prototype.readUint16BE=o.prototype.readUInt16BE=m(function(u,c){return u=u>>>0,c||ye(u,2,this.length),this[u]<<8|this[u+1]},"readUInt16BE"),o.prototype.readUint32LE=o.prototype.readUInt32LE=m(function(u,c){return u=u>>>0,c||ye(u,4,this.length),(this[u]|this[u+1]<<8|this[u+2]<<16)+this[u+3]*16777216},"readUInt32LE"),o.prototype.readUint32BE=o.prototype.readUInt32BE=m(function(u,c){return u=u>>>0,c||ye(u,4,this.length),this[u]*16777216+(this[u+1]<<16|this[u+2]<<8|this[u+3])},"readUInt32BE"),o.prototype.readBigUInt64LE=at(m(function(u){u=u>>>0,Pt(u,"offset");let c=this[u],d=this[u+7];(c===void 0||d===void 0)&&Xt(u,this.length-8);let A=c+this[++u]*2**8+this[++u]*2**16+this[++u]*2**24,k=this[++u]+this[++u]*2**8+this[++u]*2**16+d*2**24;return BigInt(A)+(BigInt(k)<<BigInt(32))},"readBigUInt64LE")),o.prototype.readBigUInt64BE=at(m(function(u){u=u>>>0,Pt(u,"offset");let c=this[u],d=this[u+7];(c===void 0||d===void 0)&&Xt(u,this.length-8);let A=c*2**24+this[++u]*2**16+this[++u]*2**8+this[++u],k=this[++u]*2**24+this[++u]*2**16+this[++u]*2**8+d;return(BigInt(A)<<BigInt(32))+BigInt(k)},"readBigUInt64BE")),o.prototype.readIntLE=m(function(u,c,d){u=u>>>0,c=c>>>0,d||ye(u,c,this.length);let A=this[u],k=1,D=0;for(;++D<c&&(k*=256);)A+=this[u+D]*k;return k*=128,A>=k&&(A-=Math.pow(2,8*c)),A},"readIntLE"),o.prototype.readIntBE=m(function(u,c,d){u=u>>>0,c=c>>>0,d||ye(u,c,this.length);let A=c,k=1,D=this[u+--A];for(;A>0&&(k*=256);)D+=this[u+--A]*k;return k*=128,D>=k&&(D-=Math.pow(2,8*c)),D},"readIntBE"),o.prototype.readInt8=m(function(u,c){return u=u>>>0,c||ye(u,1,this.length),this[u]&128?(255-this[u]+1)*-1:this[u]},"readInt8"),o.prototype.readInt16LE=m(function(u,c){u=u>>>0,c||ye(u,2,this.length);let d=this[u]|this[u+1]<<8;return d&32768?d|4294901760:d},"readInt16LE"),o.prototype.readInt16BE=m(function(u,c){u=u>>>0,c||ye(u,2,this.length);let d=this[u+1]|this[u]<<8;return d&32768?d|4294901760:d},"readInt16BE"),o.prototype.readInt32LE=m(function(u,c){return u=u>>>0,c||ye(u,4,this.length),this[u]|this[u+1]<<8|this[u+2]<<16|this[u+3]<<24},"readInt32LE"),o.prototype.readInt32BE=m(function(u,c){return u=u>>>0,c||ye(u,4,this.length),this[u]<<24|this[u+1]<<16|this[u+2]<<8|this[u+3]},"readInt32BE"),o.prototype.readBigInt64LE=at(m(function(u){u=u>>>0,Pt(u,"offset");let c=this[u],d=this[u+7];(c===void 0||d===void 0)&&Xt(u,this.length-8);let A=this[u+4]+this[u+5]*2**8+this[u+6]*2**16+(d<<24);return(BigInt(A)<<BigInt(32))+BigInt(c+this[++u]*2**8+this[++u]*2**16+this[++u]*2**24)},"readBigInt64LE")),o.prototype.readBigInt64BE=at(m(function(u){u=u>>>0,Pt(u,"offset");let c=this[u],d=this[u+7];(c===void 0||d===void 0)&&Xt(u,this.length-8);let A=(c<<24)+this[++u]*2**16+this[++u]*2**8+this[++u];return(BigInt(A)<<BigInt(32))+BigInt(this[++u]*2**24+this[++u]*2**16+this[++u]*2**8+d)},"readBigInt64BE")),o.prototype.readFloatLE=m(function(u,c){return u=u>>>0,c||ye(u,4,this.length),t.read(this,u,!0,23,4)},"readFloatLE"),o.prototype.readFloatBE=m(function(u,c){return u=u>>>0,c||ye(u,4,this.length),t.read(this,u,!1,23,4)},"readFloatBE"),o.prototype.readDoubleLE=m(function(u,c){return u=u>>>0,c||ye(u,8,this.length),t.read(this,u,!0,52,8)},"readDoubleLE"),o.prototype.readDoubleBE=m(function(u,c){return u=u>>>0,c||ye(u,8,this.length),t.read(this,u,!1,52,8)},"readDoubleBE");function Se(u,c,d,A,k,D){if(!o.isBuffer(u))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>k||c<D)throw new RangeError('"value" argument is out of bounds');if(d+A>u.length)throw new RangeError("Index out of range")}m(Se,"checkInt"),o.prototype.writeUintLE=o.prototype.writeUIntLE=m(function(u,c,d,A){if(u=+u,c=c>>>0,d=d>>>0,!A){let Q=Math.pow(2,8*d)-1;Se(this,u,c,d,Q,0)}let k=1,D=0;for(this[c]=u&255;++D<d&&(k*=256);)this[c+D]=u/k&255;return c+d},"writeUIntLE"),o.prototype.writeUintBE=o.prototype.writeUIntBE=m(function(u,c,d,A){if(u=+u,c=c>>>0,d=d>>>0,!A){let Q=Math.pow(2,8*d)-1;Se(this,u,c,d,Q,0)}let k=d-1,D=1;for(this[c+k]=u&255;--k>=0&&(D*=256);)this[c+k]=u/D&255;return c+d},"writeUIntBE"),o.prototype.writeUint8=o.prototype.writeUInt8=m(function(u,c,d){return u=+u,c=c>>>0,d||Se(this,u,c,1,255,0),this[c]=u&255,c+1},"writeUInt8"),o.prototype.writeUint16LE=o.prototype.writeUInt16LE=m(function(u,c,d){return u=+u,c=c>>>0,d||Se(this,u,c,2,65535,0),this[c]=u&255,this[c+1]=u>>>8,c+2},"writeUInt16LE"),o.prototype.writeUint16BE=o.prototype.writeUInt16BE=m(function(u,c,d){return u=+u,c=c>>>0,d||Se(this,u,c,2,65535,0),this[c]=u>>>8,this[c+1]=u&255,c+2},"writeUInt16BE"),o.prototype.writeUint32LE=o.prototype.writeUInt32LE=m(function(u,c,d){return u=+u,c=c>>>0,d||Se(this,u,c,4,4294967295,0),this[c+3]=u>>>24,this[c+2]=u>>>16,this[c+1]=u>>>8,this[c]=u&255,c+4},"writeUInt32LE"),o.prototype.writeUint32BE=o.prototype.writeUInt32BE=m(function(u,c,d){return u=+u,c=c>>>0,d||Se(this,u,c,4,4294967295,0),this[c]=u>>>24,this[c+1]=u>>>16,this[c+2]=u>>>8,this[c+3]=u&255,c+4},"writeUInt32BE");function Nt(u,c,d,A,k){Vn(c,A,k,u,d,7);let D=Number(c&BigInt(4294967295));u[d++]=D,D=D>>8,u[d++]=D,D=D>>8,u[d++]=D,D=D>>8,u[d++]=D;let Q=Number(c>>BigInt(32)&BigInt(4294967295));return u[d++]=Q,Q=Q>>8,u[d++]=Q,Q=Q>>8,u[d++]=Q,Q=Q>>8,u[d++]=Q,d}m(Nt,"wrtBigUInt64LE");function br(u,c,d,A,k){Vn(c,A,k,u,d,7);let D=Number(c&BigInt(4294967295));u[d+7]=D,D=D>>8,u[d+6]=D,D=D>>8,u[d+5]=D,D=D>>8,u[d+4]=D;let Q=Number(c>>BigInt(32)&BigInt(4294967295));return u[d+3]=Q,Q=Q>>8,u[d+2]=Q,Q=Q>>8,u[d+1]=Q,Q=Q>>8,u[d]=Q,d+8}m(br,"wrtBigUInt64BE"),o.prototype.writeBigUInt64LE=at(m(function(u,c=0){return Nt(this,u,c,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),o.prototype.writeBigUInt64BE=at(m(function(u,c=0){return br(this,u,c,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),o.prototype.writeIntLE=m(function(u,c,d,A){if(u=+u,c=c>>>0,!A){let be=Math.pow(2,8*d-1);Se(this,u,c,d,be-1,-be)}let k=0,D=1,Q=0;for(this[c]=u&255;++k<d&&(D*=256);)u<0&&Q===0&&this[c+k-1]!==0&&(Q=1),this[c+k]=(u/D>>0)-Q&255;return c+d},"writeIntLE"),o.prototype.writeIntBE=m(function(u,c,d,A){if(u=+u,c=c>>>0,!A){let be=Math.pow(2,8*d-1);Se(this,u,c,d,be-1,-be)}let k=d-1,D=1,Q=0;for(this[c+k]=u&255;--k>=0&&(D*=256);)u<0&&Q===0&&this[c+k+1]!==0&&(Q=1),this[c+k]=(u/D>>0)-Q&255;return c+d},"writeIntBE"),o.prototype.writeInt8=m(function(u,c,d){return u=+u,c=c>>>0,d||Se(this,u,c,1,127,-128),u<0&&(u=255+u+1),this[c]=u&255,c+1},"writeInt8"),o.prototype.writeInt16LE=m(function(u,c,d){return u=+u,c=c>>>0,d||Se(this,u,c,2,32767,-32768),this[c]=u&255,this[c+1]=u>>>8,c+2},"writeInt16LE"),o.prototype.writeInt16BE=m(function(u,c,d){return u=+u,c=c>>>0,d||Se(this,u,c,2,32767,-32768),this[c]=u>>>8,this[c+1]=u&255,c+2},"writeInt16BE"),o.prototype.writeInt32LE=m(function(u,c,d){return u=+u,c=c>>>0,d||Se(this,u,c,4,2147483647,-2147483648),this[c]=u&255,this[c+1]=u>>>8,this[c+2]=u>>>16,this[c+3]=u>>>24,c+4},"writeInt32LE"),o.prototype.writeInt32BE=m(function(u,c,d){return u=+u,c=c>>>0,d||Se(this,u,c,4,2147483647,-2147483648),u<0&&(u=4294967295+u+1),this[c]=u>>>24,this[c+1]=u>>>16,this[c+2]=u>>>8,this[c+3]=u&255,c+4},"writeInt32BE"),o.prototype.writeBigInt64LE=at(m(function(u,c=0){return Nt(this,u,c,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),o.prototype.writeBigInt64BE=at(m(function(u,c=0){return br(this,u,c,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function vr(u,c,d,A,k,D){if(d+A>u.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("Index out of range")}m(vr,"checkIEEE754");function Fn(u,c,d,A,k){return c=+c,d=d>>>0,k||vr(u,c,d,4,34028234663852886e22,-34028234663852886e22),t.write(u,c,d,A,23,4),d+4}m(Fn,"writeFloat"),o.prototype.writeFloatLE=m(function(u,c,d){return Fn(this,u,c,!0,d)},"writeFloatLE"),o.prototype.writeFloatBE=m(function(u,c,d){return Fn(this,u,c,!1,d)},"writeFloatBE");function Un(u,c,d,A,k){return c=+c,d=d>>>0,k||vr(u,c,d,8,17976931348623157e292,-17976931348623157e292),t.write(u,c,d,A,52,8),d+8}m(Un,"writeDouble"),o.prototype.writeDoubleLE=m(function(u,c,d){return Un(this,u,c,!0,d)},"writeDoubleLE"),o.prototype.writeDoubleBE=m(function(u,c,d){return Un(this,u,c,!1,d)},"writeDoubleBE"),o.prototype.copy=m(function(u,c,d,A){if(!o.isBuffer(u))throw new TypeError("argument should be a Buffer");if(d||(d=0),!A&&A!==0&&(A=this.length),c>=u.length&&(c=u.length),c||(c=0),A>0&&A<d&&(A=d),A===d||u.length===0||this.length===0)return 0;if(c<0)throw new RangeError("targetStart out of bounds");if(d<0||d>=this.length)throw new RangeError("Index out of range");if(A<0)throw new RangeError("sourceEnd out of bounds");A>this.length&&(A=this.length),u.length-c<A-d&&(A=u.length-c+d);let k=A-d;return this===u&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(c,d,A):Uint8Array.prototype.set.call(u,this.subarray(d,A),c),k},"copy"),o.prototype.fill=m(function(u,c,d,A){if(typeof u=="string"){if(typeof c=="string"?(A=c,c=0,d=this.length):typeof d=="string"&&(A=d,d=this.length),A!==void 0&&typeof A!="string")throw new TypeError("encoding must be a string");if(typeof A=="string"&&!o.isEncoding(A))throw new TypeError("Unknown encoding: "+A);if(u.length===1){let D=u.charCodeAt(0);(A==="utf8"&&D<128||A==="latin1")&&(u=D)}}else typeof u=="number"?u=u&255:typeof u=="boolean"&&(u=Number(u));if(c<0||this.length<c||this.length<d)throw new RangeError("Out of range index");if(d<=c)return this;c=c>>>0,d=d===void 0?this.length:d>>>0,u||(u=0);let k;if(typeof u=="number")for(k=c;k<d;++k)this[k]=u;else{let D=o.isBuffer(u)?u:o.from(u,A),Q=D.length;if(Q===0)throw new TypeError('The value "'+u+'" is invalid for argument "value"');for(k=0;k<d-c;++k)this[k+c]=D[k%Q]}return this},"fill");var Jt={};function Hr(u,c,d){var A;Jt[u]=(A=class extends d{constructor(){super(),Object.defineProperty(this,"message",{value:c.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${u}]`,this.stack,delete this.name}get code(){return u}set code(k){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:k,writable:!0})}toString(){return`${this.name} [${u}]: ${this.message}`}},m(A,"NodeError"),A)}m(Hr,"E"),Hr("ERR_BUFFER_OUT_OF_BOUNDS",function(u){return u?`${u} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Hr("ERR_INVALID_ARG_TYPE",function(u,c){return`The "${u}" argument must be of type number. Received type ${typeof c}`},TypeError),Hr("ERR_OUT_OF_RANGE",function(u,c,d){let A=`The value of "${u}" is out of range.`,k=d;return Number.isInteger(d)&&Math.abs(d)>2**32?k=zn(String(d)):typeof d=="bigint"&&(k=String(d),(d>BigInt(2)**BigInt(32)||d<-(BigInt(2)**BigInt(32)))&&(k=zn(k)),k+="n"),A+=` It must be ${c}. Received ${k}`,A},RangeError);function zn(u){let c="",d=u.length,A=u[0]==="-"?1:0;for(;d>=A+4;d-=3)c=`_${u.slice(d-3,d)}${c}`;return`${u.slice(0,d)}${c}`}m(zn,"addNumericalSeparator");function so(u,c,d){Pt(c,"offset"),(u[c]===void 0||u[c+d]===void 0)&&Xt(c,u.length-(d+1))}m(so,"checkBounds");function Vn(u,c,d,A,k,D){if(u>d||u<c){let Q=typeof c=="bigint"?"n":"",be;throw D>3?c===0||c===BigInt(0)?be=`>= 0${Q} and < 2${Q} ** ${(D+1)*8}${Q}`:be=`>= -(2${Q} ** ${(D+1)*8-1}${Q}) and < 2 ** ${(D+1)*8-1}${Q}`:be=`>= ${c}${Q} and <= ${d}${Q}`,new Jt.ERR_OUT_OF_RANGE("value",be,u)}so(A,k,D)}m(Vn,"checkIntBI");function Pt(u,c){if(typeof u!="number")throw new Jt.ERR_INVALID_ARG_TYPE(c,"number",u)}m(Pt,"validateNumber");function Xt(u,c,d){throw Math.floor(u)!==u?(Pt(u,d),new Jt.ERR_OUT_OF_RANGE(d||"offset","an integer",u)):c<0?new Jt.ERR_BUFFER_OUT_OF_BOUNDS:new Jt.ERR_OUT_OF_RANGE(d||"offset",`>= ${d?1:0} and <= ${c}`,u)}m(Xt,"boundsError");var Du=/[^+/0-9A-Za-z-_]/g;function io(u){if(u=u.split("=")[0],u=u.trim().replace(Du,""),u.length<2)return"";for(;u.length%4!==0;)u=u+"=";return u}m(io,"base64clean");function Jr(u,c){c=c||1/0;let d,A=u.length,k=null,D=[];for(let Q=0;Q<A;++Q){if(d=u.charCodeAt(Q),d>55295&&d<57344){if(!k){if(d>56319){(c-=3)>-1&&D.push(239,191,189);continue}else if(Q+1===A){(c-=3)>-1&&D.push(239,191,189);continue}k=d;continue}if(d<56320){(c-=3)>-1&&D.push(239,191,189),k=d;continue}d=(k-55296<<10|d-56320)+65536}else k&&(c-=3)>-1&&D.push(239,191,189);if(k=null,d<128){if((c-=1)<0)break;D.push(d)}else if(d<2048){if((c-=2)<0)break;D.push(d>>6|192,d&63|128)}else if(d<65536){if((c-=3)<0)break;D.push(d>>12|224,d>>6&63|128,d&63|128)}else if(d<1114112){if((c-=4)<0)break;D.push(d>>18|240,d>>12&63|128,d>>6&63|128,d&63|128)}else throw new Error("Invalid code point")}return D}m(Jr,"utf8ToBytes");function oo(u){let c=[];for(let d=0;d<u.length;++d)c.push(u.charCodeAt(d)&255);return c}m(oo,"asciiToBytes");function ao(u,c){let d,A,k,D=[];for(let Q=0;Q<u.length&&!((c-=2)<0);++Q)d=u.charCodeAt(Q),A=d>>8,k=d%256,D.push(k),D.push(A);return D}m(ao,"utf16leToBytes");function Kn(u){return e.toByteArray(io(u))}m(Kn,"base64ToBytes");function wr(u,c,d,A){let k;for(k=0;k<A&&!(k+d>=c.length||k>=u.length);++k)c[k+d]=u[k];return k}m(wr,"blitBuffer");function He(u,c){return u instanceof c||u!=null&&u.constructor!=null&&u.constructor.name!=null&&u.constructor.name===c.name}m(He,"isInstance");function Xr(u){return u!==u}m(Xr,"numberIsNaN");var ju=function(){let u="0123456789abcdef",c=new Array(256);for(let d=0;d<16;++d){let A=d*16;for(let k=0;k<16;++k)c[A+k]=u[d]+u[k]}return c}();function at(u){return typeof BigInt>"u"?uo:u}m(at,"defineBigIntMethod");function uo(){throw new Error("BigInt not supported")}m(uo,"BufferBigIntNotDefined")}),Yr,Xn,tl,Le,ne,ue,X=je(()=>{"use strict";Yr=globalThis,Xn=globalThis.setImmediate??(r=>setTimeout(r,0)),tl=globalThis.clearImmediate??(r=>clearTimeout(r)),Le=globalThis.crypto??{},Le.subtle??(Le.subtle={}),ne=typeof globalThis.Buffer=="function"&&typeof globalThis.Buffer.allocUnsafe=="function"?globalThis.Buffer:el().Buffer,ue=globalThis.process??{},ue.env??(ue.env={});try{ue.nextTick(()=>{})}catch{let r=Promise.resolve();ue.nextTick=r.then.bind(r)}}),It=le((r,e)=>{"use strict";X();var t=typeof Reflect=="object"?Reflect:null,n=t&&typeof t.apply=="function"?t.apply:m(function(_,I,P){return Function.prototype.apply.call(_,I,P)},"ReflectApply"),s;t&&typeof t.ownKeys=="function"?s=t.ownKeys:Object.getOwnPropertySymbols?s=m(function(_){return Object.getOwnPropertyNames(_).concat(Object.getOwnPropertySymbols(_))},"ReflectOwnKeys"):s=m(function(_){return Object.getOwnPropertyNames(_)},"ReflectOwnKeys");function i(_){console&&console.warn&&console.warn(_)}m(i,"ProcessEmitWarning");var a=Number.isNaN||m(function(_){return _!==_},"NumberIsNaN");function o(){o.init.call(this)}m(o,"EventEmitter"),e.exports=o,e.exports.once=T,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var h=10;function p(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}m(p,"checkListener"),Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:m(function(){return h},"get"),set:m(function(_){if(typeof _!="number"||_<0||a(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");h=_},"set")}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=m(function(_){if(typeof _!="number"||_<0||a(_))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+_+".");return this._maxListeners=_,this},"setMaxListeners");function f(_){return _._maxListeners===void 0?o.defaultMaxListeners:_._maxListeners}m(f,"_getMaxListeners"),o.prototype.getMaxListeners=m(function(){return f(this)},"getMaxListeners"),o.prototype.emit=m(function(_){for(var I=[],P=1;P<arguments.length;P++)I.push(arguments[P]);var E=_==="error",$=this._events;if($!==void 0)E=E&&$.error===void 0;else if(!E)return!1;if(E){var R;if(I.length>0&&(R=I[0]),R instanceof Error)throw R;var Z=new Error("Unhandled error."+(R?" ("+R.message+")":""));throw Z.context=R,Z}var W=$[_];if(W===void 0)return!1;if(typeof W=="function")n(W,this,I);else for(var M=W.length,F=v(W,M),P=0;P<M;++P)n(F[P],this,I);return!0},"emit");function y(_,I,P,E){var $,R,Z;if(p(P),R=_._events,R===void 0?(R=_._events=Object.create(null),_._eventsCount=0):(R.newListener!==void 0&&(_.emit("newListener",I,P.listener?P.listener:P),R=_._events),Z=R[I]),Z===void 0)Z=R[I]=P,++_._eventsCount;else if(typeof Z=="function"?Z=R[I]=E?[P,Z]:[Z,P]:E?Z.unshift(P):Z.push(P),$=f(_),$>0&&Z.length>$&&!Z.warned){Z.warned=!0;var W=new Error("Possible EventEmitter memory leak detected. "+Z.length+" "+String(I)+" listeners added. Use emitter.setMaxListeners() to increase limit");W.name="MaxListenersExceededWarning",W.emitter=_,W.type=I,W.count=Z.length,i(W)}return _}m(y,"_addListener"),o.prototype.addListener=m(function(_,I){return y(this,_,I,!1)},"addListener"),o.prototype.on=o.prototype.addListener,o.prototype.prependListener=m(function(_,I){return y(this,_,I,!0)},"prependListener");function b(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}m(b,"onceWrapper");function w(_,I,P){var E={fired:!1,wrapFn:void 0,target:_,type:I,listener:P},$=b.bind(E);return $.listener=P,E.wrapFn=$,$}m(w,"_onceWrap"),o.prototype.once=m(function(_,I){return p(I),this.on(_,w(this,_,I)),this},"once"),o.prototype.prependOnceListener=m(function(_,I){return p(I),this.prependListener(_,w(this,_,I)),this},"prependOnceListener"),o.prototype.removeListener=m(function(_,I){var P,E,$,R,Z;if(p(I),E=this._events,E===void 0)return this;if(P=E[_],P===void 0)return this;if(P===I||P.listener===I)--this._eventsCount===0?this._events=Object.create(null):(delete E[_],E.removeListener&&this.emit("removeListener",_,P.listener||I));else if(typeof P!="function"){for($=-1,R=P.length-1;R>=0;R--)if(P[R]===I||P[R].listener===I){Z=P[R].listener,$=R;break}if($<0)return this;$===0?P.shift():S(P,$),P.length===1&&(E[_]=P[0]),E.removeListener!==void 0&&this.emit("removeListener",_,Z||I)}return this},"removeListener"),o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=m(function(_){var I,P,E;if(P=this._events,P===void 0)return this;if(P.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):P[_]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete P[_]),this;if(arguments.length===0){var $=Object.keys(P),R;for(E=0;E<$.length;++E)R=$[E],R!=="removeListener"&&this.removeAllListeners(R);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(I=P[_],typeof I=="function")this.removeListener(_,I);else if(I!==void 0)for(E=I.length-1;E>=0;E--)this.removeListener(_,I[E]);return this},"removeAllListeners");function g(_,I,P){var E=_._events;if(E===void 0)return[];var $=E[I];return $===void 0?[]:typeof $=="function"?P?[$.listener||$]:[$]:P?x($):v($,$.length)}m(g,"_listeners"),o.prototype.listeners=m(function(_){return g(this,_,!0)},"listeners"),o.prototype.rawListeners=m(function(_){return g(this,_,!1)},"rawListeners"),o.listenerCount=function(_,I){return typeof _.listenerCount=="function"?_.listenerCount(I):l.call(_,I)},o.prototype.listenerCount=l;function l(_){var I=this._events;if(I!==void 0){var P=I[_];if(typeof P=="function")return 1;if(P!==void 0)return P.length}return 0}m(l,"listenerCount"),o.prototype.eventNames=m(function(){return this._eventsCount>0?s(this._events):[]},"eventNames");function v(_,I){for(var P=new Array(I),E=0;E<I;++E)P[E]=_[E];return P}m(v,"arrayClone");function S(_,I){for(;I+1<_.length;I++)_[I]=_[I+1];_.pop()}m(S,"spliceOne");function x(_){for(var I=new Array(_.length),P=0;P<I.length;++P)I[P]=_[P].listener||_[P];return I}m(x,"unwrapListeners");function T(_,I){return new Promise(function(P,E){function $(Z){_.removeListener(I,R),E(Z)}m($,"errorListener");function R(){typeof _.removeListener=="function"&&_.removeListener("error",$),P([].slice.call(arguments))}m(R,"resolver"),L(_,I,R,{once:!0}),I!=="error"&&O(_,$,{once:!0})})}m(T,"once");function O(_,I,P){typeof _.on=="function"&&L(_,"error",I,P)}m(O,"addErrorHandlerIfEventEmitter");function L(_,I,P,E){if(typeof _.on=="function")E.once?_.once(I,P):_.on(I,P);else if(typeof _.addEventListener=="function")_.addEventListener(I,m(function $(R){E.once&&_.removeEventListener(I,$),P(R)},"wrapListener"));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof _)}m(L,"eventTargetAgnosticAddListener")}),xr={};Je(xr,{default:()=>po});var po,en=je(()=>{"use strict";X(),po={}});function _r(r){let e=1779033703,t=3144134277,n=1013904242,s=2773480762,i=1359893119,a=2600822924,o=528734635,h=1541459225,p=0,f=0,y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],b=m((x,T)=>x>>>T|x<<32-T,"rrot"),w=new Uint32Array(64),g=new Uint8Array(64),l=m(()=>{for(let $=0,R=0;$<16;$++,R+=4)w[$]=g[R]<<24|g[R+1]<<16|g[R+2]<<8|g[R+3];for(let $=16;$<64;$++){let R=b(w[$-15],7)^b(w[$-15],18)^w[$-15]>>>3,Z=b(w[$-2],17)^b(w[$-2],19)^w[$-2]>>>10;w[$]=w[$-16]+R+w[$-7]+Z|0}let x=e,T=t,O=n,L=s,_=i,I=a,P=o,E=h;for(let $=0;$<64;$++){let R=b(_,6)^b(_,11)^b(_,25),Z=_&I^~_&P,W=E+R+Z+y[$]+w[$]|0,M=b(x,2)^b(x,13)^b(x,22),F=x&T^x&O^T&O,J=M+F|0;E=P,P=I,I=_,_=L+W|0,L=O,O=T,T=x,x=W+J|0}e=e+x|0,t=t+T|0,n=n+O|0,s=s+L|0,i=i+_|0,a=a+I|0,o=o+P|0,h=h+E|0,f=0},"process"),v=m(x=>{typeof x=="string"&&(x=new TextEncoder().encode(x));for(let T=0;T<x.length;T++)g[f++]=x[T],f===64&&l();p+=x.length},"add"),S=m(()=>{if(g[f++]=128,f==64&&l(),f+8>64){for(;f<64;)g[f++]=0;l()}for(;f<58;)g[f++]=0;let x=p*8;g[f++]=x/1099511627776&255,g[f++]=x/4294967296&255,g[f++]=x>>>24,g[f++]=x>>>16&255,g[f++]=x>>>8&255,g[f++]=x&255,l();let T=new Uint8Array(32);return T[0]=e>>>24,T[1]=e>>>16&255,T[2]=e>>>8&255,T[3]=e&255,T[4]=t>>>24,T[5]=t>>>16&255,T[6]=t>>>8&255,T[7]=t&255,T[8]=n>>>24,T[9]=n>>>16&255,T[10]=n>>>8&255,T[11]=n&255,T[12]=s>>>24,T[13]=s>>>16&255,T[14]=s>>>8&255,T[15]=s&255,T[16]=i>>>24,T[17]=i>>>16&255,T[18]=i>>>8&255,T[19]=i&255,T[20]=a>>>24,T[21]=a>>>16&255,T[22]=a>>>8&255,T[23]=a&255,T[24]=o>>>24,T[25]=o>>>16&255,T[26]=o>>>8&255,T[27]=o&255,T[28]=h>>>24,T[29]=h>>>16&255,T[30]=h>>>8&255,T[31]=h&255,T},"digest");return r===void 0?{add:v,digest:S}:(v(r),S())}var rl=je(()=>{"use strict";X(),m(_r,"sha256")}),ut,Hn,nl=je(()=>{"use strict";X(),ut=class Ke{constructor(){se(this,"_dataLength",0),se(this,"_bufferLength",0),se(this,"_state",new Int32Array(4)),se(this,"_buffer",new ArrayBuffer(68)),se(this,"_buffer8"),se(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(e,t=!1){return this.onePassHasher.start().appendByteArray(e).end(t)}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){let t=Ke.hexChars,n=Ke.hexOut,s,i,a,o;for(o=0;o<4;o+=1)for(i=o*8,s=e[o],a=0;a<8;a+=2)n[i+1+a]=t.charAt(s&15),s>>>=4,n[i+0+a]=t.charAt(s&15),s>>>=4;return n.join("")}static _md5cycle(e,t){let n=e[0],s=e[1],i=e[2],a=e[3];n+=(s&i|~s&a)+t[0]-680876936|0,n=(n<<7|n>>>25)+s|0,a+=(n&s|~n&i)+t[1]-389564586|0,a=(a<<12|a>>>20)+n|0,i+=(a&n|~a&s)+t[2]+606105819|0,i=(i<<17|i>>>15)+a|0,s+=(i&a|~i&n)+t[3]-1044525330|0,s=(s<<22|s>>>10)+i|0,n+=(s&i|~s&a)+t[4]-176418897|0,n=(n<<7|n>>>25)+s|0,a+=(n&s|~n&i)+t[5]+1200080426|0,a=(a<<12|a>>>20)+n|0,i+=(a&n|~a&s)+t[6]-1473231341|0,i=(i<<17|i>>>15)+a|0,s+=(i&a|~i&n)+t[7]-45705983|0,s=(s<<22|s>>>10)+i|0,n+=(s&i|~s&a)+t[8]+1770035416|0,n=(n<<7|n>>>25)+s|0,a+=(n&s|~n&i)+t[9]-1958414417|0,a=(a<<12|a>>>20)+n|0,i+=(a&n|~a&s)+t[10]-42063|0,i=(i<<17|i>>>15)+a|0,s+=(i&a|~i&n)+t[11]-1990404162|0,s=(s<<22|s>>>10)+i|0,n+=(s&i|~s&a)+t[12]+1804603682|0,n=(n<<7|n>>>25)+s|0,a+=(n&s|~n&i)+t[13]-40341101|0,a=(a<<12|a>>>20)+n|0,i+=(a&n|~a&s)+t[14]-1502002290|0,i=(i<<17|i>>>15)+a|0,s+=(i&a|~i&n)+t[15]+1236535329|0,s=(s<<22|s>>>10)+i|0,n+=(s&a|i&~a)+t[1]-165796510|0,n=(n<<5|n>>>27)+s|0,a+=(n&i|s&~i)+t[6]-1069501632|0,a=(a<<9|a>>>23)+n|0,i+=(a&s|n&~s)+t[11]+643717713|0,i=(i<<14|i>>>18)+a|0,s+=(i&n|a&~n)+t[0]-373897302|0,s=(s<<20|s>>>12)+i|0,n+=(s&a|i&~a)+t[5]-701558691|0,n=(n<<5|n>>>27)+s|0,a+=(n&i|s&~i)+t[10]+38016083|0,a=(a<<9|a>>>23)+n|0,i+=(a&s|n&~s)+t[15]-660478335|0,i=(i<<14|i>>>18)+a|0,s+=(i&n|a&~n)+t[4]-405537848|0,s=(s<<20|s>>>12)+i|0,n+=(s&a|i&~a)+t[9]+568446438|0,n=(n<<5|n>>>27)+s|0,a+=(n&i|s&~i)+t[14]-1019803690|0,a=(a<<9|a>>>23)+n|0,i+=(a&s|n&~s)+t[3]-187363961|0,i=(i<<14|i>>>18)+a|0,s+=(i&n|a&~n)+t[8]+1163531501|0,s=(s<<20|s>>>12)+i|0,n+=(s&a|i&~a)+t[13]-1444681467|0,n=(n<<5|n>>>27)+s|0,a+=(n&i|s&~i)+t[2]-51403784|0,a=(a<<9|a>>>23)+n|0,i+=(a&s|n&~s)+t[7]+1735328473|0,i=(i<<14|i>>>18)+a|0,s+=(i&n|a&~n)+t[12]-1926607734|0,s=(s<<20|s>>>12)+i|0,n+=(s^i^a)+t[5]-378558|0,n=(n<<4|n>>>28)+s|0,a+=(n^s^i)+t[8]-2022574463|0,a=(a<<11|a>>>21)+n|0,i+=(a^n^s)+t[11]+1839030562|0,i=(i<<16|i>>>16)+a|0,s+=(i^a^n)+t[14]-35309556|0,s=(s<<23|s>>>9)+i|0,n+=(s^i^a)+t[1]-1530992060|0,n=(n<<4|n>>>28)+s|0,a+=(n^s^i)+t[4]+1272893353|0,a=(a<<11|a>>>21)+n|0,i+=(a^n^s)+t[7]-155497632|0,i=(i<<16|i>>>16)+a|0,s+=(i^a^n)+t[10]-1094730640|0,s=(s<<23|s>>>9)+i|0,n+=(s^i^a)+t[13]+681279174|0,n=(n<<4|n>>>28)+s|0,a+=(n^s^i)+t[0]-358537222|0,a=(a<<11|a>>>21)+n|0,i+=(a^n^s)+t[3]-722521979|0,i=(i<<16|i>>>16)+a|0,s+=(i^a^n)+t[6]+76029189|0,s=(s<<23|s>>>9)+i|0,n+=(s^i^a)+t[9]-640364487|0,n=(n<<4|n>>>28)+s|0,a+=(n^s^i)+t[12]-421815835|0,a=(a<<11|a>>>21)+n|0,i+=(a^n^s)+t[15]+530742520|0,i=(i<<16|i>>>16)+a|0,s+=(i^a^n)+t[2]-995338651|0,s=(s<<23|s>>>9)+i|0,n+=(i^(s|~a))+t[0]-198630844|0,n=(n<<6|n>>>26)+s|0,a+=(s^(n|~i))+t[7]+1126891415|0,a=(a<<10|a>>>22)+n|0,i+=(n^(a|~s))+t[14]-1416354905|0,i=(i<<15|i>>>17)+a|0,s+=(a^(i|~n))+t[5]-57434055|0,s=(s<<21|s>>>11)+i|0,n+=(i^(s|~a))+t[12]+1700485571|0,n=(n<<6|n>>>26)+s|0,a+=(s^(n|~i))+t[3]-1894986606|0,a=(a<<10|a>>>22)+n|0,i+=(n^(a|~s))+t[10]-1051523|0,i=(i<<15|i>>>17)+a|0,s+=(a^(i|~n))+t[1]-2054922799|0,s=(s<<21|s>>>11)+i|0,n+=(i^(s|~a))+t[8]+1873313359|0,n=(n<<6|n>>>26)+s|0,a+=(s^(n|~i))+t[15]-30611744|0,a=(a<<10|a>>>22)+n|0,i+=(n^(a|~s))+t[6]-1560198380|0,i=(i<<15|i>>>17)+a|0,s+=(a^(i|~n))+t[13]+1309151649|0,s=(s<<21|s>>>11)+i|0,n+=(i^(s|~a))+t[4]-145523070|0,n=(n<<6|n>>>26)+s|0,a+=(s^(n|~i))+t[11]-1120210379|0,a=(a<<10|a>>>22)+n|0,i+=(n^(a|~s))+t[2]+718787259|0,i=(i<<15|i>>>17)+a|0,s+=(a^(i|~n))+t[9]-343485551|0,s=(s<<21|s>>>11)+i|0,e[0]=n+e[0]|0,e[1]=s+e[1]|0,e[2]=i+e[2]|0,e[3]=a+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(Ke.stateIdentity),this}appendStr(e){let t=this._buffer8,n=this._buffer32,s=this._bufferLength,i,a;for(a=0;a<e.length;a+=1){if(i=e.charCodeAt(a),i<128)t[s++]=i;else if(i<2048)t[s++]=(i>>>6)+192,t[s++]=i&63|128;else if(i<55296||i>56319)t[s++]=(i>>>12)+224,t[s++]=i>>>6&63|128,t[s++]=i&63|128;else{if(i=(i-55296)*1024+(e.charCodeAt(++a)-56320)+65536,i>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");t[s++]=(i>>>18)+240,t[s++]=i>>>12&63|128,t[s++]=i>>>6&63|128,t[s++]=i&63|128}s>=64&&(this._dataLength+=64,Ke._md5cycle(this._state,n),s-=64,n[0]=n[16])}return this._bufferLength=s,this}appendAsciiStr(e){let t=this._buffer8,n=this._buffer32,s=this._bufferLength,i,a=0;for(;;){for(i=Math.min(e.length-a,64-s);i--;)t[s++]=e.charCodeAt(a++);if(s<64)break;this._dataLength+=64,Ke._md5cycle(this._state,n),s=0}return this._bufferLength=s,this}appendByteArray(e){let t=this._buffer8,n=this._buffer32,s=this._bufferLength,i,a=0;for(;;){for(i=Math.min(e.length-a,64-s);i--;)t[s++]=e[a++];if(s<64)break;this._dataLength+=64,Ke._md5cycle(this._state,n),s=0}return this._bufferLength=s,this}getState(){let e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){let t=e.buffer,n=e.state,s=this._state,i;for(this._dataLength=e.length,this._bufferLength=e.buflen,s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],i=0;i<t.length;i+=1)this._buffer8[i]=t.charCodeAt(i)}end(e=!1){let t=this._bufferLength,n=this._buffer8,s=this._buffer32,i=(t>>2)+1;this._dataLength+=t;let a=this._dataLength*8;if(n[t]=128,n[t+1]=n[t+2]=n[t+3]=0,s.set(Ke.buffer32Identity.subarray(i),i),t>55&&(Ke._md5cycle(this._state,s),s.set(Ke.buffer32Identity)),a<=4294967295)s[14]=a;else{let o=a.toString(16).match(/(.*?)(.{0,8})$/);if(o===null)return;let h=parseInt(o[2],16),p=parseInt(o[1],16)||0;s[14]=h,s[15]=p}return Ke._md5cycle(this._state,s),e?this._state:Ke._hex(this._state)}},m(ut,"Md5"),se(ut,"stateIdentity",new Int32Array([1732584193,-271733879,-1732584194,271733878])),se(ut,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),se(ut,"hexChars","0123456789abcdef"),se(ut,"hexOut",[]),se(ut,"onePassHasher",new ut),Hn=ut}),Yn={};Je(Yn,{createHash:()=>go,createHmac:()=>yo,randomBytes:()=>mo});function mo(r){return Le.getRandomValues(ne.alloc(r))}function go(r){if(r==="sha256")return{update:m(function(e){return{digest:m(function(){return ne.from(_r(e))},"digest")}},"update")};if(r==="md5")return{update:m(function(e){return{digest:m(function(){return typeof e=="string"?Hn.hashStr(e):Hn.hashByteArray(e)},"digest")}},"update")};throw new Error(`Hash type '${r}' not supported`)}function yo(r,e){if(r!=="sha256")throw new Error(`Only sha256 is supported (requested: '${r}')`);return{update:m(function(t){return{digest:m(function(){typeof e=="string"&&(e=new TextEncoder().encode(e)),typeof t=="string"&&(t=new TextEncoder().encode(t));let n=e.length;if(n>64)e=_r(e);else if(n<64){let h=new Uint8Array(64);h.set(e),e=h}let s=new Uint8Array(64),i=new Uint8Array(64);for(let h=0;h<64;h++)s[h]=54^e[h],i[h]=92^e[h];let a=new Uint8Array(t.length+64);a.set(s,0),a.set(t,64);let o=new Uint8Array(96);return o.set(i,0),o.set(_r(a),64),ne.from(_r(o))},"digest")}},"update")}}var bo=je(()=>{"use strict";X(),rl(),nl(),m(mo,"randomBytes"),m(go,"createHash"),m(yo,"createHmac")}),vo=le(r=>{"use strict";X(),r.parse=function(s,i){return new t(s,i).parse()};var e=class wo{constructor(i,a){this.source=i,this.transform=a||n,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var i=this.source[this.position++];return i==="\\"?{value:this.source[this.position++],escaped:!0}:{value:i,escaped:!1}}record(i){this.recorded.push(i)}newEntry(i){var a;(this.recorded.length>0||i)&&(a=this.recorded.join(""),a==="NULL"&&!i&&(a=null),a!==null&&(a=this.transform(a)),this.entries.push(a),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var i=this.nextCharacter();if(i.value==="=")break}}parse(i){var a,o,h;for(this.consumeDimensions();!this.isEof();)if(a=this.nextCharacter(),a.value==="{"&&!h)this.dimension++,this.dimension>1&&(o=new wo(this.source.substr(this.position-1),this.transform),this.entries.push(o.parse(!0)),this.position+=o.position-2);else if(a.value==="}"&&!h){if(this.dimension--,!this.dimension&&(this.newEntry(),i))return this.entries}else a.value==='"'&&!a.escaped?(h&&this.newEntry(!0),h=!h):a.value===","&&!h?this.newEntry():this.record(a.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};m(e,"ArrayParser");var t=e;function n(s){return s}m(n,"identity")}),So=le((r,e)=>{X();var t=vo();e.exports={create:m(function(n,s){return{parse:m(function(){return t.parse(n,s)},"parse")}},"create")}}),sl=le((r,e)=>{"use strict";X();var t=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,n=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,s=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,i=/^-?infinity$/;e.exports=m(function(f){if(i.test(f))return Number(f.replace("i","I"));var y=t.exec(f);if(!y)return a(f)||null;var b=!!y[8],w=parseInt(y[1],10);b&&(w=h(w));var g=parseInt(y[2],10)-1,l=y[3],v=parseInt(y[4],10),S=parseInt(y[5],10),x=parseInt(y[6],10),T=y[7];T=T?1e3*parseFloat(T):0;var O,L=o(f);return L!=null?(O=new Date(Date.UTC(w,g,l,v,S,x,T)),p(w)&&O.setUTCFullYear(w),L!==0&&O.setTime(O.getTime()-L)):(O=new Date(w,g,l,v,S,x,T),p(w)&&O.setFullYear(w)),O},"parseDate");function a(f){var y=n.exec(f);if(y){var b=parseInt(y[1],10),w=!!y[4];w&&(b=h(b));var g=parseInt(y[2],10)-1,l=y[3],v=new Date(b,g,l);return p(b)&&v.setFullYear(b),v}}m(a,"getDate");function o(f){if(f.endsWith("+00"))return 0;var y=s.exec(f.split(" ")[1]);if(y){var b=y[1];if(b==="Z")return 0;var w=b==="-"?-1:1,g=parseInt(y[2],10)*3600+parseInt(y[3]||0,10)*60+parseInt(y[4]||0,10);return g*w*1e3}}m(o,"timeZoneOffset");function h(f){return-(f-1)}m(h,"bcYearToNegativeYear");function p(f){return f>=0&&f<100}m(p,"is0To99")}),il=le((r,e)=>{X(),e.exports=n;var t=Object.prototype.hasOwnProperty;function n(s){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var o in a)t.call(a,o)&&(s[o]=a[o])}return s}m(n,"extend")}),ol=le((r,e)=>{"use strict";X();var t=il();e.exports=n;function n(x){if(!(this instanceof n))return new n(x);t(this,S(x))}m(n,"PostgresInterval");var s=["seconds","minutes","hours","days","months","years"];n.prototype.toPostgres=function(){var x=s.filter(this.hasOwnProperty,this);return this.milliseconds&&x.indexOf("seconds")<0&&x.push("seconds"),x.length===0?"0":x.map(function(T){var O=this[T]||0;return T==="seconds"&&this.milliseconds&&(O=(O+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),O+" "+T},this).join(" ")};var i={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},a=["years","months","days"],o=["hours","minutes","seconds"];n.prototype.toISOString=n.prototype.toISO=function(){var x=a.map(O,this).join(""),T=o.map(O,this).join("");return"P"+x+"T"+T;function O(L){var _=this[L]||0;return L==="seconds"&&this.milliseconds&&(_=(_+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),_+i[L]}};var h="([+-]?\\d+)",p=h+"\\s+years?",f=h+"\\s+mons?",y=h+"\\s+days?",b="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",w=new RegExp([p,f,y,b].map(function(x){return"("+x+")?"}).join("\\s*")),g={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},l=["hours","minutes","seconds","milliseconds"];function v(x){var T=x+"000000".slice(x.length);return parseInt(T,10)/1e3}m(v,"parseMilliseconds");function S(x){if(!x)return{};var T=w.exec(x),O=T[8]==="-";return Object.keys(g).reduce(function(L,_){var I=g[_],P=T[I];return!P||(P=_==="milliseconds"?v(P):parseInt(P,10),!P)||(O&&~l.indexOf(_)&&(P*=-1),L[_]=P),L},{})}m(S,"parse")}),al=le((r,e)=>{"use strict";X(),e.exports=m(function(t){if(/^\\x/.test(t))return new ne(t.substr(2),"hex");for(var n="",s=0;s<t.length;)if(t[s]!=="\\")n+=t[s],++s;else if(/[0-7]{3}/.test(t.substr(s+1,3)))n+=String.fromCharCode(parseInt(t.substr(s+1,3),8)),s+=4;else{for(var i=1;s+i<t.length&&t[s+i]==="\\";)i++;for(var a=0;a<Math.floor(i/2);++a)n+="\\";s+=Math.floor(i/2)*2}return new ne(n,"binary")},"parseBytea")}),ul=le((r,e)=>{X();var t=vo(),n=So(),s=sl(),i=ol(),a=al();function o(E){return m(function($){return $===null?$:E($)},"nullAllowed")}m(o,"allowNull");function h(E){return E===null?E:E==="TRUE"||E==="t"||E==="true"||E==="y"||E==="yes"||E==="on"||E==="1"}m(h,"parseBool");function p(E){return E?t.parse(E,h):null}m(p,"parseBoolArray");function f(E){return parseInt(E,10)}m(f,"parseBaseTenInt");function y(E){return E?t.parse(E,o(f)):null}m(y,"parseIntegerArray");function b(E){return E?t.parse(E,o(function($){return O($).trim()})):null}m(b,"parseBigIntegerArray");var w=m(function(E){if(!E)return null;var $=n.create(E,function(R){return R!==null&&(R=_(R)),R});return $.parse()},"parsePointArray"),g=m(function(E){if(!E)return null;var $=n.create(E,function(R){return R!==null&&(R=parseFloat(R)),R});return $.parse()},"parseFloatArray"),l=m(function(E){if(!E)return null;var $=n.create(E);return $.parse()},"parseStringArray"),v=m(function(E){if(!E)return null;var $=n.create(E,function(R){return R!==null&&(R=s(R)),R});return $.parse()},"parseDateArray"),S=m(function(E){if(!E)return null;var $=n.create(E,function(R){return R!==null&&(R=i(R)),R});return $.parse()},"parseIntervalArray"),x=m(function(E){return E?t.parse(E,o(a)):null},"parseByteAArray"),T=m(function(E){return parseInt(E,10)},"parseInteger"),O=m(function(E){var $=String(E);return/^\d+$/.test($)?$:E},"parseBigInteger"),L=m(function(E){return E?t.parse(E,o(JSON.parse)):null},"parseJsonArray"),_=m(function(E){return E[0]!=="("?null:(E=E.substring(1,E.length-1).split(","),{x:parseFloat(E[0]),y:parseFloat(E[1])})},"parsePoint"),I=m(function(E){if(E[0]!=="<"&&E[1]!=="(")return null;for(var $="(",R="",Z=!1,W=2;W<E.length-1;W++){if(Z||($+=E[W]),E[W]===")"){Z=!0;continue}else if(!Z)continue;E[W]!==","&&(R+=E[W])}var M=_($);return M.radius=parseFloat(R),M},"parseCircle"),P=m(function(E){E(20,O),E(21,T),E(23,T),E(26,T),E(700,parseFloat),E(701,parseFloat),E(16,h),E(1082,s),E(1114,s),E(1184,s),E(600,_),E(651,l),E(718,I),E(1e3,p),E(1001,x),E(1005,y),E(1007,y),E(1028,y),E(1016,b),E(1017,w),E(1021,g),E(1022,g),E(1231,g),E(1014,l),E(1015,l),E(1008,l),E(1009,l),E(1040,l),E(1041,l),E(1115,v),E(1182,v),E(1185,v),E(1186,i),E(1187,S),E(17,a),E(114,JSON.parse.bind(JSON)),E(3802,JSON.parse.bind(JSON)),E(199,L),E(3807,L),E(3907,l),E(2951,l),E(791,l),E(1183,l),E(1270,l)},"init");e.exports={init:P}}),ll=le((r,e)=>{"use strict";X();var t=1e6;function n(s){var i=s.readInt32BE(0),a=s.readUInt32BE(4),o="";i<0&&(i=~i+(a===0),a=~a+1>>>0,o="-");var h="",p,f,y,b,w,g;{if(p=i%t,i=i/t>>>0,f=4294967296*p+a,a=f/t>>>0,y=""+(f-t*a),a===0&&i===0)return o+y+h;for(b="",w=6-y.length,g=0;g<w;g++)b+="0";h=b+y+h}{if(p=i%t,i=i/t>>>0,f=4294967296*p+a,a=f/t>>>0,y=""+(f-t*a),a===0&&i===0)return o+y+h;for(b="",w=6-y.length,g=0;g<w;g++)b+="0";h=b+y+h}{if(p=i%t,i=i/t>>>0,f=4294967296*p+a,a=f/t>>>0,y=""+(f-t*a),a===0&&i===0)return o+y+h;for(b="",w=6-y.length,g=0;g<w;g++)b+="0";h=b+y+h}return p=i%t,f=4294967296*p+a,y=""+f%t,o+y+h}m(n,"readInt8"),e.exports=n}),cl=le((r,e)=>{X();var t=ll(),n=m(function(l,v,S,x,T){S=S||0,x=x||!1,T=T||function(Z,W,M){return Z*Math.pow(2,M)+W};var O=S>>3,L=m(function(Z){return x?~Z&255:Z},"inv"),_=255,I=8-S%8;v<I&&(_=255<<8-v&255,I=v),S&&(_=_>>S%8);var P=0;S%8+v>=8&&(P=T(0,L(l[O])&_,I));for(var E=v+S>>3,$=O+1;$<E;$++)P=T(P,L(l[$]),8);var R=(v+S)%8;return R>0&&(P=T(P,L(l[E])>>8-R,R)),P},"parseBits"),s=m(function(l,v,S){var x=Math.pow(2,S-1)-1,T=n(l,1),O=n(l,S,1);if(O===0)return 0;var L=1,_=m(function(P,E,$){P===0&&(P=1);for(var R=1;R<=$;R++)L/=2,(E&1<<$-R)>0&&(P+=L);return P},"parsePrecisionBits"),I=n(l,v,S+1,!1,_);return O==Math.pow(2,S+1)-1?I===0?T===0?1/0:-1/0:NaN:(T===0?1:-1)*Math.pow(2,O-x)*I},"parseFloatFromBits"),i=m(function(l){return n(l,1)==1?-1*(n(l,15,1,!0)+1):n(l,15,1)},"parseInt16"),a=m(function(l){return n(l,1)==1?-1*(n(l,31,1,!0)+1):n(l,31,1)},"parseInt32"),o=m(function(l){return s(l,23,8)},"parseFloat32"),h=m(function(l){return s(l,52,11)},"parseFloat64"),p=m(function(l){var v=n(l,16,32);if(v==49152)return NaN;for(var S=Math.pow(1e4,n(l,16,16)),x=0,T=[],O=n(l,16),L=0;L<O;L++)x+=n(l,16,64+16*L)*S,S/=1e4;var _=Math.pow(10,n(l,16,48));return(v===0?1:-1)*Math.round(x*_)/_},"parseNumeric"),f=m(function(l,v){var S=n(v,1),x=n(v,63,1),T=new Date((S===0?1:-1)*x/1e3+9466848e5);return l||T.setTime(T.getTime()+T.getTimezoneOffset()*6e4),T.usec=x%1e3,T.getMicroSeconds=function(){return this.usec},T.setMicroSeconds=function(O){this.usec=O},T.getUTCMicroSeconds=function(){return this.usec},T},"parseDate"),y=m(function(l){for(var v=n(l,32),S=n(l,32,32),x=n(l,32,64),T=96,O=[],L=0;L<v;L++)O[L]=n(l,32,T),T+=32,T+=32;var _=m(function(P){var E=n(l,32,T);if(T+=32,E==4294967295)return null;var $;if(P==23||P==20)return $=n(l,E*8,T),T+=E*8,$;if(P==25)return $=l.toString(this.encoding,T>>3,(T+=E<<3)>>3),$;console.log("ERROR: ElementType not implemented: "+P)},"parseElement"),I=m(function(P,E){var $=[],R;if(P.length>1){var Z=P.shift();for(R=0;R<Z;R++)$[R]=I(P,E);P.unshift(Z)}else for(R=0;R<P[0];R++)$[R]=_(E);return $},"parse");return I(O,x)},"parseArray"),b=m(function(l){return l.toString("utf8")},"parseText"),w=m(function(l){return l===null?null:n(l,8)>0},"parseBool"),g=m(function(l){l(20,t),l(21,i),l(23,a),l(26,a),l(1700,p),l(700,o),l(701,h),l(16,w),l(1114,f.bind(null,!1)),l(1184,f.bind(null,!0)),l(1e3,y),l(1007,y),l(1016,y),l(1008,y),l(1009,y),l(25,b)},"init");e.exports={init:g}}),hl=le((r,e)=>{X(),e.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),tn=le(r=>{X();var e=ul(),t=cl(),n=So(),s=hl();r.getTypeParser=o,r.setTypeParser=h,r.arrayParser=n,r.builtins=s;var i={text:{},binary:{}};function a(p){return String(p)}m(a,"noParse");function o(p,f){return f=f||"text",i[f]&&i[f][p]||a}m(o,"getTypeParser");function h(p,f,y){typeof f=="function"&&(y=f,f="text"),i[f][p]=y}m(h,"setTypeParser"),e.init(function(p,f){i.text[p]=f}),t.init(function(p,f){i.binary[p]=f})}),rn=le((r,e)=>{"use strict";X(),e.exports={host:"localhost",user:ue.platform==="win32"?ue.env.USERNAME:ue.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var t=tn(),n=t.getTypeParser(20,"text"),s=t.getTypeParser(1016,"text");e.exports.__defineSetter__("parseInt8",function(i){t.setTypeParser(20,"text",i?t.getTypeParser(23,"text"):n),t.setTypeParser(1016,"text",i?t.getTypeParser(1007,"text"):s)})}),nn=le((r,e)=>{"use strict";X();var t=(bo(),ke(Yn)),n=rn();function s(g){var l=g.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+l+'"'}m(s,"escapeElement");function i(g){for(var l="{",v=0;v<g.length;v++)v>0&&(l=l+","),g[v]===null||typeof g[v]>"u"?l=l+"NULL":Array.isArray(g[v])?l=l+i(g[v]):g[v]instanceof ne?l+="\\\\x"+g[v].toString("hex"):l+=s(a(g[v]));return l=l+"}",l}m(i,"arrayString");var a=m(function(g,l){if(g==null)return null;if(g instanceof ne)return g;if(ArrayBuffer.isView(g)){var v=ne.from(g.buffer,g.byteOffset,g.byteLength);return v.length===g.byteLength?v:v.slice(g.byteOffset,g.byteOffset+g.byteLength)}return g instanceof Date?n.parseInputDatesAsUTC?f(g):p(g):Array.isArray(g)?i(g):typeof g=="object"?o(g,l):g.toString()},"prepareValue");function o(g,l){if(g&&typeof g.toPostgres=="function"){if(l=l||[],l.indexOf(g)!==-1)throw new Error('circular reference detected while preparing "'+g+'" for query');return l.push(g),a(g.toPostgres(a),l)}return JSON.stringify(g)}m(o,"prepareObject");function h(g,l){for(g=""+g;g.length<l;)g="0"+g;return g}m(h,"pad");function p(g){var l=-g.getTimezoneOffset(),v=g.getFullYear(),S=v<1;S&&(v=Math.abs(v)+1);var x=h(v,4)+"-"+h(g.getMonth()+1,2)+"-"+h(g.getDate(),2)+"T"+h(g.getHours(),2)+":"+h(g.getMinutes(),2)+":"+h(g.getSeconds(),2)+"."+h(g.getMilliseconds(),3);return l<0?(x+="-",l*=-1):x+="+",x+=h(Math.floor(l/60),2)+":"+h(l%60,2),S&&(x+=" BC"),x}m(p,"dateToString");function f(g){var l=g.getUTCFullYear(),v=l<1;v&&(l=Math.abs(l)+1);var S=h(l,4)+"-"+h(g.getUTCMonth()+1,2)+"-"+h(g.getUTCDate(),2)+"T"+h(g.getUTCHours(),2)+":"+h(g.getUTCMinutes(),2)+":"+h(g.getUTCSeconds(),2)+"."+h(g.getUTCMilliseconds(),3);return S+="+00:00",v&&(S+=" BC"),S}m(f,"dateToStringUTC");function y(g,l,v){return g=typeof g=="string"?{text:g}:g,l&&(typeof l=="function"?g.callback=l:g.values=l),v&&(g.callback=v),g}m(y,"normalizeQueryConfig");var b=m(function(g){return t.createHash("md5").update(g,"utf-8").digest("hex")},"md5"),w=m(function(g,l,v){var S=b(l+g),x=b(ne.concat([ne.from(S),v]));return"md5"+x},"postgresMd5PasswordHash");e.exports={prepareValue:m(function(g){return a(g)},"prepareValueWrapper"),normalizeQueryConfig:y,postgresMd5PasswordHash:w,md5:b}}),fl=le((r,e)=>{"use strict";X();var t=(bo(),ke(Yn));function n(l){if(l.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let v=t.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:v,response:"n,,n=*,r="+v,message:"SASLInitialResponse"}}m(n,"startSession");function s(l,v,S){if(l.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof v!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(typeof S!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let x=p(S);if(x.nonce.startsWith(l.clientNonce)){if(x.nonce.length===l.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var T=ne.from(x.salt,"base64"),O=g(v,T,x.iteration),L=w(O,"Client Key"),_=b(L),I="n=*,r="+l.clientNonce,P="r="+x.nonce+",s="+x.salt+",i="+x.iteration,E="c=biws,r="+x.nonce,$=I+","+P+","+E,R=w(_,$),Z=y(L,R),W=Z.toString("base64"),M=w(O,"Server Key"),F=w(M,$);l.message="SASLResponse",l.serverSignature=F.toString("base64"),l.response=E+",p="+W}m(s,"continueSession");function i(l,v){if(l.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof v!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:S}=f(v);if(S!==l.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}m(i,"finalizeSession");function a(l){if(typeof l!="string")throw new TypeError("SASL: text must be a string");return l.split("").map((v,S)=>l.charCodeAt(S)).every(v=>v>=33&&v<=43||v>=45&&v<=126)}m(a,"isPrintableChars");function o(l){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(l)}m(o,"isBase64");function h(l){if(typeof l!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(l.split(",").map(v=>{if(!/^.=/.test(v))throw new Error("SASL: Invalid attribute pair entry");let S=v[0],x=v.substring(2);return[S,x]}))}m(h,"parseAttributePairs");function p(l){let v=h(l),S=v.get("r");if(S){if(!a(S))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let x=v.get("s");if(x){if(!o(x))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let T=v.get("i");if(T){if(!/^[1-9][0-9]*$/.test(T))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let O=parseInt(T,10);return{nonce:S,salt:x,iteration:O}}m(p,"parseServerFirstMessage");function f(l){let v=h(l).get("v");if(v){if(!o(v))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:v}}m(f,"parseServerFinalMessage");function y(l,v){if(!ne.isBuffer(l))throw new TypeError("first argument must be a Buffer");if(!ne.isBuffer(v))throw new TypeError("second argument must be a Buffer");if(l.length!==v.length)throw new Error("Buffer lengths must match");if(l.length===0)throw new Error("Buffers cannot be empty");return ne.from(l.map((S,x)=>l[x]^v[x]))}m(y,"xorBuffers");function b(l){return t.createHash("sha256").update(l).digest()}m(b,"sha256");function w(l,v){return t.createHmac("sha256",l).update(v).digest()}m(w,"hmacSha256");function g(l,v,S){for(var x=w(l,ne.concat([v,ne.from([0,0,0,1])])),T=x,O=0;O<S-1;O++)x=w(l,x),T=y(T,x);return T}m(g,"Hi"),e.exports={startSession:n,continueSession:s,finalizeSession:i}}),es={};Je(es,{join:()=>_o});function _o(...r){return r.join("/")}var xo=je(()=>{"use strict";X(),m(_o,"join")}),ts={};Je(ts,{stat:()=>Co});function Co(r,e){e(new Error("No filesystem"))}var To=je(()=>{"use strict";X(),m(Co,"stat")}),rs={};Je(rs,{default:()=>Eo});var Eo,Ao=je(()=>{"use strict";X(),Eo={}}),No={};Je(No,{StringDecoder:()=>Po});var Wn,Po,dl=je(()=>{"use strict";X(),Wn=class{constructor(e){se(this,"td"),this.td=new TextDecoder(e)}write(e){return this.td.decode(e,{stream:!0})}end(e){return this.td.decode(e)}},m(Wn,"StringDecoder"),Po=Wn}),pl=le((r,e)=>{"use strict";X();var{Transform:t}=(Ao(),ke(rs)),{StringDecoder:n}=(dl(),ke(No)),s=Symbol("last"),i=Symbol("decoder");function a(y,b,w){let g;if(this.overflow){if(g=this[i].write(y).split(this.matcher),g.length===1)return w();g.shift(),this.overflow=!1}else this[s]+=this[i].write(y),g=this[s].split(this.matcher);this[s]=g.pop();for(let l=0;l<g.length;l++)try{h(this,this.mapper(g[l]))}catch(v){return w(v)}if(this.overflow=this[s].length>this.maxLength,this.overflow&&!this.skipOverflow){w(new Error("maximum buffer reached"));return}w()}m(a,"transform");function o(y){if(this[s]+=this[i].end(),this[s])try{h(this,this.mapper(this[s]))}catch(b){return y(b)}y()}m(o,"flush");function h(y,b){b!==void 0&&y.push(b)}m(h,"push");function p(y){return y}m(p,"noop");function f(y,b,w){switch(y=y||/\r?\n/,b=b||p,w=w||{},arguments.length){case 1:typeof y=="function"?(b=y,y=/\r?\n/):typeof y=="object"&&!(y instanceof RegExp)&&!y[Symbol.split]&&(w=y,y=/\r?\n/);break;case 2:typeof y=="function"?(w=b,b=y,y=/\r?\n/):typeof b=="object"&&(w=b,b=p)}w=Object.assign({},w),w.autoDestroy=!0,w.transform=a,w.flush=o,w.readableObjectMode=!0;let g=new t(w);return g[s]="",g[i]=new n("utf8"),g.matcher=y,g.mapper=b,g.maxLength=w.maxLength,g.skipOverflow=w.skipOverflow||!1,g.overflow=!1,g._destroy=function(l,v){this._writableState.errorEmitted=!1,v(l)},g}m(f,"split"),e.exports=f}),ml=le((r,e)=>{"use strict";X();var t=(xo(),ke(es)),n=(Ao(),ke(rs)).Stream,s=pl(),i=(en(),ke(xr)),a=5432,o=ue.platform==="win32",h=ue.stderr,p=56,f=7,y=61440,b=32768;function w(L){return(L&y)==b}m(w,"isRegFile");var g=["host","port","database","user","password"],l=g.length,v=g[l-1];function S(){var L=h instanceof n&&h.writable===!0;if(L){var _=Array.prototype.slice.call(arguments).concat(`
`);h.write(i.format.apply(i,_))}}m(S,"warn"),Object.defineProperty(e.exports,"isWin",{get:m(function(){return o},"get"),set:m(function(L){o=L},"set")}),e.exports.warnTo=function(L){var _=h;return h=L,_},e.exports.getFileName=function(L){var _=L||ue.env,I=_.PGPASSFILE||(o?t.join(_.APPDATA||"./","postgresql","pgpass.conf"):t.join(_.HOME||"./",".pgpass"));return I},e.exports.usePgPass=function(L,_){return Object.prototype.hasOwnProperty.call(ue.env,"PGPASSWORD")?!1:o?!0:(_=_||"<unkn>",w(L.mode)?L.mode&(p|f)?(S('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',_),!1):!0:(S('WARNING: password file "%s" is not a plain file',_),!1))};var x=e.exports.match=function(L,_){return g.slice(0,-1).reduce(function(I,P,E){return E==1&&Number(L[P]||a)===Number(_[P])?I&&!0:I&&(_[P]==="*"||_[P]===L[P])},!0)};e.exports.getPassword=function(L,_,I){var P,E=_.pipe(s());function $(W){var M=T(W);M&&O(M)&&x(L,M)&&(P=M[v],E.end())}m($,"onLine");var R=m(function(){_.destroy(),I(P)},"onEnd"),Z=m(function(W){_.destroy(),S("WARNING: error on reading file: %s",W),I(void 0)},"onErr");_.on("error",Z),E.on("data",$).on("end",R).on("error",Z)};var T=e.exports.parseLine=function(L){if(L.length<11||L.match(/^\s+#/))return null;for(var _="",I="",P=0,E=0,$=0,R={},Z=!1,W=m(function(F,J,ie){var fe=L.substring(J,ie);Object.hasOwnProperty.call(ue.env,"PGPASS_NO_DEESCAPE")||(fe=fe.replace(/\\([:\\])/g,"$1")),R[g[F]]=fe},"addToObj"),M=0;M<L.length-1;M+=1){if(_=L.charAt(M+1),I=L.charAt(M),Z=P==l-1,Z){W(P,E);break}M>=0&&_==":"&&I!=="\\"&&(W(P,E,M+1),E=M+2,P+=1)}return R=Object.keys(R).length===l?R:null,R},O=e.exports.isValidEntry=function(L){for(var _={0:function(R){return R.length>0},1:function(R){return R==="*"?!0:(R=Number(R),isFinite(R)&&R>0&&R<9007199254740992&&Math.floor(R)===R)},2:function(R){return R.length>0},3:function(R){return R.length>0},4:function(R){return R.length>0}},I=0;I<g.length;I+=1){var P=_[I],E=L[g[I]]||"",$=P(E);if(!$)return!1}return!0}}),gl=le((r,e)=>{"use strict";X();var t=(xo(),ke(es)),n=(To(),ke(ts)),s=ml();e.exports=function(i,a){var o=s.getFileName();n.stat(o,function(h,p){if(h||!s.usePgPass(p,o))return a(void 0);var f=n.createReadStream(o);s.getPassword(i,f,a)})},e.exports.warnTo=s.warnTo}),ns=le((r,e)=>{"use strict";X();var t=tn();function n(s){this._types=s||t,this.text={},this.binary={}}m(n,"TypeOverrides"),n.prototype.getOverrides=function(s){switch(s){case"text":return this.text;case"binary":return this.binary;default:return{}}},n.prototype.setTypeParser=function(s,i,a){typeof i=="function"&&(a=i,i="text"),this.getOverrides(i)[s]=a},n.prototype.getTypeParser=function(s,i){return i=i||"text",this.getOverrides(i)[s]||this._types.getTypeParser(s,i)},e.exports=n}),Io={};Je(Io,{default:()=>ko});var ko,yl=je(()=>{"use strict";X(),ko={}}),Oo={};Je(Oo,{parse:()=>ss});function ss(r,e=!1){let{protocol:t}=new URL(r),n="http:"+r.substring(t.length),{username:s,password:i,host:a,hostname:o,port:h,pathname:p,search:f,searchParams:y,hash:b}=new URL(n);i=decodeURIComponent(i),s=decodeURIComponent(s),p=decodeURIComponent(p);let w=s+":"+i,g=e?Object.fromEntries(y.entries()):f;return{href:r,protocol:t,auth:w,username:s,password:i,host:a,hostname:o,port:h,pathname:p,search:f,query:g,hash:b}}var Lo=je(()=>{"use strict";X(),m(ss,"parse")}),bl=le((r,e)=>{"use strict";X();var t=(Lo(),ke(Oo)),n=(To(),ke(ts));function s(i){if(i.charAt(0)==="/"){var o=i.split(" ");return{host:o[0],database:o[1]}}var a=t.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(i)?encodeURI(i).replace(/\%25(\d\d)/g,"%$1"):i,!0),o=a.query;for(var h in o)Array.isArray(o[h])&&(o[h]=o[h][o[h].length-1]);var p=(a.auth||":").split(":");if(o.user=p[0],o.password=p.splice(1).join(":"),o.port=a.port,a.protocol=="socket:")return o.host=decodeURI(a.pathname),o.database=a.query.db,o.client_encoding=a.query.encoding,o;o.host||(o.host=a.hostname);var f=a.pathname;if(!o.host&&f&&/^%2f/i.test(f)){var y=f.split("/");o.host=decodeURIComponent(y[0]),f=y.splice(1).join("/")}switch(f&&f.charAt(0)==="/"&&(f=f.slice(1)||null),o.database=f&&decodeURI(f),(o.ssl==="true"||o.ssl==="1")&&(o.ssl=!0),o.ssl==="0"&&(o.ssl=!1),(o.sslcert||o.sslkey||o.sslrootcert||o.sslmode)&&(o.ssl={}),o.sslcert&&(o.ssl.cert=n.readFileSync(o.sslcert).toString()),o.sslkey&&(o.ssl.key=n.readFileSync(o.sslkey).toString()),o.sslrootcert&&(o.ssl.ca=n.readFileSync(o.sslrootcert).toString()),o.sslmode){case"disable":{o.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{o.ssl.rejectUnauthorized=!1;break}}return o}m(s,"parse"),e.exports=s,s.parse=s}),is=le((r,e)=>{"use strict";X();var t=(yl(),ke(Io)),n=rn(),s=bl().parse,i=m(function(y,b,w){return w===void 0?w=ue.env["PG"+y.toUpperCase()]:w===!1||(w=ue.env[w]),b[y]||w||n[y]},"val"),a=m(function(){switch(ue.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return n.ssl},"readSSLConfigFromEnvironment"),o=m(function(y){return"'"+(""+y).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),h=m(function(y,b,w){var g=b[w];g!=null&&y.push(w+"="+o(g))},"add"),p=class{constructor(b){b=typeof b=="string"?s(b):b||{},b.connectionString&&(b=Object.assign({},b,s(b.connectionString))),this.user=i("user",b),this.database=i("database",b),this.database===void 0&&(this.database=this.user),this.port=parseInt(i("port",b),10),this.host=i("host",b),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:i("password",b)}),this.binary=i("binary",b),this.options=i("options",b),this.ssl=typeof b.ssl>"u"?a():b.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=i("client_encoding",b),this.replication=i("replication",b),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=i("application_name",b,"PGAPPNAME"),this.fallback_application_name=i("fallback_application_name",b,!1),this.statement_timeout=i("statement_timeout",b,!1),this.lock_timeout=i("lock_timeout",b,!1),this.idle_in_transaction_session_timeout=i("idle_in_transaction_session_timeout",b,!1),this.query_timeout=i("query_timeout",b,!1),b.connectionTimeoutMillis===void 0?this.connect_timeout=ue.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(b.connectionTimeoutMillis/1e3),b.keepAlive===!1?this.keepalives=0:b.keepAlive===!0&&(this.keepalives=1),typeof b.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(b.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(b){var w=[];h(w,this,"user"),h(w,this,"password"),h(w,this,"port"),h(w,this,"application_name"),h(w,this,"fallback_application_name"),h(w,this,"connect_timeout"),h(w,this,"options");var g=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(h(w,g,"sslmode"),h(w,g,"sslca"),h(w,g,"sslkey"),h(w,g,"sslcert"),h(w,g,"sslrootcert"),this.database&&w.push("dbname="+o(this.database)),this.replication&&w.push("replication="+o(this.replication)),this.host&&w.push("host="+o(this.host)),this.isDomainSocket)return b(null,w.join(" "));this.client_encoding&&w.push("client_encoding="+o(this.client_encoding)),t.lookup(this.host,function(l,v){return l?b(l,null):(w.push("hostaddr="+o(v)),b(null,w.join(" ")))})}};m(p,"ConnectionParameters");var f=p;e.exports=f}),vl=le((r,e)=>{"use strict";X();var t=tn(),n=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,s=class{constructor(o,h){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=h,this.RowCtor=null,this.rowAsArray=o==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(o){var h;o.text?h=n.exec(o.text):h=n.exec(o.command),h&&(this.command=h[1],h[3]?(this.oid=parseInt(h[2],10),this.rowCount=parseInt(h[3],10)):h[2]&&(this.rowCount=parseInt(h[2],10)))}_parseRowAsArray(o){for(var h=new Array(o.length),p=0,f=o.length;p<f;p++){var y=o[p];y!==null?h[p]=this._parsers[p](y):h[p]=null}return h}parseRow(o){for(var h={},p=0,f=o.length;p<f;p++){var y=o[p],b=this.fields[p].name;y!==null?h[b]=this._parsers[p](y):h[b]=null}return h}addRow(o){this.rows.push(o)}addFields(o){this.fields=o,this.fields.length&&(this._parsers=new Array(o.length));for(var h=0;h<o.length;h++){var p=o[h];this._types?this._parsers[h]=this._types.getTypeParser(p.dataTypeID,p.format||"text"):this._parsers[h]=t.getTypeParser(p.dataTypeID,p.format||"text")}}};m(s,"Result");var i=s;e.exports=i}),wl=le((r,e)=>{"use strict";X();var{EventEmitter:t}=It(),n=vl(),s=nn(),i=class extends t{constructor(h,p,f){super(),h=s.normalizeQueryConfig(h,p,f),this.text=h.text,this.values=h.values,this.rows=h.rows,this.types=h.types,this.name=h.name,this.binary=h.binary,this.portal=h.portal||"",this.callback=h.callback,this._rowMode=h.rowMode,ue.domain&&h.callback&&(this.callback=ue.domain.bind(h.callback)),this._result=new n(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new n(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(h){this._checkForMultirow(),this._result.addFields(h.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(h){let p;if(!this._canceledDueToError){try{p=this._result.parseRow(h.fields)}catch(f){this._canceledDueToError=f;return}this.emit("row",p,this._result),this._accumulateRows&&this._result.addRow(p)}}handleCommandComplete(h,p){this._checkForMultirow(),this._result.addCommandComplete(h),this.rows&&p.sync()}handleEmptyQuery(h){this.rows&&h.sync()}handleError(h,p){if(this._canceledDueToError&&(h=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(h);this.emit("error",h)}handleReadyForQuery(h){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,h);if(this.callback)try{this.callback(null,this._results)}catch(p){ue.nextTick(()=>{throw p})}this.emit("end",this._results)}submit(h){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let p=h.parsedStatements[this.name];return this.text&&p&&this.text!==p?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(h):h.query(this.text),null)}hasBeenParsed(h){return this.name&&h.parsedStatements[this.name]}handlePortalSuspended(h){this._getRows(h,this.rows)}_getRows(h,p){h.execute({portal:this.portal,rows:p}),p?h.flush():h.sync()}prepare(h){this.isPreparedStatement=!0,this.hasBeenParsed(h)||h.parse({text:this.text,name:this.name,types:this.types});try{h.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:s.prepareValue})}catch(p){this.handleError(p,h);return}h.describe({type:"P",name:this.portal||""}),this._getRows(h,this.rows)}handleCopyInResponse(h){h.sendCopyFail("No source stream defined")}handleCopyData(h,p){}};m(i,"Query");var a=i;e.exports=a}),Mo={};Je(Mo,{Socket:()=>wt,isIP:()=>Ro});function Ro(r){return 0}var lo,Gn,Sr,wt,os=je(()=>{"use strict";X(),lo=tr(It(),1),m(Ro,"isIP"),Gn=/^[^.]+\./,Sr=class Y extends lo.EventEmitter{constructor(){super(...arguments),se(this,"opts",{}),se(this,"connecting",!1),se(this,"pending",!0),se(this,"writable",!0),se(this,"encrypted",!1),se(this,"authorized",!1),se(this,"destroyed",!1),se(this,"ws",null),se(this,"writeBuffer"),se(this,"tlsState",0),se(this,"tlsRead"),se(this,"tlsWrite")}static get poolQueryViaFetch(){return Y.opts.poolQueryViaFetch??Y.defaults.poolQueryViaFetch}static set poolQueryViaFetch(e){Y.opts.poolQueryViaFetch=e}static get fetchEndpoint(){return Y.opts.fetchEndpoint??Y.defaults.fetchEndpoint}static set fetchEndpoint(e){Y.opts.fetchEndpoint=e}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(e){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return Y.opts.fetchFunction??Y.defaults.fetchFunction}static set fetchFunction(e){Y.opts.fetchFunction=e}static get webSocketConstructor(){return Y.opts.webSocketConstructor??Y.defaults.webSocketConstructor}static set webSocketConstructor(e){Y.opts.webSocketConstructor=e}get webSocketConstructor(){return this.opts.webSocketConstructor??Y.webSocketConstructor}set webSocketConstructor(e){this.opts.webSocketConstructor=e}static get wsProxy(){return Y.opts.wsProxy??Y.defaults.wsProxy}static set wsProxy(e){Y.opts.wsProxy=e}get wsProxy(){return this.opts.wsProxy??Y.wsProxy}set wsProxy(e){this.opts.wsProxy=e}static get coalesceWrites(){return Y.opts.coalesceWrites??Y.defaults.coalesceWrites}static set coalesceWrites(e){Y.opts.coalesceWrites=e}get coalesceWrites(){return this.opts.coalesceWrites??Y.coalesceWrites}set coalesceWrites(e){this.opts.coalesceWrites=e}static get useSecureWebSocket(){return Y.opts.useSecureWebSocket??Y.defaults.useSecureWebSocket}static set useSecureWebSocket(e){Y.opts.useSecureWebSocket=e}get useSecureWebSocket(){return this.opts.useSecureWebSocket??Y.useSecureWebSocket}set useSecureWebSocket(e){this.opts.useSecureWebSocket=e}static get forceDisablePgSSL(){return Y.opts.forceDisablePgSSL??Y.defaults.forceDisablePgSSL}static set forceDisablePgSSL(e){Y.opts.forceDisablePgSSL=e}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??Y.forceDisablePgSSL}set forceDisablePgSSL(e){this.opts.forceDisablePgSSL=e}static get disableSNI(){return Y.opts.disableSNI??Y.defaults.disableSNI}static set disableSNI(e){Y.opts.disableSNI=e}get disableSNI(){return this.opts.disableSNI??Y.disableSNI}set disableSNI(e){this.opts.disableSNI=e}static get pipelineConnect(){return Y.opts.pipelineConnect??Y.defaults.pipelineConnect}static set pipelineConnect(e){Y.opts.pipelineConnect=e}get pipelineConnect(){return this.opts.pipelineConnect??Y.pipelineConnect}set pipelineConnect(e){this.opts.pipelineConnect=e}static get subtls(){return Y.opts.subtls??Y.defaults.subtls}static set subtls(e){Y.opts.subtls=e}get subtls(){return this.opts.subtls??Y.subtls}set subtls(e){this.opts.subtls=e}static get pipelineTLS(){return Y.opts.pipelineTLS??Y.defaults.pipelineTLS}static set pipelineTLS(e){Y.opts.pipelineTLS=e}get pipelineTLS(){return this.opts.pipelineTLS??Y.pipelineTLS}set pipelineTLS(e){this.opts.pipelineTLS=e}static get rootCerts(){return Y.opts.rootCerts??Y.defaults.rootCerts}static set rootCerts(e){Y.opts.rootCerts=e}get rootCerts(){return this.opts.rootCerts??Y.rootCerts}set rootCerts(e){this.opts.rootCerts=e}wsProxyAddrForHost(e,t){let n=this.wsProxy;if(n===void 0)throw new Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return typeof n=="function"?n(e,t):`${n}?address=${e}:${t}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(e,t,n){this.connecting=!0,n&&this.once("connect",n);let s=m(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),i=m((o,h=!1)=>{o.binaryType="arraybuffer",o.addEventListener("error",p=>{this.emit("error",p),this.emit("close")}),o.addEventListener("message",p=>{if(this.tlsState===0){let f=ne.from(p.data);this.emit("data",f)}}),o.addEventListener("close",()=>{this.emit("close")}),h?s():o.addEventListener("open",s)},"configureWebSocket"),a;try{a=this.wsProxyAddrForHost(t,typeof e=="string"?parseInt(e,10):e)}catch(o){this.emit("error",o),this.emit("close");return}try{let o=(this.useSecureWebSocket?"wss:":"ws:")+"//"+a;if(this.webSocketConstructor!==void 0)this.ws=new this.webSocketConstructor(o),i(this.ws);else try{this.ws=new WebSocket(o),i(this.ws)}catch{this.ws=new __unstable_WebSocket(o),i(this.ws)}}catch(o){let h=(this.useSecureWebSocket?"https:":"http:")+"//"+a;fetch(h,{headers:{Upgrade:"websocket"}}).then(p=>{if(this.ws=p.webSocket,this.ws==null)throw o;this.ws.accept(),i(this.ws,!0)}).catch(p=>{this.emit("error",new Error(`All attempts to open a WebSocket to connect to the database failed. Please refer to https://github.com/neondatabase/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websocket--undefined. Details: ${p.message}`)),this.emit("close")})}}async startTls(e){if(this.subtls===void 0)throw new Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let t=this.subtls.TrustedCert.fromPEM(this.rootCerts),n=new this.subtls.WebSocketReadQueue(this.ws),s=n.read.bind(n),i=this.rawWrite.bind(this),[a,o]=await this.subtls.startTls(e,t,s,i,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=a,this.tlsWrite=o,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let e=await this.tlsRead();if(e===void 0)break;{let t=ne.from(e);this.emit("data",t)}}}rawWrite(e){if(!this.coalesceWrites){this.ws.send(e);return}if(this.writeBuffer===void 0)this.writeBuffer=e,setTimeout(()=>{this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let t=new Uint8Array(this.writeBuffer.length+e.length);t.set(this.writeBuffer),t.set(e,this.writeBuffer.length),this.writeBuffer=t}}write(e,t="utf8",n=s=>{}){return e.length===0?(n(),!0):(typeof e=="string"&&(e=ne.from(e,t)),this.tlsState===0?(this.rawWrite(e),n()):this.tlsState===1?this.once("secureConnection",()=>{this.write(e,t,n)}):(this.tlsWrite(e),n()),!0)}end(e=ne.alloc(0),t="utf8",n=()=>{}){return this.write(e,t,()=>{this.ws.close(),n()}),this}destroy(){return this.destroyed=!0,this.end()}},m(Sr,"Socket"),se(Sr,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:m((r,e,t)=>{let n;return t?.jwtAuth?n=r.replace(Gn,"apiauth."):n=r.replace(Gn,"api."),"https://"+n+"/sql"},"fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:m(r=>r+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1}),se(Sr,"opts",{}),wt=Sr}),Bo=le(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.NoticeMessage=r.DataRowMessage=r.CommandCompleteMessage=r.ReadyForQueryMessage=r.NotificationResponseMessage=r.BackendKeyDataMessage=r.AuthenticationMD5Password=r.ParameterStatusMessage=r.ParameterDescriptionMessage=r.RowDescriptionMessage=r.Field=r.CopyResponse=r.CopyDataMessage=r.DatabaseError=r.copyDone=r.emptyQuery=r.replicationStart=r.portalSuspended=r.noData=r.closeComplete=r.bindComplete=r.parseComplete=void 0,r.parseComplete={name:"parseComplete",length:5},r.bindComplete={name:"bindComplete",length:5},r.closeComplete={name:"closeComplete",length:5},r.noData={name:"noData",length:5},r.portalSuspended={name:"portalSuspended",length:5},r.replicationStart={name:"replicationStart",length:4},r.emptyQuery={name:"emptyQuery",length:4},r.copyDone={name:"copyDone",length:4};var e=class extends Error{constructor(M,F,J){super(M),this.length=F,this.name=J}};m(e,"DatabaseError");var t=e;r.DatabaseError=t;var n=class{constructor(M,F){this.length=M,this.chunk=F,this.name="copyData"}};m(n,"CopyDataMessage");var s=n;r.CopyDataMessage=s;var i=class{constructor(M,F,J,ie){this.length=M,this.name=F,this.binary=J,this.columnTypes=new Array(ie)}};m(i,"CopyResponse");var a=i;r.CopyResponse=a;var o=class{constructor(M,F,J,ie,fe,pe,Pe){this.name=M,this.tableID=F,this.columnID=J,this.dataTypeID=ie,this.dataTypeSize=fe,this.dataTypeModifier=pe,this.format=Pe}};m(o,"Field");var h=o;r.Field=h;var p=class{constructor(M,F){this.length=M,this.fieldCount=F,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};m(p,"RowDescriptionMessage");var f=p;r.RowDescriptionMessage=f;var y=class{constructor(M,F){this.length=M,this.parameterCount=F,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};m(y,"ParameterDescriptionMessage");var b=y;r.ParameterDescriptionMessage=b;var w=class{constructor(M,F,J){this.length=M,this.parameterName=F,this.parameterValue=J,this.name="parameterStatus"}};m(w,"ParameterStatusMessage");var g=w;r.ParameterStatusMessage=g;var l=class{constructor(M,F){this.length=M,this.salt=F,this.name="authenticationMD5Password"}};m(l,"AuthenticationMD5Password");var v=l;r.AuthenticationMD5Password=v;var S=class{constructor(M,F,J){this.length=M,this.processID=F,this.secretKey=J,this.name="backendKeyData"}};m(S,"BackendKeyDataMessage");var x=S;r.BackendKeyDataMessage=x;var T=class{constructor(M,F,J,ie){this.length=M,this.processId=F,this.channel=J,this.payload=ie,this.name="notification"}};m(T,"NotificationResponseMessage");var O=T;r.NotificationResponseMessage=O;var L=class{constructor(M,F){this.length=M,this.status=F,this.name="readyForQuery"}};m(L,"ReadyForQueryMessage");var _=L;r.ReadyForQueryMessage=_;var I=class{constructor(M,F){this.length=M,this.text=F,this.name="commandComplete"}};m(I,"CommandCompleteMessage");var P=I;r.CommandCompleteMessage=P;var E=class{constructor(M,F){this.length=M,this.fields=F,this.name="dataRow",this.fieldCount=F.length}};m(E,"DataRowMessage");var $=E;r.DataRowMessage=$;var R=class{constructor(M,F){this.length=M,this.message=F,this.name="notice"}};m(R,"NoticeMessage");var Z=R;r.NoticeMessage=Z}),Sl=le(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.Writer=void 0;var e=class{constructor(s=256){this.size=s,this.offset=5,this.headerPosition=0,this.buffer=ne.allocUnsafe(s)}ensure(s){var i=this.buffer.length-this.offset;if(i<s){var a=this.buffer,o=a.length+(a.length>>1)+s;this.buffer=ne.allocUnsafe(o),a.copy(this.buffer)}}addInt32(s){return this.ensure(4),this.buffer[this.offset++]=s>>>24&255,this.buffer[this.offset++]=s>>>16&255,this.buffer[this.offset++]=s>>>8&255,this.buffer[this.offset++]=s>>>0&255,this}addInt16(s){return this.ensure(2),this.buffer[this.offset++]=s>>>8&255,this.buffer[this.offset++]=s>>>0&255,this}addCString(s){if(!s)this.ensure(1);else{var i=ne.byteLength(s);this.ensure(i+1),this.buffer.write(s,this.offset,"utf-8"),this.offset+=i}return this.buffer[this.offset++]=0,this}addString(s=""){var i=ne.byteLength(s);return this.ensure(i),this.buffer.write(s,this.offset),this.offset+=i,this}add(s){return this.ensure(s.length),s.copy(this.buffer,this.offset),this.offset+=s.length,this}join(s){if(s){this.buffer[this.headerPosition]=s;let i=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(i,this.headerPosition+1)}return this.buffer.slice(s?0:5,this.offset)}flush(s){var i=this.join(s);return this.offset=5,this.headerPosition=0,this.buffer=ne.allocUnsafe(this.size),i}};m(e,"Writer");var t=e;r.Writer=t}),_l=le(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.serialize=void 0;var e=Sl(),t=new e.Writer,n=m(M=>{t.addInt16(3).addInt16(0);for(let ie of Object.keys(M))t.addCString(ie).addCString(M[ie]);t.addCString("client_encoding").addCString("UTF8");var F=t.addCString("").flush(),J=F.length+4;return new e.Writer().addInt32(J).add(F).flush()},"startup"),s=m(()=>{let M=ne.allocUnsafe(8);return M.writeInt32BE(8,0),M.writeInt32BE(80877103,4),M},"requestSsl"),i=m(M=>t.addCString(M).flush(112),"password"),a=m(function(M,F){return t.addCString(M).addInt32(ne.byteLength(F)).addString(F),t.flush(112)},"sendSASLInitialResponseMessage"),o=m(function(M){return t.addString(M).flush(112)},"sendSCRAMClientFinalMessage"),h=m(M=>t.addCString(M).flush(81),"query"),p=[],f=m(M=>{let F=M.name||"";F.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",F,F.length),console.error("This can cause conflicts and silent errors executing queries"));let J=M.types||p;for(var ie=J.length,fe=t.addCString(F).addCString(M.text).addInt16(ie),pe=0;pe<ie;pe++)fe.addInt32(J[pe]);return t.flush(80)},"parse"),y=new e.Writer,b=m(function(M,F){for(let J=0;J<M.length;J++){let ie=F?F(M[J],J):M[J];ie==null?(t.addInt16(0),y.addInt32(-1)):ie instanceof ne?(t.addInt16(1),y.addInt32(ie.length),y.add(ie)):(t.addInt16(0),y.addInt32(ne.byteLength(ie)),y.addString(ie))}},"writeValues"),w=m((M={})=>{let F=M.portal||"",J=M.statement||"",ie=M.binary||!1,fe=M.values||p,pe=fe.length;return t.addCString(F).addCString(J),t.addInt16(pe),b(fe,M.valueMapper),t.addInt16(pe),t.add(y.flush()),t.addInt16(ie?1:0),t.flush(66)},"bind"),g=ne.from([69,0,0,0,9,0,0,0,0,0]),l=m(M=>{if(!M||!M.portal&&!M.rows)return g;let F=M.portal||"",J=M.rows||0,ie=ne.byteLength(F),fe=4+ie+1+4,pe=ne.allocUnsafe(1+fe);return pe[0]=69,pe.writeInt32BE(fe,1),pe.write(F,5,"utf-8"),pe[ie+5]=0,pe.writeUInt32BE(J,pe.length-4),pe},"execute"),v=m((M,F)=>{let J=ne.allocUnsafe(16);return J.writeInt32BE(16,0),J.writeInt16BE(1234,4),J.writeInt16BE(5678,6),J.writeInt32BE(M,8),J.writeInt32BE(F,12),J},"cancel"),S=m((M,F)=>{let J=4+ne.byteLength(F)+1,ie=ne.allocUnsafe(1+J);return ie[0]=M,ie.writeInt32BE(J,1),ie.write(F,5,"utf-8"),ie[J]=0,ie},"cstringMessage"),x=t.addCString("P").flush(68),T=t.addCString("S").flush(68),O=m(M=>M.name?S(68,`${M.type}${M.name||""}`):M.type==="P"?x:T,"describe"),L=m(M=>{let F=`${M.type}${M.name||""}`;return S(67,F)},"close"),_=m(M=>t.add(M).flush(100),"copyData"),I=m(M=>S(102,M),"copyFail"),P=m(M=>ne.from([M,0,0,0,4]),"codeOnlyBuffer"),E=P(72),$=P(83),R=P(88),Z=P(99),W={startup:n,password:i,requestSsl:s,sendSASLInitialResponseMessage:a,sendSCRAMClientFinalMessage:o,query:h,parse:f,bind:w,execute:l,describe:O,close:L,flush:m(()=>E,"flush"),sync:m(()=>$,"sync"),end:m(()=>R,"end"),copyData:_,copyDone:m(()=>Z,"copyDone"),copyFail:I,cancel:v};r.serialize=W}),xl=le(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.BufferReader=void 0;var e=ne.allocUnsafe(0),t=class{constructor(i=0){this.offset=i,this.buffer=e,this.encoding="utf-8"}setBuffer(i,a){this.offset=i,this.buffer=a}int16(){let i=this.buffer.readInt16BE(this.offset);return this.offset+=2,i}byte(){let i=this.buffer[this.offset];return this.offset++,i}int32(){let i=this.buffer.readInt32BE(this.offset);return this.offset+=4,i}string(i){let a=this.buffer.toString(this.encoding,this.offset,this.offset+i);return this.offset+=i,a}cstring(){let i=this.offset,a=i;for(;this.buffer[a++]!==0;);return this.offset=a,this.buffer.toString(this.encoding,i,a-1)}bytes(i){let a=this.buffer.slice(this.offset,this.offset+i);return this.offset+=i,a}};m(t,"BufferReader");var n=t;r.BufferReader=n}),Cl=le(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=void 0;var e=Bo(),t=xl(),n=1,s=4,i=n+s,a=ne.allocUnsafe(0),o=class{constructor(f){if(this.buffer=a,this.bufferLength=0,this.bufferOffset=0,this.reader=new t.BufferReader,f?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=f?.mode||"text"}parse(f,y){this.mergeBuffer(f);let b=this.bufferOffset+this.bufferLength,w=this.bufferOffset;for(;w+i<=b;){let g=this.buffer[w],l=this.buffer.readUInt32BE(w+n),v=n+l;if(v+w<=b){let S=this.handlePacket(w+i,g,l,this.buffer);y(S),w+=v}else break}w===b?(this.buffer=a,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=b-w,this.bufferOffset=w)}mergeBuffer(f){if(this.bufferLength>0){let y=this.bufferLength+f.byteLength;if(y+this.bufferOffset>this.buffer.byteLength){let b;if(y<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)b=this.buffer;else{let w=this.buffer.byteLength*2;for(;y>=w;)w*=2;b=ne.allocUnsafe(w)}this.buffer.copy(b,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=b,this.bufferOffset=0}f.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=y}else this.buffer=f,this.bufferOffset=0,this.bufferLength=f.byteLength}handlePacket(f,y,b,w){switch(y){case 50:return e.bindComplete;case 49:return e.parseComplete;case 51:return e.closeComplete;case 110:return e.noData;case 115:return e.portalSuspended;case 99:return e.copyDone;case 87:return e.replicationStart;case 73:return e.emptyQuery;case 68:return this.parseDataRowMessage(f,b,w);case 67:return this.parseCommandCompleteMessage(f,b,w);case 90:return this.parseReadyForQueryMessage(f,b,w);case 65:return this.parseNotificationMessage(f,b,w);case 82:return this.parseAuthenticationResponse(f,b,w);case 83:return this.parseParameterStatusMessage(f,b,w);case 75:return this.parseBackendKeyData(f,b,w);case 69:return this.parseErrorMessage(f,b,w,"error");case 78:return this.parseErrorMessage(f,b,w,"notice");case 84:return this.parseRowDescriptionMessage(f,b,w);case 116:return this.parseParameterDescriptionMessage(f,b,w);case 71:return this.parseCopyInMessage(f,b,w);case 72:return this.parseCopyOutMessage(f,b,w);case 100:return this.parseCopyData(f,b,w);default:return new e.DatabaseError("received invalid response: "+y.toString(16),b,"error")}}parseReadyForQueryMessage(f,y,b){this.reader.setBuffer(f,b);let w=this.reader.string(1);return new e.ReadyForQueryMessage(y,w)}parseCommandCompleteMessage(f,y,b){this.reader.setBuffer(f,b);let w=this.reader.cstring();return new e.CommandCompleteMessage(y,w)}parseCopyData(f,y,b){let w=b.slice(f,f+(y-4));return new e.CopyDataMessage(y,w)}parseCopyInMessage(f,y,b){return this.parseCopyMessage(f,y,b,"copyInResponse")}parseCopyOutMessage(f,y,b){return this.parseCopyMessage(f,y,b,"copyOutResponse")}parseCopyMessage(f,y,b,w){this.reader.setBuffer(f,b);let g=this.reader.byte()!==0,l=this.reader.int16(),v=new e.CopyResponse(y,w,g,l);for(let S=0;S<l;S++)v.columnTypes[S]=this.reader.int16();return v}parseNotificationMessage(f,y,b){this.reader.setBuffer(f,b);let w=this.reader.int32(),g=this.reader.cstring(),l=this.reader.cstring();return new e.NotificationResponseMessage(y,w,g,l)}parseRowDescriptionMessage(f,y,b){this.reader.setBuffer(f,b);let w=this.reader.int16(),g=new e.RowDescriptionMessage(y,w);for(let l=0;l<w;l++)g.fields[l]=this.parseField();return g}parseField(){let f=this.reader.cstring(),y=this.reader.int32(),b=this.reader.int16(),w=this.reader.int32(),g=this.reader.int16(),l=this.reader.int32(),v=this.reader.int16()===0?"text":"binary";return new e.Field(f,y,b,w,g,l,v)}parseParameterDescriptionMessage(f,y,b){this.reader.setBuffer(f,b);let w=this.reader.int16(),g=new e.ParameterDescriptionMessage(y,w);for(let l=0;l<w;l++)g.dataTypeIDs[l]=this.reader.int32();return g}parseDataRowMessage(f,y,b){this.reader.setBuffer(f,b);let w=this.reader.int16(),g=new Array(w);for(let l=0;l<w;l++){let v=this.reader.int32();g[l]=v===-1?null:this.reader.string(v)}return new e.DataRowMessage(y,g)}parseParameterStatusMessage(f,y,b){this.reader.setBuffer(f,b);let w=this.reader.cstring(),g=this.reader.cstring();return new e.ParameterStatusMessage(y,w,g)}parseBackendKeyData(f,y,b){this.reader.setBuffer(f,b);let w=this.reader.int32(),g=this.reader.int32();return new e.BackendKeyDataMessage(y,w,g)}parseAuthenticationResponse(f,y,b){this.reader.setBuffer(f,b);let w=this.reader.int32(),g={name:"authenticationOk",length:y};switch(w){case 0:break;case 3:g.length===8&&(g.name="authenticationCleartextPassword");break;case 5:if(g.length===12){g.name="authenticationMD5Password";let v=this.reader.bytes(4);return new e.AuthenticationMD5Password(y,v)}break;case 10:g.name="authenticationSASL",g.mechanisms=[];let l;do l=this.reader.cstring(),l&&g.mechanisms.push(l);while(l);break;case 11:g.name="authenticationSASLContinue",g.data=this.reader.string(y-8);break;case 12:g.name="authenticationSASLFinal",g.data=this.reader.string(y-8);break;default:throw new Error("Unknown authenticationOk message type "+w)}return g}parseErrorMessage(f,y,b,w){this.reader.setBuffer(f,b);let g={},l=this.reader.string(1);for(;l!=="\0";)g[l]=this.reader.cstring(),l=this.reader.string(1);let v=g.M,S=w==="notice"?new e.NoticeMessage(y,v):new e.DatabaseError(v,y,w);return S.severity=g.S,S.code=g.C,S.detail=g.D,S.hint=g.H,S.position=g.P,S.internalPosition=g.p,S.internalQuery=g.q,S.where=g.W,S.schema=g.s,S.table=g.t,S.column=g.c,S.dataType=g.d,S.constraint=g.n,S.file=g.F,S.line=g.L,S.routine=g.R,S}};m(o,"Parser");var h=o;r.Parser=h}),$o=le(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.DatabaseError=r.serialize=r.parse=void 0;var e=Bo();Object.defineProperty(r,"DatabaseError",{enumerable:!0,get:m(function(){return e.DatabaseError},"get")});var t=_l();Object.defineProperty(r,"serialize",{enumerable:!0,get:m(function(){return t.serialize},"get")});var n=Cl();function s(i,a){let o=new n.Parser;return i.on("data",h=>o.parse(h,a)),new Promise(h=>i.on("end",()=>h()))}m(s,"parse"),r.parse=s}),Do={};Je(Do,{connect:()=>jo});function jo({socket:r,servername:e}){return r.startTls(e),r}var Tl=je(()=>{"use strict";X(),m(jo,"connect")}),Qo=le((r,e)=>{"use strict";X();var t=(os(),ke(Mo)),n=It().EventEmitter,{parse:s,serialize:i}=$o(),a=i.flush(),o=i.sync(),h=i.end(),p=class extends n{constructor(b){super(),b=b||{},this.stream=b.stream||new t.Socket,this._keepAlive=b.keepAlive,this._keepAliveInitialDelayMillis=b.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=b.ssl||!1,this._ending=!1,this._emitMessage=!1;var w=this;this.on("newListener",function(g){g==="message"&&(w._emitMessage=!0)})}connect(b,w){var g=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(b,w),this.stream.once("connect",function(){g._keepAlive&&g.stream.setKeepAlive(!0,g._keepAliveInitialDelayMillis),g.emit("connect")});let l=m(function(v){g._ending&&(v.code==="ECONNRESET"||v.code==="EPIPE")||g.emit("error",v)},"reportStreamError");if(this.stream.on("error",l),this.stream.on("close",function(){g.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(v){var S=v.toString("utf8");switch(S){case"S":break;case"N":return g.stream.end(),g.emit("error",new Error("The server does not support SSL connections"));default:return g.stream.end(),g.emit("error",new Error("There was an error establishing an SSL connection"))}var x=(Tl(),ke(Do));let T={socket:g.stream};g.ssl!==!0&&(Object.assign(T,g.ssl),"key"in g.ssl&&(T.key=g.ssl.key)),t.isIP(w)===0&&(T.servername=w);try{g.stream=x.connect(T)}catch(O){return g.emit("error",O)}g.attachListeners(g.stream),g.stream.on("error",l),g.emit("sslconnect")})}attachListeners(b){b.on("end",()=>{this.emit("end")}),s(b,w=>{var g=w.name==="error"?"errorMessage":w.name;this._emitMessage&&this.emit("message",w),this.emit(g,w)})}requestSsl(){this.stream.write(i.requestSsl())}startup(b){this.stream.write(i.startup(b))}cancel(b,w){this._send(i.cancel(b,w))}password(b){this._send(i.password(b))}sendSASLInitialResponseMessage(b,w){this._send(i.sendSASLInitialResponseMessage(b,w))}sendSCRAMClientFinalMessage(b){this._send(i.sendSCRAMClientFinalMessage(b))}_send(b){return this.stream.writable?this.stream.write(b):!1}query(b){this._send(i.query(b))}parse(b){this._send(i.parse(b))}bind(b){this._send(i.bind(b))}execute(b){this._send(i.execute(b))}flush(){this.stream.writable&&this.stream.write(a)}sync(){this._ending=!0,this._send(a),this._send(o)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(h,()=>{this.stream.end()})}close(b){this._send(i.close(b))}describe(b){this._send(i.describe(b))}sendCopyFromChunk(b){this._send(i.copyData(b))}endCopyFrom(){this._send(i.copyDone())}sendCopyFail(b){this._send(i.copyFail(b))}};m(p,"Connection");var f=p;e.exports=f}),El=le((r,e)=>{"use strict";X();var t=It().EventEmitter,n=(en(),ke(xr)),s=nn(),i=fl(),a=gl(),o=ns(),h=is(),p=wl(),f=rn(),y=Qo(),b=class extends t{constructor(l){super(),this.connectionParameters=new h(l),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var v=l||{};this._Promise=v.Promise||Yr.Promise,this._types=new o(v.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=v.connection||new y({stream:v.stream,ssl:this.connectionParameters.ssl,keepAlive:v.keepAlive||!1,keepAliveInitialDelayMillis:v.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=v.binary||f.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=v.connectionTimeoutMillis||0}_errorAllQueries(l){let v=m(S=>{ue.nextTick(()=>{S.handleError(l,this.connection)})},"enqueueError");this.activeQuery&&(v(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(v),this.queryQueue.length=0}_connect(l){var v=this,S=this.connection;if(this._connectionCallback=l,this._connecting||this._connected){let x=new Error("Client has already been connected. You cannot reuse a client.");ue.nextTick(()=>{l(x)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{S._ending=!0,S.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?S.connect(this.host+"/.s.PGSQL."+this.port):S.connect(this.port,this.host),S.on("connect",function(){v.ssl?S.requestSsl():S.startup(v.getStartupConf())}),S.on("sslconnect",function(){S.startup(v.getStartupConf())}),this._attachListeners(S),S.once("end",()=>{let x=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(x),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(x):this._handleErrorEvent(x):this._connectionError||this._handleErrorEvent(x)),ue.nextTick(()=>{this.emit("end")})})}connect(l){if(l){this._connect(l);return}return new this._Promise((v,S)=>{this._connect(x=>{x?S(x):v()})})}_attachListeners(l){l.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),l.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),l.on("authenticationSASL",this._handleAuthSASL.bind(this)),l.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),l.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),l.on("backendKeyData",this._handleBackendKeyData.bind(this)),l.on("error",this._handleErrorEvent.bind(this)),l.on("errorMessage",this._handleErrorMessage.bind(this)),l.on("readyForQuery",this._handleReadyForQuery.bind(this)),l.on("notice",this._handleNotice.bind(this)),l.on("rowDescription",this._handleRowDescription.bind(this)),l.on("dataRow",this._handleDataRow.bind(this)),l.on("portalSuspended",this._handlePortalSuspended.bind(this)),l.on("emptyQuery",this._handleEmptyQuery.bind(this)),l.on("commandComplete",this._handleCommandComplete.bind(this)),l.on("parseComplete",this._handleParseComplete.bind(this)),l.on("copyInResponse",this._handleCopyInResponse.bind(this)),l.on("copyData",this._handleCopyData.bind(this)),l.on("notification",this._handleNotification.bind(this))}_checkPgPass(l){let v=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(S=>{if(S!==void 0){if(typeof S!="string"){v.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=S}else this.connectionParameters.password=this.password=null;l()}).catch(S=>{v.emit("error",S)}):this.password!==null?l():a(this.connectionParameters,S=>{S!==void 0&&(this.connectionParameters.password=this.password=S),l()})}_handleAuthCleartextPassword(l){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(l){this._checkPgPass(()=>{let v=s.postgresMd5PasswordHash(this.user,this.password,l.salt);this.connection.password(v)})}_handleAuthSASL(l){this._checkPgPass(()=>{this.saslSession=i.startSession(l.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(l){i.continueSession(this.saslSession,this.password,l.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(l){i.finalizeSession(this.saslSession,l.data),this.saslSession=null}_handleBackendKeyData(l){this.processID=l.processID,this.secretKey=l.secretKey}_handleReadyForQuery(l){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:v}=this;this.activeQuery=null,this.readyForQuery=!0,v&&v.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(l){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(l);this.emit("error",l)}}_handleErrorEvent(l){if(this._connecting)return this._handleErrorWhileConnecting(l);this._queryable=!1,this._errorAllQueries(l),this.emit("error",l)}_handleErrorMessage(l){if(this._connecting)return this._handleErrorWhileConnecting(l);let v=this.activeQuery;if(!v){this._handleErrorEvent(l);return}this.activeQuery=null,v.handleError(l,this.connection)}_handleRowDescription(l){this.activeQuery.handleRowDescription(l)}_handleDataRow(l){this.activeQuery.handleDataRow(l)}_handlePortalSuspended(l){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(l){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(l){this.activeQuery.handleCommandComplete(l,this.connection)}_handleParseComplete(l){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(l){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(l){this.activeQuery.handleCopyData(l,this.connection)}_handleNotification(l){this.emit("notification",l)}_handleNotice(l){this.emit("notice",l)}getStartupConf(){var l=this.connectionParameters,v={user:l.user,database:l.database},S=l.application_name||l.fallback_application_name;return S&&(v.application_name=S),l.replication&&(v.replication=""+l.replication),l.statement_timeout&&(v.statement_timeout=String(parseInt(l.statement_timeout,10))),l.lock_timeout&&(v.lock_timeout=String(parseInt(l.lock_timeout,10))),l.idle_in_transaction_session_timeout&&(v.idle_in_transaction_session_timeout=String(parseInt(l.idle_in_transaction_session_timeout,10))),l.options&&(v.options=l.options),v}cancel(l,v){if(l.activeQuery===v){var S=this.connection;this.host&&this.host.indexOf("/")===0?S.connect(this.host+"/.s.PGSQL."+this.port):S.connect(this.port,this.host),S.on("connect",function(){S.cancel(l.processID,l.secretKey)})}else l.queryQueue.indexOf(v)!==-1&&l.queryQueue.splice(l.queryQueue.indexOf(v),1)}setTypeParser(l,v,S){return this._types.setTypeParser(l,v,S)}getTypeParser(l,v){return this._types.getTypeParser(l,v)}escapeIdentifier(l){return'"'+l.replace(/"/g,'""')+'"'}escapeLiteral(l){for(var v=!1,S="'",x=0;x<l.length;x++){var T=l[x];T==="'"?S+=T+T:T==="\\"?(S+=T+T,v=!0):S+=T}return S+="'",v===!0&&(S=" E"+S),S}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let l=this.activeQuery.submit(this.connection);l&&ue.nextTick(()=>{this.activeQuery.handleError(l,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(l,v,S){var x,T,O,L,_;if(l==null)throw new TypeError("Client was passed a null or undefined query");return typeof l.submit=="function"?(O=l.query_timeout||this.connectionParameters.query_timeout,T=x=l,typeof v=="function"&&(x.callback=x.callback||v)):(O=this.connectionParameters.query_timeout,x=new p(l,v,S),x.callback||(T=new this._Promise((I,P)=>{x.callback=(E,$)=>E?P(E):I($)}))),O&&(_=x.callback,L=setTimeout(()=>{var I=new Error("Query read timeout");ue.nextTick(()=>{x.handleError(I,this.connection)}),_(I),x.callback=()=>{};var P=this.queryQueue.indexOf(x);P>-1&&this.queryQueue.splice(P,1),this._pulseQueryQueue()},O),x.callback=(I,P)=>{clearTimeout(L),_(I,P)}),this.binary&&!x.binary&&(x.binary=!0),x._result&&!x._result._types&&(x._result._types=this._types),this._queryable?this._ending?(ue.nextTick(()=>{x.handleError(new Error("Client was closed and is not queryable"),this.connection)}),T):(this.queryQueue.push(x),this._pulseQueryQueue(),T):(ue.nextTick(()=>{x.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),T)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(l){if(this._ending=!0,!this.connection._connecting)if(l)l();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),l)this.connection.once("end",l);else return new this._Promise(v=>{this.connection.once("end",v)})}};m(b,"Client");var w=b;w.Query=p,e.exports=w}),Al=le((r,e)=>{"use strict";X();var t=It().EventEmitter,n=m(function(){},"NOOP"),s=m((g,l)=>{let v=g.findIndex(l);return v===-1?void 0:g.splice(v,1)[0]},"removeWhere"),i=class{constructor(l,v,S){this.client=l,this.idleListener=v,this.timeoutId=S}};m(i,"IdleItem");var a=i,o=class{constructor(l){this.callback=l}};m(o,"PendingItem");var h=o;function p(){throw new Error("Release called on client which has already been released to the pool.")}m(p,"throwOnDoubleRelease");function f(g,l){if(l)return{callback:l,result:void 0};let v,S,x=m(function(O,L){O?v(O):S(L)},"cb"),T=new g(function(O,L){S=O,v=L}).catch(O=>{throw Error.captureStackTrace(O),O});return{callback:x,result:T}}m(f,"promisify");function y(g,l){return m(function v(S){S.client=l,l.removeListener("error",v),l.on("error",()=>{g.log("additional client error after disconnection due to error",S)}),g._remove(l),g.emit("error",S,l)},"idleListener")}m(y,"makeIdleListener");var b=class extends t{constructor(l,v){super(),this.options=Object.assign({},l),l!=null&&"password"in l&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:l.password}),l!=null&&l.ssl&&l.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||v||as().Client,this.Promise=this.options.Promise||Yr.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(v=>{this._remove(v.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let l=this._pendingQueue.shift();if(this._idle.length){let v=this._idle.pop();clearTimeout(v.timeoutId);let S=v.client;S.ref&&S.ref();let x=v.idleListener;return this._acquireClient(S,l,x,!1)}if(!this._isFull())return this.newClient(l);throw new Error("unexpected condition")}_remove(l){let v=s(this._idle,S=>S.client===l);v!==void 0&&clearTimeout(v.timeoutId),this._clients=this._clients.filter(S=>S!==l),l.end(),this.emit("remove",l)}connect(l){if(this.ending){let x=new Error("Cannot use a pool after calling end on the pool");return l?l(x):this.Promise.reject(x)}let v=f(this.Promise,l),S=v.result;if(this._isFull()||this._idle.length){if(this._idle.length&&ue.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new h(v.callback)),S;let x=m((L,_,I)=>{clearTimeout(O),v.callback(L,_,I)},"queueCallback"),T=new h(x),O=setTimeout(()=>{s(this._pendingQueue,L=>L.callback===x),T.timedOut=!0,v.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(T),S}return this.newClient(new h(v.callback)),S}newClient(l){let v=new this.Client(this.options);this._clients.push(v);let S=y(this,v);this.log("checking client timeout");let x,T=!1;this.options.connectionTimeoutMillis&&(x=setTimeout(()=>{this.log("ending client due to timeout"),T=!0,v.connection?v.connection.stream.destroy():v.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),v.connect(O=>{if(x&&clearTimeout(x),v.on("error",S),O)this.log("client failed to connect",O),this._clients=this._clients.filter(L=>L!==v),T&&(O.message="Connection terminated due to connection timeout"),this._pulseQueue(),l.timedOut||l.callback(O,void 0,n);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let L=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(v),this._idle.findIndex(_=>_.client===v)!==-1&&this._acquireClient(v,new h((_,I,P)=>P()),S,!1)},this.options.maxLifetimeSeconds*1e3);L.unref(),v.once("end",()=>clearTimeout(L))}return this._acquireClient(v,l,S,!0)}})}_acquireClient(l,v,S,x){x&&this.emit("connect",l),this.emit("acquire",l),l.release=this._releaseOnce(l,S),l.removeListener("error",S),v.timedOut?x&&this.options.verify?this.options.verify(l,l.release):l.release():x&&this.options.verify?this.options.verify(l,T=>{if(T)return l.release(T),v.callback(T,void 0,n);v.callback(void 0,l,l.release)}):v.callback(void 0,l,l.release)}_releaseOnce(l,v){let S=!1;return x=>{S&&p(),S=!0,this._release(l,v,x)}}_release(l,v,S){if(l.on("error",v),l._poolUseCount=(l._poolUseCount||0)+1,this.emit("release",S,l),S||this.ending||!l._queryable||l._ending||l._poolUseCount>=this.options.maxUses){l._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(l),this._pulseQueue();return}if(this._expired.has(l)){this.log("remove expired client"),this._expired.delete(l),this._remove(l),this._pulseQueue();return}let x;this.options.idleTimeoutMillis&&(x=setTimeout(()=>{this.log("remove idle client"),this._remove(l)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&x.unref()),this.options.allowExitOnIdle&&l.unref(),this._idle.push(new a(l,v,x)),this._pulseQueue()}query(l,v,S){if(typeof l=="function"){let T=f(this.Promise,l);return Xn(function(){return T.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),T.result}typeof v=="function"&&(S=v,v=void 0);let x=f(this.Promise,S);return S=x.callback,this.connect((T,O)=>{if(T)return S(T);let L=!1,_=m(I=>{L||(L=!0,O.release(I),S(I))},"onError");O.once("error",_),this.log("dispatching query");try{O.query(l,v,(I,P)=>{if(this.log("query dispatched"),O.removeListener("error",_),!L)return L=!0,O.release(I),I?S(I):S(void 0,P)})}catch(I){return O.release(I),S(I)}}),x.result}end(l){if(this.log("ending"),this.ending){let S=new Error("Called end on pool more than once");return l?l(S):this.Promise.reject(S)}this.ending=!0;let v=f(this.Promise,l);return this._endCallback=v.callback,this._pulseQueue(),v.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((l,v)=>l+(this._expired.has(v)?1:0),0)}get totalCount(){return this._clients.length}};m(b,"Pool");var w=b;e.exports=w}),qo={};Je(qo,{default:()=>Fo});var Fo,Nl=je(()=>{"use strict";X(),Fo={}}),Pl=le((r,e)=>{e.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),Il=le((r,e)=>{"use strict";X();var t=It().EventEmitter,n=(en(),ke(xr)),s=nn(),i=e.exports=function(o,h,p){t.call(this),o=s.normalizeQueryConfig(o,h,p),this.text=o.text,this.values=o.values,this.name=o.name,this.callback=o.callback,this.state="new",this._arrayMode=o.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(f){f==="row"&&(this._emitRowEvents=!0)}.bind(this))};n.inherits(i,t);var a={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};i.prototype.handleError=function(o){var h=this.native.pq.resultErrorFields();if(h)for(var p in h){var f=a[p]||p;o[f]=h[p]}this.callback?this.callback(o):this.emit("error",o),this.state="error"},i.prototype.then=function(o,h){return this._getPromise().then(o,h)},i.prototype.catch=function(o){return this._getPromise().catch(o)},i.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(o,h){this._once("end",o),this._once("error",h)}.bind(this)),this._promise)},i.prototype.submit=function(o){this.state="running";var h=this;this.native=o.native,o.native.arrayMode=this._arrayMode;var p=m(function(b,w,g){if(o.native.arrayMode=!1,Xn(function(){h.emit("_done")}),b)return h.handleError(b);h._emitRowEvents&&(g.length>1?w.forEach((l,v)=>{l.forEach(S=>{h.emit("row",S,g[v])})}):w.forEach(function(l){h.emit("row",l,g)})),h.state="end",h.emit("end",g),h.callback&&h.callback(null,g)},"after");if(ue.domain&&(p=ue.domain.bind(p)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var f=(this.values||[]).map(s.prepareValue);if(o.namedQueries[this.name]){if(this.text&&o.namedQueries[this.name]!==this.text){let b=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return p(b)}return o.native.execute(this.name,f,p)}return o.native.prepare(this.name,this.text,f.length,function(b){return b?p(b):(o.namedQueries[h.name]=h.text,h.native.execute(h.name,f,p))})}else if(this.values){if(!Array.isArray(this.values)){let b=new Error("Query values must be an array");return p(b)}var y=this.values.map(s.prepareValue);o.native.query(this.text,y,p)}else o.native.query(this.text,p)}}),kl=le((r,e)=>{"use strict";X();var t=(Nl(),ke(qo)),n=ns(),s=Pl(),i=It().EventEmitter,a=(en(),ke(xr)),o=is(),h=Il(),p=e.exports=function(f){i.call(this),f=f||{},this._Promise=f.Promise||Yr.Promise,this._types=new n(f.types),this.native=new t({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var y=this.connectionParameters=new o(f);this.user=y.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:y.password}),this.database=y.database,this.host=y.host,this.port=y.port,this.namedQueries={}};p.Query=h,a.inherits(p,i),p.prototype._errorAllQueries=function(f){let y=m(b=>{ue.nextTick(()=>{b.native=this.native,b.handleError(f)})},"enqueueError");this._hasActiveQuery()&&(y(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(y),this._queryQueue.length=0},p.prototype._connect=function(f){var y=this;if(this._connecting){ue.nextTick(()=>f(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(b,w){if(b)return f(b);y.native.connect(w,function(g){if(g)return y.native.end(),f(g);y._connected=!0,y.native.on("error",function(l){y._queryable=!1,y._errorAllQueries(l),y.emit("error",l)}),y.native.on("notification",function(l){y.emit("notification",{channel:l.relname,payload:l.extra})}),y.emit("connect"),y._pulseQueryQueue(!0),f()})})},p.prototype.connect=function(f){if(f){this._connect(f);return}return new this._Promise((y,b)=>{this._connect(w=>{w?b(w):y()})})},p.prototype.query=function(f,y,b){var w,g,l,v,S;if(f==null)throw new TypeError("Client was passed a null or undefined query");if(typeof f.submit=="function")l=f.query_timeout||this.connectionParameters.query_timeout,g=w=f,typeof y=="function"&&(f.callback=y);else if(l=this.connectionParameters.query_timeout,w=new h(f,y,b),!w.callback){let x,T;g=new this._Promise((O,L)=>{x=O,T=L}),w.callback=(O,L)=>O?T(O):x(L)}return l&&(S=w.callback,v=setTimeout(()=>{var x=new Error("Query read timeout");ue.nextTick(()=>{w.handleError(x,this.connection)}),S(x),w.callback=()=>{};var T=this._queryQueue.indexOf(w);T>-1&&this._queryQueue.splice(T,1),this._pulseQueryQueue()},l),w.callback=(x,T)=>{clearTimeout(v),S(x,T)}),this._queryable?this._ending?(w.native=this.native,ue.nextTick(()=>{w.handleError(new Error("Client was closed and is not queryable"))}),g):(this._queryQueue.push(w),this._pulseQueryQueue(),g):(w.native=this.native,ue.nextTick(()=>{w.handleError(new Error("Client has encountered a connection error and is not queryable"))}),g)},p.prototype.end=function(f){var y=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,f));var b;return f||(b=new this._Promise(function(w,g){f=m(l=>l?g(l):w(),"cb")})),this.native.end(function(){y._errorAllQueries(new Error("Connection terminated")),ue.nextTick(()=>{y.emit("end"),f&&f()})}),b},p.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"},p.prototype._pulseQueryQueue=function(f){if(this._connected&&!this._hasActiveQuery()){var y=this._queryQueue.shift();if(!y){f||this.emit("drain");return}this._activeQuery=y,y.submit(this);var b=this;y.once("_done",function(){b._pulseQueryQueue()})}},p.prototype.cancel=function(f){this._activeQuery===f?this.native.cancel(function(){}):this._queryQueue.indexOf(f)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(f),1)},p.prototype.ref=function(){},p.prototype.unref=function(){},p.prototype.setTypeParser=function(f,y,b){return this._types.setTypeParser(f,y,b)},p.prototype.getTypeParser=function(f,y){return this._types.getTypeParser(f,y)}}),co=le((r,e)=>{"use strict";X(),e.exports=kl()}),as=le((r,e)=>{"use strict";X();var t=El(),n=rn(),s=Qo(),i=Al(),{DatabaseError:a}=$o(),o=m(p=>{var f;return f=class extends i{constructor(y){super(y,p)}},m(f,"BoundPool"),f},"poolFactory"),h=m(function(p){this.defaults=n,this.Client=p,this.Query=this.Client.Query,this.Pool=o(this.Client),this._pools=[],this.Connection=s,this.types=tn(),this.DatabaseError=a},"PG");typeof ue.env.NODE_PG_FORCE_NATIVE<"u"?e.exports=new h(co()):(e.exports=new h(t),Object.defineProperty(e.exports,"native",{configurable:!0,enumerable:!1,get(){var p=null;try{p=new h(co())}catch(f){if(f.code!=="MODULE_NOT_FOUND")throw f}return Object.defineProperty(e.exports,"native",{value:p}),p}}))});X();var Uo=tr(as());os();X();os();Lo();var Ol=tr(nn()),Ll=tr(ns());function zo(r){return r instanceof ne?"\\x"+r.toString("hex"):r}m(zo,"encodeBuffersAsBytea");var Vo=class Ko extends Error{constructor(e){super(e),se(this,"name","NeonDbError"),se(this,"severity"),se(this,"code"),se(this,"detail"),se(this,"hint"),se(this,"position"),se(this,"internalPosition"),se(this,"internalQuery"),se(this,"where"),se(this,"schema"),se(this,"table"),se(this,"column"),se(this,"dataType"),se(this,"constraint"),se(this,"file"),se(this,"line"),se(this,"routine"),se(this,"sourceError"),"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Ko)}};m(Vo,"NeonDbError");var Yt=Vo,ho="transaction() expects an array of queries, or a function returning an array of queries",Ml=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];function Zo(r,{arrayMode:e,fullResults:t,fetchOptions:n,isolationLevel:s,readOnly:i,deferrable:a,queryCallback:o,resultCallback:h,authToken:p}={}){if(!r)throw new Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");let f;try{f=ss(r)}catch{throw new Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(r))}let{protocol:y,username:b,hostname:w,port:g,pathname:l}=f;if(y!=="postgres:"&&y!=="postgresql:"||!b||!w||!l)throw new Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function v(x,...T){let O,L;if(typeof x=="string")O=x,L=T[1],T=T[0]??[];else{O="";for(let I=0;I<x.length;I++)O+=x[I],I<T.length&&(O+="$"+(I+1))}T=T.map(I=>zo((0,Ol.prepareValue)(I)));let _={query:O,params:T};return o&&o(_),Wo(S,_,L)}m(v,"resolve"),v.transaction=async(x,T)=>{if(typeof x=="function"&&(x=x(v)),!Array.isArray(x))throw new Error(ho);x.forEach(_=>{if(_[Symbol.toStringTag]!=="NeonQueryPromise")throw new Error(ho)});let O=x.map(_=>_.parameterizedQuery),L=x.map(_=>_.opts??{});return S(O,L,T)};async function S(x,T,O){let{fetchEndpoint:L,fetchFunction:_}=wt,I=Array.isArray(x)?{queries:x}:x,P=n??{},E=e??!1,$=t??!1,R=s,Z=i,W=a;O!==void 0&&(O.fetchOptions!==void 0&&(P={...P,...O.fetchOptions}),O.arrayMode!==void 0&&(E=O.arrayMode),O.fullResults!==void 0&&($=O.fullResults),O.isolationLevel!==void 0&&(R=O.isolationLevel),O.readOnly!==void 0&&(Z=O.readOnly),O.deferrable!==void 0&&(W=O.deferrable)),T!==void 0&&!Array.isArray(T)&&T.fetchOptions!==void 0&&(P={...P,...T.fetchOptions});let M=p;!Array.isArray(T)&&T?.authToken!==void 0&&(M=T.authToken);let F=typeof L=="function"?L(w,g,{jwtAuth:M!==void 0}):L,J={"Neon-Connection-String":r,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"},ie=await Go(M);ie&&(J.Authorization=`Bearer ${ie}`),Array.isArray(x)&&(R!==void 0&&(J["Neon-Batch-Isolation-Level"]=R),Z!==void 0&&(J["Neon-Batch-Read-Only"]=String(Z)),W!==void 0&&(J["Neon-Batch-Deferrable"]=String(W)));let fe;try{fe=await(_??fetch)(F,{method:"POST",body:JSON.stringify(I),headers:J,...P})}catch(pe){let Pe=new Yt(`Error connecting to database: ${pe.message}`);throw Pe.sourceError=pe,Pe}if(fe.ok){let pe=await fe.json();if(Array.isArray(x)){let Pe=pe.results;if(!Array.isArray(Pe))throw new Yt("Neon internal error: unexpected result format");return Pe.map((ye,Se)=>{let Nt=T[Se]??{},br=Nt.arrayMode??E,vr=Nt.fullResults??$;return Jn(ye,{arrayMode:br,fullResults:vr,parameterizedQuery:x[Se],resultCallback:h,types:Nt.types})})}else{let Pe=T??{},ye=Pe.arrayMode??E,Se=Pe.fullResults??$;return Jn(pe,{arrayMode:ye,fullResults:Se,parameterizedQuery:x,resultCallback:h,types:Pe.types})}}else{let{status:pe}=fe;if(pe===400){let Pe=await fe.json(),ye=new Yt(Pe.message);for(let Se of Ml)ye[Se]=Pe[Se]??void 0;throw ye}else{let Pe=await fe.text();throw new Yt(`Server error (HTTP status ${pe}): ${Pe}`)}}}return m(S,"execute"),v}m(Zo,"neon");function Wo(r,e,t){return{[Symbol.toStringTag]:"NeonQueryPromise",parameterizedQuery:e,opts:t,then:m((n,s)=>r(e,t).then(n,s),"then"),catch:m(n=>r(e,t).catch(n),"catch"),finally:m(n=>r(e,t).finally(n),"finally")}}m(Wo,"createNeonQueryPromise");function Jn(r,{arrayMode:e,fullResults:t,parameterizedQuery:n,resultCallback:s,types:i}){let a=new Ll.default(i),o=r.fields.map(f=>f.name),h=r.fields.map(f=>a.getTypeParser(f.dataTypeID)),p=e===!0?r.rows.map(f=>f.map((y,b)=>y===null?null:h[b](y))):r.rows.map(f=>Object.fromEntries(f.map((y,b)=>[o[b],y===null?null:h[b](y)])));return s&&s(n,r,p,{arrayMode:e,fullResults:t}),t?(r.viaNeonFetch=!0,r.rowAsArray=e,r.rows=p,r._parsers=h,r._types=a,r):p}m(Jn,"processQueryResult");async function Go(r){if(typeof r=="string")return r;if(typeof r=="function")try{return await Promise.resolve(r())}catch(e){let t=new Yt("Error getting auth token.");throw e instanceof Error&&(t=new Yt(`Error getting auth token: ${e.message}`)),t}}m(Go,"getAuthToken");var Rl=tr(is()),rr=tr(as()),Ho=class extends Uo.Client{constructor(e){super(e),this.config=e}get neonConfig(){return this.connection.stream}connect(e){let{neonConfig:t}=this;t.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&t.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let n=this.config?.host!==void 0||this.config?.connectionString!==void 0||ue.env.PGHOST!==void 0,s=ue.env.USER??ue.env.USERNAME;if(!n&&this.host==="localhost"&&this.user===s&&this.database===s&&this.password===null)throw new Error(`No database host or connection string was set, and key parameters have default values (host: localhost, user: ${s}, db: ${s}, password: null). Is an environment variable missing? Alternatively, if you intended to connect with these parameters, please set the host to 'localhost' explicitly.`);let i=super.connect(e),a=t.pipelineTLS&&this.ssl,o=t.pipelineConnect==="password";if(!a&&!t.pipelineConnect)return i;let h=this.connection;if(a&&h.on("connect",()=>h.stream.emit("data","S")),o){h.removeAllListeners("authenticationCleartextPassword"),h.removeAllListeners("readyForQuery"),h.once("readyForQuery",()=>h.on("readyForQuery",this._handleReadyForQuery.bind(this)));let p=this.ssl?"sslconnect":"connect";h.on(p,()=>{this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return i}async _handleAuthSASLContinue(e){let t=this.saslSession,n=this.password,s=e.data;if(t.message!=="SASLInitialResponse"||typeof n!="string"||typeof s!="string")throw new Error("SASL: protocol error");let i=Object.fromEntries(s.split(",").map(ie=>{if(!/^.=/.test(ie))throw new Error("SASL: Invalid attribute pair entry");let fe=ie[0],pe=ie.substring(2);return[fe,pe]})),a=i.r,o=i.s,h=i.i;if(!a||!/^[!-+--~]+$/.test(a))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!o||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(o))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!h||!/^[1-9][0-9]*$/.test(h))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!a.startsWith(t.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(a.length===t.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let p=parseInt(h,10),f=ne.from(o,"base64"),y=new TextEncoder,b=y.encode(n),w=await Le.subtle.importKey("raw",b,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),g=new Uint8Array(await Le.subtle.sign("HMAC",w,ne.concat([f,ne.from([0,0,0,1])]))),l=g;for(var v=0;v<p-1;v++)g=new Uint8Array(await Le.subtle.sign("HMAC",w,g)),l=ne.from(l.map((ie,fe)=>l[fe]^g[fe]));let S=l,x=await Le.subtle.importKey("raw",S,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),T=new Uint8Array(await Le.subtle.sign("HMAC",x,y.encode("Client Key"))),O=await Le.subtle.digest("SHA-256",T),L="n=*,r="+t.clientNonce,_="r="+a+",s="+o+",i="+p,I="c=biws,r="+a,P=L+","+_+","+I,E=await Le.subtle.importKey("raw",O,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var $=new Uint8Array(await Le.subtle.sign("HMAC",E,y.encode(P))),R=ne.from(T.map((ie,fe)=>T[fe]^$[fe])),Z=R.toString("base64");let W=await Le.subtle.importKey("raw",S,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),M=await Le.subtle.sign("HMAC",W,y.encode("Server Key")),F=await Le.subtle.importKey("raw",M,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var J=ne.from(await Le.subtle.sign("HMAC",F,y.encode(P)));t.message="SASLResponse",t.serverSignature=J.toString("base64"),t.response=I+",p="+Z,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};m(Ho,"NeonClient");var Bl=Ho;function Jo(r,e){if(e)return{callback:e,result:void 0};let t,n,s=m(function(a,o){a?t(a):n(o)},"cb"),i=new r(function(a,o){n=a,t=o});return{callback:s,result:i}}m(Jo,"promisify");var Xo=class extends Uo.Pool{constructor(){super(...arguments),se(this,"Client",Bl),se(this,"hasFetchUnsupportedListeners",!1)}on(e,t){return e!=="error"&&(this.hasFetchUnsupportedListeners=!0),super.on(e,t)}query(e,t,n){if(!wt.poolQueryViaFetch||this.hasFetchUnsupportedListeners||typeof e=="function")return super.query(e,t,n);typeof t=="function"&&(n=t,t=void 0);let s=Jo(this.Promise,n);n=s.callback;try{let i=new Rl.default(this.options),a=encodeURIComponent,o=encodeURI,h=`postgresql://${a(i.user)}:${a(i.password)}@${a(i.host)}/${o(i.database)}`,p=typeof e=="string"?e:e.text,f=t??e.values??[];Zo(h,{fullResults:!0,arrayMode:e.rowMode==="array"})(p,f,{types:e.types??this.options?.types}).then(y=>n(void 0,y)).catch(y=>n(y))}catch(i){n(i)}return s.result}};m(Xo,"NeonPool");var lt=Xo,Hh=rr.ClientBase,Jh=rr.Connection,Xh=rr.DatabaseError,Yh=rr.Query,ef=rr.defaults,Xe=rr.types;var C=Symbol.for("drizzle:entityKind"),sf=Symbol.for("drizzle:hasOwnEntityKind");function B(r,e){if(!r||typeof r!="object")return!1;if(r instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,C))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=Object.getPrototypeOf(r).constructor;if(t)for(;t;){if(C in t&&t[C]===e[C])return!0;t=Object.getPrototypeOf(t)}return!1}var us=class{static[C]="ConsoleLogWriter";write(e){console.log(e)}},sn=class{static[C]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new us}logQuery(e,t){let n=t.map(i=>{try{return JSON.stringify(i)}catch{return String(i)}}),s=n.length?` -- params: [${n.join(", ")}]`:"";this.writer.write(`Query: ${e}${s}`)}},on=class{static[C]="NoopLogger";logQuery(){}};var Me=class{static[C]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}};var de=class{constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static[C]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}};var an=class{static[C]="ColumnBuilder";config;constructor(e,t,n){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}};var Ye=Symbol.for("drizzle:Name");var un=class{static[C]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:n,columns:s,foreignColumns:i}=e();return{name:n,columns:s,foreignTable:i[0].table,foreignColumns:i}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new ls(e,this)}},ls=class{constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[C]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:n}=this.reference(),s=t.map(o=>o.name),i=n.map(o=>o.name),a=[this.table[Ye],...s,n[0].table[Ye],...i];return e??`${a.join("_")}_fk`}};function ln(r,...e){return r(...e)}function fs(r,e){return`${r[Ye]}_${e.join("_")}_unique`}var cs=class{constructor(e,t){this.name=t,this.columns=e}static[C]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new hs(e,this.columns,this.nullsNotDistinctConfig,this.name)}},Yo=class{static[C]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new cs(e,this.name)}},hs=class{constructor(e,t,n,s){this.table=e,this.columns=t,this.name=s??fs(this.table,this.columns.map(i=>i.name)),this.nullsNotDistinct=n}static[C]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}};function ea(r,e,t){for(let n=e;n<r.length;n++){let s=r[n];if(s==="\\"){n++;continue}if(s==='"')return[r.slice(e,n).replace(/\\/g,""),n+1];if(!t&&(s===","||s==="}"))return[r.slice(e,n).replace(/\\/g,""),n]}return[r.slice(e).replace(/\\/g,""),r.length]}function ta(r,e=0){let t=[],n=e,s=!1;for(;n<r.length;){let i=r[n];if(i===","){(s||n===e)&&t.push(""),s=!0,n++;continue}if(s=!1,i==="\\"){n+=2;continue}if(i==='"'){let[h,p]=ea(r,n+1,!0);t.push(h),n=p;continue}if(i==="}")return[t,n+1];if(i==="{"){let[h,p]=ta(r,n+1);t.push(h),n=p;continue}let[a,o]=ea(r,n,!1);t.push(a),n=o}return[t,n]}function ra(r){let[e]=ta(r,1);return e}function ds(r){return`{${r.map(e=>Array.isArray(e)?ds(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var G=class extends an{foreignKeyConfigs=[];static[C]="PgColumnBuilder";array(e){return new ms(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:n,actions:s})=>ln((i,a)=>{let o=new un(()=>{let h=i();return{columns:[e],foreignColumns:[h]}});return a.onUpdate&&o.onUpdate(a.onUpdate),a.onDelete&&o.onDelete(a.onDelete),o.build(t)},n,s))}buildExtraConfigColumn(e){return new ps(e,this.config)}},q=class extends de{constructor(e,t){t.uniqueName||(t.uniqueName=fs(e,[t.name])),super(e,t),this.table=e}static[C]="PgColumn"},ps=class extends q{static[C]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},nr=class{static[C]="IndexedColumn";constructor(e,t,n,s){this.name=e,this.keyAsName=t,this.type=n,this.indexConfig=s}name;keyAsName;type;indexConfig},ms=class extends G{static[C]="PgArrayBuilder";constructor(e,t,n){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=n}build(e){let t=this.config.baseBuilder.build(e);return new gs(e,this.config,t)}},gs=class r extends q{constructor(e,t,n,s){super(e,t),this.baseColumn=n,this.range=s,this.size=t.size}size;static[C]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=ra(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){let n=e.map(s=>s===null?null:B(this.baseColumn,r)?this.baseColumn.mapToDriverValue(s,!0):this.baseColumn.mapToDriverValue(s));return t?n:ds(n)}};var na=Symbol.for("drizzle:isPgEnum");function ia(r){return!!r&&typeof r=="function"&&na in r&&r[na]===!0}var sa=class extends G{static[C]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new ys(e,this.config)}},ys=class extends q{static[C]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}};var Ee=class{static[C]="Subquery";constructor(e,t,n,s=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:n,isWith:s}}},sr=class extends Ee{static[C]="WithSubquery"};var oa="0.39.1";var bs,vs,Ae={startActiveSpan(r,e){return bs?(vs||(vs=bs.trace.getTracer("drizzle-orm",oa)),ln((t,n)=>n.startActiveSpan(r,s=>{try{return e(s)}catch(i){throw s.setStatus({code:t.SpanStatusCode.ERROR,message:i instanceof Error?i.message:"Unknown error"}),i}finally{s.end()}}),bs,vs)):e()}};var ge=Symbol.for("drizzle:ViewBaseConfig");var cn=Symbol.for("drizzle:Schema"),hn=Symbol.for("drizzle:Columns"),aa=Symbol.for("drizzle:ExtraConfigColumns"),ws=Symbol.for("drizzle:OriginalName"),Ss=Symbol.for("drizzle:BaseName"),Cr=Symbol.for("drizzle:IsAlias"),ua=Symbol.for("drizzle:ExtraConfigBuilder"),la=Symbol.for("drizzle:IsDrizzleTable"),z=class{static[C]="Table";static Symbol={Name:Ye,Schema:cn,OriginalName:ws,Columns:hn,ExtraConfigColumns:aa,BaseName:Ss,IsAlias:Cr,ExtraConfigBuilder:ua};[Ye];[ws];[cn];[hn];[aa];[Ss];[Cr]=!1;[la]=!0;[ua]=void 0;constructor(e,t,n){this[Ye]=this[ws]=e,this[cn]=t,this[Ss]=n}};function _s(r){return typeof r=="object"&&r!==null&&la in r}function Qe(r){return r[Ye]}function kt(r){return`${r[cn]??"public"}.${r[Ye]}`}var ca=class{static[C]="FakePrimitiveParam"};function xs(r){return r!=null&&typeof r.getSQL=="function"}function $l(r){let e={sql:"",params:[]};for(let t of r)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}var Ne=class{static[C]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new V([this])}},V=class r{constructor(e){this.queryChunks=e}static[C]="SQL";decoder=fa;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return Ae.startActiveSpan("drizzle.buildSQL",t=>{let n=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,t){let n=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:s,escapeName:i,escapeParam:a,prepareTyping:o,inlineParams:h,paramStartIndex:p}=n;return $l(e.map(f=>{if(B(f,Ne))return{sql:f.value.join(""),params:[]};if(B(f,Tr))return{sql:i(f.value),params:[]};if(f===void 0)return{sql:"",params:[]};if(Array.isArray(f)){let y=[new Ne("(")];for(let[b,w]of f.entries())y.push(w),b<f.length-1&&y.push(new Ne(", "));return y.push(new Ne(")")),this.buildQueryFromSourceParams(y,n)}if(B(f,r))return this.buildQueryFromSourceParams(f.queryChunks,{...n,inlineParams:h||f.shouldInlineParams});if(B(f,z)){let y=f[z.Symbol.Schema],b=f[z.Symbol.Name];return{sql:y===void 0||f[Cr]?i(b):i(y)+"."+i(b),params:[]}}if(B(f,de)){let y=s.getColumnCasing(f);if(t.invokeSource==="indexes")return{sql:i(y),params:[]};let b=f.table[z.Symbol.Schema];return{sql:f.table[Cr]||b===void 0?i(f.table[z.Symbol.Name])+"."+i(y):i(b)+"."+i(f.table[z.Symbol.Name])+"."+i(y),params:[]}}if(B(f,$e)){let y=f[ge].schema,b=f[ge].name;return{sql:y===void 0||f[ge].isAlias?i(b):i(y)+"."+i(b),params:[]}}if(B(f,qe)){if(B(f.value,ct))return{sql:a(p.value++,f),params:[f],typings:["none"]};let y=f.value===null?null:f.encoder.mapToDriverValue(f.value);if(B(y,r))return this.buildQueryFromSourceParams([y],n);if(h)return{sql:this.mapInlineParam(y,n),params:[]};let b=["none"];return o&&(b=[o(f.encoder)]),{sql:a(p.value++,y),params:[y],typings:b}}return B(f,ct)?{sql:a(p.value++,f),params:[f],typings:["none"]}:B(f,r.Aliased)&&f.fieldAlias!==void 0?{sql:i(f.fieldAlias),params:[]}:B(f,Ee)?f._.isWith?{sql:i(f._.alias),params:[]}:this.buildQueryFromSourceParams([new Ne("("),f._.sql,new Ne(") "),new Tr(f._.alias)],n):ia(f)?f.schema?{sql:i(f.schema)+"."+i(f.enumName),params:[]}:{sql:i(f.enumName),params:[]}:xs(f)?f.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([f.getSQL()],n):this.buildQueryFromSourceParams([new Ne("("),f.getSQL(),new Ne(")")],n):h?{sql:this.mapInlineParam(f,n),params:[]}:{sql:a(p.value++,f),params:[f],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let n=e.toString();return t(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new r.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Tr=class{constructor(e){this.value=e}static[C]="Name";brand;getSQL(){return new V([this])}};function ha(r){return typeof r=="object"&&r!==null&&"mapToDriverValue"in r&&typeof r.mapToDriverValue=="function"}var fa={mapFromDriverValue:r=>r},da={mapToDriverValue:r=>r},Xf={...fa,...da},qe=class{constructor(e,t=da){this.value=e,this.encoder=t}static[C]="Param";brand;getSQL(){return new V([this])}};function N(r,...e){let t=[];(e.length>0||r.length>0&&r[0]!=="")&&t.push(new Ne(r[0]));for(let[n,s]of e.entries())t.push(s,new Ne(r[n+1]));return new V(t)}(r=>{function e(){return new V([])}r.empty=e;function t(h){return new V(h)}r.fromList=t;function n(h){return new V([new Ne(h)])}r.raw=n;function s(h,p){let f=[];for(let[y,b]of h.entries())y>0&&p!==void 0&&f.push(p),f.push(b);return new V(f)}r.join=s;function i(h){return new Tr(h)}r.identifier=i;function a(h){return new ct(h)}r.placeholder=a;function o(h,p){return new qe(h,p)}r.param=o})(N||(N={}));(r=>{class e{constructor(n,s){this.sql=n,this.fieldAlias=s}static[C]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}r.Aliased=e})(V||(V={}));var ct=class{constructor(e){this.name=e}static[C]="Placeholder";getSQL(){return new V([this])}};function fn(r,e){return r.map(t=>{if(B(t,ct)){if(!(t.name in e))throw new Error(`No value for placeholder "${t.name}" was provided`);return e[t.name]}if(B(t,qe)&&B(t.value,ct)){if(!(t.value.name in e))throw new Error(`No value for placeholder "${t.value.name}" was provided`);return t.encoder.mapToDriverValue(e[t.value.name])}return t})}var pa=Symbol.for("drizzle:IsDrizzleView"),$e=class{static[C]="View";[ge];[pa]=!0;constructor({name:e,schema:t,selectedFields:n,query:s}){this[ge]={name:e,originalName:e,schema:t,selectedFields:n,query:s,isExisting:!s,isAlias:!1}}getSQL(){return new V([this])}};function ma(r){return typeof r=="object"&&r!==null&&pa in r}de.prototype.getSQL=function(){return new V([this])};z.prototype.getSQL=function(){return new V([this])};Ee.prototype.getSQL=function(){return new V([this])};var Ot=class{constructor(e){this.table=e}static[C]="ColumnAliasProxyHandler";get(e,t){return t==="table"?this.table:e[t]}},ir=class{constructor(e,t){this.alias=e,this.replaceOriginalName=t}static[C]="TableAliasProxyHandler";get(e,t){if(t===z.Symbol.IsAlias)return!0;if(t===z.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===z.Symbol.OriginalName)return this.alias;if(t===ge)return{...e[ge],name:this.alias,isAlias:!0};if(t===z.Symbol.Columns){let s=e[z.Symbol.Columns];if(!s)return s;let i={};return Object.keys(s).map(a=>{i[a]=new Proxy(s[a],new Ot(new Proxy(e,this)))}),i}let n=e[t];return B(n,de)?new Proxy(n,new Ot(new Proxy(e,this))):n}},ga=class{constructor(e){this.alias=e}static[C]="RelationTableAliasProxyHandler";get(e,t){return t==="sourceTable"?Er(e.sourceTable,this.alias):e[t]}};function Er(r,e){return new Proxy(r,new ir(e,!1))}function rt(r,e){return new Proxy(r,new Ot(new Proxy(r.table,new ir(e,!1))))}function Cs(r,e){return new V.Aliased(Ar(r.sql,e),r.fieldAlias)}function Ar(r,e){return N.join(r.queryChunks.map(t=>B(t,de)?rt(t,e):B(t,V)?Ar(t,e):B(t,V.Aliased)?Cs(t,e):t))}var xe=class r{static[C]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===ge)return{...e[ge],selectedFields:new Proxy(e[ge].selectedFields,this)};if(typeof t=="symbol")return e[t];let s=(B(e,Ee)?e._.selectedFields:B(e,$e)?e[ge].selectedFields:e)[t];if(B(s,V.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!s.isSelectionField)return s.sql;let i=s.clone();return i.isSelectionField=!0,i}if(B(s,V)){if(this.config.sqlBehavior==="sql")return s;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return B(s,de)?this.config.alias?new Proxy(s,new Ot(new Proxy(s.table,new ir(this.config.alias,this.config.replaceOriginalName??!1)))):s:typeof s!="object"||s===null?s:new Proxy(s,new r(this.config))}};function ya(r,e,t){let n={},s=r.reduce((i,{path:a,field:o},h)=>{let p;B(o,de)?p=o:B(o,V)?p=o.decoder:p=o.sql.decoder;let f=i;for(let[y,b]of a.entries())if(y<a.length-1)b in f||(f[b]={}),f=f[b];else{let w=e[h],g=f[b]=w===null?null:p.mapFromDriverValue(w);if(t&&B(o,de)&&a.length===2){let l=a[0];l in n?typeof n[l]=="string"&&n[l]!==Qe(o.table)&&(n[l]=!1):n[l]=g===null?Qe(o.table):!1}}return i},{});if(t&&Object.keys(n).length>0)for(let[i,a]of Object.entries(n))typeof a=="string"&&!t[a]&&(s[i]=null);return s}function Ze(r,e){return Object.entries(r).reduce((t,[n,s])=>{if(typeof n!="string")return t;let i=e?[...e,n]:[n];return B(s,de)||B(s,V)||B(s,V.Aliased)?t.push({path:i,field:s}):B(s,z)?t.push(...Ze(s[z.Symbol.Columns],i)):t.push(...Ze(s,i)),t},[])}function Nr(r,e){let t=Object.keys(r),n=Object.keys(e);if(t.length!==n.length)return!1;for(let[s,i]of t.entries())if(i!==n[s])return!1;return!0}function dn(r,e){let t=Object.entries(e).filter(([,n])=>n!==void 0).map(([n,s])=>B(s,V)||B(s,de)?[n,s]:[n,new qe(s,r[z.Symbol.Columns][n])]);if(t.length===0)throw new Error("No values to set");return Object.fromEntries(t)}function ba(r,e){for(let t of e)for(let n of Object.getOwnPropertyNames(t.prototype))n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))}function pn(r){return r[z.Symbol.Columns]}function va(r){return r[ge].selectedFields}function ht(r){return B(r,Ee)?r._.alias:B(r,$e)?r[ge].name:B(r,V)?void 0:r[z.Symbol.IsAlias]?r[z.Symbol.Name]:r[z.Symbol.BaseName]}function ce(r,e){return{name:typeof r=="string"&&r.length>0?r:"",config:typeof r=="object"?r:e}}function wa(r){if(typeof r!="object"||r===null||r.constructor.name!=="Object")return!1;if("logger"in r){let e=typeof r.logger;return!(e!=="boolean"&&(e!=="object"||typeof r.logger.logQuery!="function")&&e!=="undefined")}if("schema"in r){let e=typeof r.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in r){let e=typeof r.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in r)return!(r.mode!=="default"||r.mode!=="planetscale"||r.mode!==void 0);if("connection"in r){let e=typeof r.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in r){let e=typeof r.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(r).length===0}var Pr=class extends Me{constructor(e,t,n,s){super(),this.session=t,this.dialect=n,this.config={table:e,withList:s}}static[C]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[z.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Ze(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return Ae.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>Ae.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new xe({alias:Qe(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};function Dl(r){return(r.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(t=>t.toLowerCase()).join("_")}function jl(r){return(r.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((t,n,s)=>{let i=s===0?n.toLowerCase():`${n[0].toUpperCase()}${n.slice(1)}`;return t+i},"")}function Ql(r){return r}var mn=class{static[C]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?Dl:e==="camelCase"?jl:Ql}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[z.Symbol.Schema]??"public",n=e.table[z.Symbol.OriginalName],s=`${t}.${n}.${e.name}`;return this.cache[s]||this.cacheTable(e.table),this.cache[s]}cacheTable(e){let t=e[z.Symbol.Schema]??"public",n=e[z.Symbol.OriginalName],s=`${t}.${n}`;if(!this.cachedTables[s]){for(let i of Object.values(e[z.Symbol.Columns])){let a=`${s}.${i.name}`;this.cache[a]=this.convert(i.name)}this.cachedTables[s]=!0}}clearCache(){this.cache={},this.cachedTables={}}};var Ir=class extends Error{static[C]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}},gn=class extends Ir{static[C]="TransactionRollbackError";constructor(){super({message:"Rollback"})}};var ft=class extends G{static[C]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}};var Ts=class extends ft{static[C]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new Es(e,this.config)}},Es=class extends q{static[C]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},As=class extends ft{static[C]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Ns(e,this.config)}},Ns=class extends q{static[C]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}};function Sa(r,e){let{name:t,config:n}=ce(r,e);return n.mode==="number"?new Ts(t):new As(t)}var Ps=class extends G{static[C]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Is(e,this.config)}},Is=class extends q{static[C]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},ks=class extends G{static[C]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Os(e,this.config)}},Os=class extends q{static[C]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}};function _a(r,e){let{name:t,config:n}=ce(r,e);return n.mode==="number"?new Ps(t):new ks(t)}var Ls=class extends G{static[C]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new Ms(e,this.config)}},Ms=class extends q{static[C]="PgBoolean";getSQLType(){return"boolean"}};function St(r){return new Ls(r??"")}var Rs=class extends G{static[C]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Bs(e,this.config)}},Bs=class extends q{static[C]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}};function xa(r,e={}){let{name:t,config:n}=ce(r,e);return new Rs(t,n)}var $s=class extends G{static[C]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new Ds(e,this.config)}},Ds=class extends q{static[C]="PgCidr";getSQLType(){return"cidr"}};function Ca(r){return new $s(r??"")}var js=class extends G{static[C]="PgCustomColumnBuilder";constructor(e,t,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=n}build(e){return new Qs(e,this.config)}},Qs=class extends q{static[C]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}};function Ta(r){return(e,t)=>{let{name:n,config:s}=ce(e,t);return new js(n,s,r)}}var nt=class extends G{static[C]="PgDateColumnBaseBuilder";defaultNow(){return this.default(N`now()`)}};var qs=class extends nt{static[C]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new kr(e,this.config)}},kr=class extends q{static[C]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},Fs=class extends nt{static[C]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new Or(e,this.config)}},Or=class extends q{static[C]="PgDateString";getSQLType(){return"date"}};function Ea(r,e){let{name:t,config:n}=ce(r,e);return n?.mode==="date"?new qs(t):new Fs(t)}var Us=class extends G{static[C]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new zs(e,this.config)}},zs=class extends q{static[C]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}};function Aa(r){return new Us(r??"")}var Vs=class extends G{static[C]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new Ks(e,this.config)}},Ks=class extends q{static[C]="PgInet";getSQLType(){return"inet"}};function Na(r){return new Vs(r??"")}var Zs=class extends ft{static[C]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new Ws(e,this.config)}},Ws=class extends q{static[C]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}};function st(r){return new Zs(r??"")}var Gs=class extends G{static[C]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new Hs(e,this.config)}},Hs=class extends q{static[C]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}};function Pa(r,e={}){let{name:t,config:n}=ce(r,e);return new Gs(t,n)}var Js=class extends G{static[C]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new Lr(e,this.config)}},Lr=class extends q{static[C]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};function Ia(r){return new Js(r??"")}var Xs=class extends G{static[C]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new Mr(e,this.config)}},Mr=class extends q{static[C]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};function yn(r){return new Xs(r??"")}var Ys=class extends G{static[C]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new ei(e,this.config)}},ei=class extends q{static[C]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,n,s]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(n),Number.parseFloat(s)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},ti=class extends G{static[C]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new ri(e,this.config)}},ri=class extends q{static[C]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,n,s]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(n),c:Number.parseFloat(s)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}};function ka(r,e){let{name:t,config:n}=ce(r,e);return!n?.mode||n.mode==="tuple"?new Ys(t):new ti(t)}var ni=class extends G{static[C]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new si(e,this.config)}},si=class extends q{static[C]="PgMacaddr";getSQLType(){return"macaddr"}};function Oa(r){return new ni(r??"")}var ii=class extends G{static[C]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new oi(e,this.config)}},oi=class extends q{static[C]="PgMacaddr8";getSQLType(){return"macaddr8"}};function La(r){return new ii(r??"")}var ai=class extends G{static[C]="PgNumericBuilder";constructor(e,t,n){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=n}build(e){return new Rr(e,this.config)}},Rr=class extends q{static[C]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};function Ma(r,e){let{name:t,config:n}=ce(r,e);return new ai(t,n?.precision,n?.scale)}var ui=class extends G{static[C]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new li(e,this.config)}},li=class extends q{static[C]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,n]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},ci=class extends G{static[C]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new hi(e,this.config)}},hi=class extends q{static[C]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}};function Ra(r,e){let{name:t,config:n}=ce(r,e);return!n?.mode||n.mode==="tuple"?new ui(t):new ci(t)}function ql(r){let e=[];for(let t=0;t<r.length;t+=2)e.push(Number.parseInt(r.slice(t,t+2),16));return new Uint8Array(e)}function Ba(r,e){let t=new ArrayBuffer(8),n=new DataView(t);for(let s=0;s<8;s++)n.setUint8(s,r[e+s]);return n.getFloat64(0,!0)}function fi(r){let e=ql(r),t=0,n=e[t];t+=1;let s=new DataView(e.buffer),i=s.getUint32(t,n===1);t+=4;let a;if(i&536870912&&(a=s.getUint32(t,n===1),t+=4),(i&65535)===1){let o=Ba(e,t);t+=8;let h=Ba(e,t);return t+=8,[o,h]}throw new Error("Unsupported geometry type")}var di=class extends G{static[C]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new pi(e,this.config)}},pi=class extends q{static[C]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return fi(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},mi=class extends G{static[C]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new gi(e,this.config)}},gi=class extends q{static[C]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=fi(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}};function $a(r,e){let{name:t,config:n}=ce(r,e);return!n?.mode||n.mode==="tuple"?new di(t):new mi(t)}var yi=class extends G{static[C]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new bi(e,this.config)}},bi=class extends q{static[C]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e};function Da(r){return new yi(r??"")}var vi=class extends G{static[C]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new wi(e,this.config)}},wi=class extends q{static[C]="PgSerial";getSQLType(){return"serial"}};function dt(r){return new vi(r??"")}var Si=class extends ft{static[C]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new _i(e,this.config)}},_i=class extends q{static[C]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e};function ja(r){return new Si(r??"")}var xi=class extends G{static[C]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Ci(e,this.config)}},Ci=class extends q{static[C]="PgSmallSerial";getSQLType(){return"smallserial"}};function Qa(r){return new xi(r??"")}var Ti=class extends G{static[C]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new Ei(e,this.config)}},Ei=class extends q{static[C]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}};function ee(r,e={}){let{name:t,config:n}=ce(r,e);return new Ti(t,n)}var Ai=class extends nt{constructor(e,t,n){super(e,"string","PgTime"),this.withTimezone=t,this.precision=n,this.config.withTimezone=t,this.config.precision=n}static[C]="PgTimeBuilder";build(e){return new Br(e,this.config)}},Br=class extends q{static[C]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};function qa(r,e={}){let{name:t,config:n}=ce(r,e);return new Ai(t,n.withTimezone??!1,n.precision)}var Ni=class extends nt{static[C]="PgTimestampBuilder";constructor(e,t,n){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=n}build(e){return new $r(e,this.config)}},$r=class extends q{static[C]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},Pi=class extends nt{static[C]="PgTimestampStringBuilder";constructor(e,t,n){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=n}build(e){return new Dr(e,this.config)}},Dr=class extends q{static[C]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};function et(r,e={}){let{name:t,config:n}=ce(r,e);return n?.mode==="string"?new Pi(t,n.withTimezone??!1,n.precision):new Ni(t,n?.withTimezone??!1,n?.precision)}var Ii=class extends G{static[C]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(N`gen_random_uuid()`)}build(e){return new jr(e,this.config)}},jr=class extends q{static[C]="PgUUID";getSQLType(){return"uuid"}};function Fa(r){return new Ii(r??"")}var ki=class extends G{static[C]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Oi(e,this.config)}},Oi=class extends q{static[C]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}};function bn(r,e={}){let{name:t,config:n}=ce(r,e);return new ki(t,n)}var Li=class extends G{static[C]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new Mi(e,this.config)}},Mi=class extends q{static[C]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}};function Ua(r,e){let{name:t,config:n}=ce(r,e);return new Li(t,n)}var Ri=class extends G{static[C]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new Bi(e,this.config)}},Bi=class extends q{static[C]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}};function za(r,e){let{name:t,config:n}=ce(r,e);return new Ri(t,n)}var $i=class extends G{static[C]="PgSparseVectorBuilder";constructor(e,t){super(e,"string","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new Di(e,this.config)}},Di=class extends q{static[C]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}};function Va(r,e){let{name:t,config:n}=ce(r,e);return new $i(t,n)}var ji=class extends G{static[C]="PgVectorBuilder";constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new Qi(e,this.config)}},Qi=class extends q{static[C]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}};function Ka(r,e){let{name:t,config:n}=ce(r,e);return new ji(t,n)}function Za(){return{bigint:Sa,bigserial:_a,boolean:St,char:xa,cidr:Ca,customType:Ta,date:Ea,doublePrecision:Aa,inet:Na,integer:st,interval:Pa,json:Ia,jsonb:yn,line:ka,macaddr:Oa,macaddr8:La,numeric:Ma,point:Ra,geometry:$a,real:Da,serial:dt,smallint:ja,smallserial:Qa,text:ee,time:qa,timestamp:et,uuid:Fa,varchar:bn,bit:Ua,halfvec:za,sparsevec:Va,vector:Ka}}var qi=Symbol.for("drizzle:PgInlineForeignKeys"),Wa=Symbol.for("drizzle:EnableRLS"),Oe=class extends z{static[C]="PgTable";static Symbol=Object.assign({},z.Symbol,{InlineForeignKeys:qi,EnableRLS:Wa});[qi]=[];[Wa]=!1;[z.Symbol.ExtraConfigBuilder]=void 0};function Fl(r,e,t,n,s=r){let i=new Oe(r,n,s),a=typeof e=="function"?e(Za()):e,o=Object.fromEntries(Object.entries(a).map(([f,y])=>{let b=y;b.setName(f);let w=b.build(i);return i[qi].push(...b.buildForeignKeys(w,i)),[f,w]})),h=Object.fromEntries(Object.entries(a).map(([f,y])=>{let b=y;b.setName(f);let w=b.buildExtraConfigColumn(i);return[f,w]})),p=Object.assign(i,o);return p[z.Symbol.Columns]=o,p[z.Symbol.ExtraConfigColumns]=h,t&&(p[Oe.Symbol.ExtraConfigBuilder]=t),Object.assign(p,{enableRLS:()=>(p[Oe.Symbol.EnableRLS]=!0,p)})}var _t=(r,e,t)=>Fl(r,e,t,void 0);var vn=class{static[C]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new Fi(e,this.columns,this.name)}},Fi=class{constructor(e,t,n){this.table=e,this.columns=t,this.name=n}static[C]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[Oe.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}};function Fe(r,e){return ha(e)&&!xs(r)&&!B(r,qe)&&!B(r,ct)&&!B(r,de)&&!B(r,z)&&!B(r,$e)?new qe(r,e):r}var pt=(r,e)=>N`${r} = ${Fe(e,r)}`,Ga=(r,e)=>N`${r} <> ${Fe(e,r)}`;function Lt(...r){let e=r.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new V(e):new V([new Ne("("),N.join(e,new Ne(" and ")),new Ne(")")])}function Ha(...r){let e=r.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new V(e):new V([new Ne("("),N.join(e,new Ne(" or ")),new Ne(")")])}function Ja(r){return N`not ${r}`}var Xa=(r,e)=>N`${r} > ${Fe(e,r)}`,Ya=(r,e)=>N`${r} >= ${Fe(e,r)}`,eu=(r,e)=>N`${r} < ${Fe(e,r)}`,wn=(r,e)=>N`${r} <= ${Fe(e,r)}`;function tu(r,e){return Array.isArray(e)?e.length===0?N`false`:N`${r} in ${e.map(t=>Fe(t,r))}`:N`${r} in ${Fe(e,r)}`}function ru(r,e){return Array.isArray(e)?e.length===0?N`true`:N`${r} not in ${e.map(t=>Fe(t,r))}`:N`${r} not in ${Fe(e,r)}`}function nu(r){return N`${r} is null`}function su(r){return N`${r} is not null`}function iu(r){return N`exists ${r}`}function ou(r){return N`not exists ${r}`}function au(r,e,t){return N`${r} between ${Fe(e,r)} and ${Fe(t,r)}`}function uu(r,e,t){return N`${r} not between ${Fe(e,r)} and ${Fe(t,r)}`}function lu(r,e){return N`${r} like ${e}`}function cu(r,e){return N`${r} not like ${e}`}function hu(r,e){return N`${r} ilike ${e}`}function fu(r,e){return N`${r} not ilike ${e}`}function du(r){return N`${r} asc`}function pu(r){return N`${r} desc`}var Sn=class{constructor(e,t,n){this.sourceTable=e,this.referencedTable=t,this.relationName=n,this.referencedTableName=t[z.Symbol.Name]}static[C]="Relation";referencedTableName;fieldName},Ui=class{constructor(e,t){this.table=e,this.config=t}static[C]="Relations"},xt=class r extends Sn{constructor(e,t,n,s){super(e,t,n?.relationName),this.config=n,this.isNullable=s}static[C]="One";withFieldName(e){let t=new r(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}},Qr=class r extends Sn{constructor(e,t,n){super(e,t,n?.relationName),this.config=n}static[C]="Many";withFieldName(e){let t=new r(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}};function mu(){return{and:Lt,between:au,eq:pt,exists:iu,gt:Xa,gte:Ya,ilike:hu,inArray:tu,isNull:nu,isNotNull:su,like:lu,lt:eu,lte:wn,ne:Ga,not:Ja,notBetween:uu,notExists:ou,notLike:cu,notIlike:fu,notInArray:ru,or:Ha,sql:N}}function gu(){return{sql:N,asc:du,desc:pu}}function yu(r,e){Object.keys(r).length===1&&"default"in r&&!B(r.default,z)&&(r=r.default);let t={},n={},s={};for(let[i,a]of Object.entries(r))if(B(a,z)){let o=kt(a),h=n[o];t[o]=i,s[i]={tsName:i,dbName:a[z.Symbol.Name],schema:a[z.Symbol.Schema],columns:a[z.Symbol.Columns],relations:h?.relations??{},primaryKey:h?.primaryKey??[]};for(let f of Object.values(a[z.Symbol.Columns]))f.primary&&s[i].primaryKey.push(f);let p=a[z.Symbol.ExtraConfigBuilder]?.(a[z.Symbol.ExtraConfigColumns]);if(p)for(let f of Object.values(p))B(f,vn)&&s[i].primaryKey.push(...f.columns)}else if(B(a,Ui)){let o=kt(a.table),h=t[o],p=a.config(e(a.table)),f;for(let[y,b]of Object.entries(p))if(h){let w=s[h];w.relations[y]=b,f&&w.primaryKey.push(...f)}else o in n||(n[o]={relations:{},primaryKey:f}),n[o].relations[y]=b}return{tables:s,tableNamesMap:t}}function Ul(r){return function(t,n){return new xt(r,t,n,n?.fields.reduce((s,i)=>s&&i.notNull,!0)??!1)}}function zl(r){return function(t,n){return new Qr(r,t,n)}}function bu(r,e,t){if(B(t,xt)&&t.config)return{fields:t.config.fields,references:t.config.references};let n=e[kt(t.referencedTable)];if(!n)throw new Error(`Table "${t.referencedTable[z.Symbol.Name]}" not found in schema`);let s=r[n];if(!s)throw new Error(`Table "${n}" not found in schema`);let i=t.sourceTable,a=e[kt(i)];if(!a)throw new Error(`Table "${i[z.Symbol.Name]}" not found in schema`);let o=[];for(let h of Object.values(s.relations))(t.relationName&&t!==h&&h.relationName===t.relationName||!t.relationName&&h.referencedTable===t.sourceTable)&&o.push(h);if(o.length>1)throw t.relationName?new Error(`There are multiple relations with name "${t.relationName}" in table "${n}"`):new Error(`There are multiple relations between "${n}" and "${t.sourceTable[z.Symbol.Name]}". Please specify relation name`);if(o[0]&&B(o[0],xt)&&o[0].config)return{fields:o[0].config.references,references:o[0].config.fields};throw new Error(`There is not enough information to infer relation "${a}.${t.fieldName}"`)}function vu(r){return{one:Ul(r),many:zl(r)}}function _n(r,e,t,n,s=i=>i){let i={};for(let[a,o]of n.entries())if(o.isJson){let h=e.relations[o.tsKey],p=t[a],f=typeof p=="string"?JSON.parse(p):p;i[o.tsKey]=B(h,xt)?f&&_n(r,r[o.relationTableTsKey],f,o.selection,s):f.map(y=>_n(r,r[o.relationTableTsKey],y,o.selection,s))}else{let h=s(t[a]),p=o.field,f;B(p,de)?f=p:B(p,V)?f=p.decoder:f=p.sql.decoder,i[o.tsKey]=h===null?null:f.mapFromDriverValue(h)}return i}var or=class extends $e{static[C]="PgViewBase"};var Ct=class{static[C]="PgDialect";casing;constructor(e){this.casing=new mn(e?.casing)}async migrate(e,t,n){let s=typeof n=="string"?"__drizzle_migrations":n.migrationsTable??"__drizzle_migrations",i=typeof n=="string"?"drizzle":n.migrationsSchema??"drizzle",a=N`
			CREATE TABLE IF NOT EXISTS ${N.identifier(i)}.${N.identifier(s)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(N`CREATE SCHEMA IF NOT EXISTS ${N.identifier(i)}`),await t.execute(a);let h=(await t.all(N`select id, hash, created_at from ${N.identifier(i)}.${N.identifier(s)} order by created_at desc limit 1`))[0];await t.transaction(async p=>{for await(let f of e)if(!h||Number(h.created_at)<f.folderMillis){for(let y of f.sql)await p.execute(N.raw(y));await p.execute(N`insert into ${N.identifier(i)}.${N.identifier(s)} ("hash", "created_at") values(${f.hash}, ${f.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[N`with `];for(let[n,s]of e.entries())t.push(N`${N.identifier(s._.alias)} as (${s._.sql})`),n<e.length-1&&t.push(N`, `);return t.push(N` `),N.join(t)}buildDeleteQuery({table:e,where:t,returning:n,withList:s}){let i=this.buildWithCTE(s),a=n?N` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,o=t?N` where ${t}`:void 0;return N`${i}delete from ${e}${o}${a}`}buildUpdateSet(e,t){let n=e[z.Symbol.Columns],s=Object.keys(n).filter(a=>t[a]!==void 0||n[a]?.onUpdateFn!==void 0),i=s.length;return N.join(s.flatMap((a,o)=>{let h=n[a],p=t[a]??N.param(h.onUpdateFn(),h),f=N`${N.identifier(this.casing.getColumnCasing(h))} = ${p}`;return o<i-1?[f,N.raw(", ")]:[f]}))}buildUpdateQuery({table:e,set:t,where:n,returning:s,withList:i,from:a,joins:o}){let h=this.buildWithCTE(i),p=e[Oe.Symbol.Name],f=e[Oe.Symbol.Schema],y=e[Oe.Symbol.OriginalName],b=p===y?void 0:p,w=N`${f?N`${N.identifier(f)}.`:void 0}${N.identifier(y)}${b&&N` ${N.identifier(b)}`}`,g=this.buildUpdateSet(e,t),l=a&&N.join([N.raw(" from "),this.buildFromTable(a)]),v=this.buildJoins(o),S=s?N` returning ${this.buildSelection(s,{isSingleTable:!a})}`:void 0,x=n?N` where ${n}`:void 0;return N`${h}update ${w} set ${g}${l}${v}${x}${S}`}buildSelection(e,{isSingleTable:t=!1}={}){let n=e.length,s=e.flatMap(({field:i},a)=>{let o=[];if(B(i,V.Aliased)&&i.isSelectionField)o.push(N.identifier(i.fieldAlias));else if(B(i,V.Aliased)||B(i,V)){let h=B(i,V.Aliased)?i.sql:i;t?o.push(new V(h.queryChunks.map(p=>B(p,q)?N.identifier(this.casing.getColumnCasing(p)):p))):o.push(h),B(i,V.Aliased)&&o.push(N` as ${N.identifier(i.fieldAlias)}`)}else B(i,de)&&(t?o.push(N.identifier(this.casing.getColumnCasing(i))):o.push(i));return a<n-1&&o.push(N`, `),o});return N.join(s)}buildJoins(e){if(!e||e.length===0)return;let t=[];for(let[n,s]of e.entries()){n===0&&t.push(N` `);let i=s.table,a=s.lateral?N` lateral`:void 0;if(B(i,Oe)){let o=i[Oe.Symbol.Name],h=i[Oe.Symbol.Schema],p=i[Oe.Symbol.OriginalName],f=o===p?void 0:s.alias;t.push(N`${N.raw(s.joinType)} join${a} ${h?N`${N.identifier(h)}.`:void 0}${N.identifier(p)}${f&&N` ${N.identifier(f)}`} on ${s.on}`)}else if(B(i,$e)){let o=i[ge].name,h=i[ge].schema,p=i[ge].originalName,f=o===p?void 0:s.alias;t.push(N`${N.raw(s.joinType)} join${a} ${h?N`${N.identifier(h)}.`:void 0}${N.identifier(p)}${f&&N` ${N.identifier(f)}`} on ${s.on}`)}else t.push(N`${N.raw(s.joinType)} join${a} ${i} on ${s.on}`);n<e.length-1&&t.push(N` `)}return N.join(t)}buildFromTable(e){if(B(e,z)&&e[z.Symbol.OriginalName]!==e[z.Symbol.Name]){let t=N`${N.identifier(e[z.Symbol.OriginalName])}`;return e[z.Symbol.Schema]&&(t=N`${N.identifier(e[z.Symbol.Schema])}.${t}`),N`${t} ${N.identifier(e[z.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:t,fieldsFlat:n,where:s,having:i,table:a,joins:o,orderBy:h,groupBy:p,limit:f,offset:y,lockingClause:b,distinct:w,setOperators:g}){let l=n??Ze(t);for(let M of l)if(B(M.field,de)&&Qe(M.field.table)!==(B(a,Ee)?a._.alias:B(a,or)?a[ge].name:B(a,V)?void 0:Qe(a))&&!(F=>o?.some(({alias:J})=>J===(F[z.Symbol.IsAlias]?Qe(F):F[z.Symbol.BaseName])))(M.field.table)){let F=Qe(M.field.table);throw new Error(`Your "${M.path.join("->")}" field references a column "${F}"."${M.field.name}", but the table "${F}" is not part of the query! Did you forget to join it?`)}let v=!o||o.length===0,S=this.buildWithCTE(e),x;w&&(x=w===!0?N` distinct`:N` distinct on (${N.join(w.on,N`, `)})`);let T=this.buildSelection(l,{isSingleTable:v}),O=this.buildFromTable(a),L=this.buildJoins(o),_=s?N` where ${s}`:void 0,I=i?N` having ${i}`:void 0,P;h&&h.length>0&&(P=N` order by ${N.join(h,N`, `)}`);let E;p&&p.length>0&&(E=N` group by ${N.join(p,N`, `)}`);let $=typeof f=="object"||typeof f=="number"&&f>=0?N` limit ${f}`:void 0,R=y?N` offset ${y}`:void 0,Z=N.empty();if(b){let M=N` for ${N.raw(b.strength)}`;b.config.of&&M.append(N` of ${N.join(Array.isArray(b.config.of)?b.config.of:[b.config.of],N`, `)}`),b.config.noWait?M.append(N` no wait`):b.config.skipLocked&&M.append(N` skip locked`),Z.append(M)}let W=N`${S}select${x} ${T} from ${O}${L}${_}${E}${I}${P}${$}${R}${Z}`;return g.length>0?this.buildSetOperations(W,g):W}buildSetOperations(e,t){let[n,...s]=t;if(!n)throw new Error("Cannot pass undefined values to any set operator");return s.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),s)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:n,rightSelect:s,limit:i,orderBy:a,offset:o}}){let h=N`(${e.getSQL()}) `,p=N`(${s.getSQL()})`,f;if(a&&a.length>0){let g=[];for(let l of a)if(B(l,q))g.push(N.identifier(l.name));else if(B(l,V)){for(let v=0;v<l.queryChunks.length;v++){let S=l.queryChunks[v];B(S,q)&&(l.queryChunks[v]=N.identifier(S.name))}g.push(N`${l}`)}else g.push(N`${l}`);f=N` order by ${N.join(g,N`, `)} `}let y=typeof i=="object"||typeof i=="number"&&i>=0?N` limit ${i}`:void 0,b=N.raw(`${t} ${n?"all ":""}`),w=o?N` offset ${o}`:void 0;return N`${h}${b}${p}${f}${y}${w}`}buildInsertQuery({table:e,values:t,onConflict:n,returning:s,withList:i,select:a,overridingSystemValue_:o}){let h=[],p=e[z.Symbol.Columns],f=Object.entries(p).filter(([S,x])=>!x.shouldDisableInsert()),y=f.map(([,S])=>N.identifier(this.casing.getColumnCasing(S)));if(a){let S=t;B(S,V)?h.push(S):h.push(S.getSQL())}else{let S=t;h.push(N.raw("values "));for(let[x,T]of S.entries()){let O=[];for(let[L,_]of f){let I=T[L];if(I===void 0||B(I,qe)&&I.value===void 0)if(_.defaultFn!==void 0){let P=_.defaultFn(),E=B(P,V)?P:N.param(P,_);O.push(E)}else if(!_.default&&_.onUpdateFn!==void 0){let P=_.onUpdateFn(),E=B(P,V)?P:N.param(P,_);O.push(E)}else O.push(N`default`);else O.push(I)}h.push(O),x<S.length-1&&h.push(N`, `)}}let b=this.buildWithCTE(i),w=N.join(h),g=s?N` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,l=n?N` on conflict ${n}`:void 0,v=o===!0?N`overriding system value `:void 0;return N`${b}insert into ${e} ${y} ${v}${w}${l}${g}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:n}){let s=t?N` concurrently`:void 0,i=n?N` with no data`:void 0;return N`refresh materialized view${s} ${e}${i}`}prepareTyping(e){return B(e,Mr)||B(e,Lr)?"json":B(e,Rr)?"decimal":B(e,Br)?"time":B(e,$r)||B(e,Dr)?"timestamp":B(e,kr)||B(e,Or)?"date":B(e,jr)?"uuid":"none"}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:n,table:s,tableConfig:i,queryConfig:a,tableAlias:o,nestedQueryRelation:h,joinOn:p}){let f=[],y,b,w=[],g,l=[];if(a===!0)f=Object.entries(i.columns).map(([x,T])=>({dbKey:T.name,tsKey:x,field:rt(T,o),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let S=Object.fromEntries(Object.entries(i.columns).map(([I,P])=>[I,rt(P,o)]));if(a.where){let I=typeof a.where=="function"?a.where(S,mu()):a.where;g=I&&Ar(I,o)}let x=[],T=[];if(a.columns){let I=!1;for(let[P,E]of Object.entries(a.columns))E!==void 0&&P in i.columns&&(!I&&E===!0&&(I=!0),T.push(P));T.length>0&&(T=I?T.filter(P=>a.columns?.[P]===!0):Object.keys(i.columns).filter(P=>!T.includes(P)))}else T=Object.keys(i.columns);for(let I of T){let P=i.columns[I];x.push({tsKey:I,value:P})}let O=[];a.with&&(O=Object.entries(a.with).filter(I=>!!I[1]).map(([I,P])=>({tsKey:I,queryConfig:P,relation:i.relations[I]})));let L;if(a.extras){L=typeof a.extras=="function"?a.extras(S,{sql:N}):a.extras;for(let[I,P]of Object.entries(L))x.push({tsKey:I,value:Cs(P,o)})}for(let{tsKey:I,value:P}of x)f.push({dbKey:B(P,V.Aliased)?P.fieldAlias:i.columns[I].name,tsKey:I,field:B(P,de)?rt(P,o):P,relationTableTsKey:void 0,isJson:!1,selection:[]});let _=typeof a.orderBy=="function"?a.orderBy(S,gu()):a.orderBy??[];Array.isArray(_)||(_=[_]),w=_.map(I=>B(I,de)?rt(I,o):Ar(I,o)),y=a.limit,b=a.offset;for(let{tsKey:I,queryConfig:P,relation:E}of O){let $=bu(t,n,E),R=kt(E.referencedTable),Z=n[R],W=`${o}_${I}`,M=Lt(...$.fields.map((ie,fe)=>pt(rt($.references[fe],W),rt(ie,o)))),F=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:n,table:e[Z],tableConfig:t[Z],queryConfig:B(E,xt)?P===!0?{limit:1}:{...P,limit:1}:P,tableAlias:W,joinOn:M,nestedQueryRelation:E}),J=N`${N.identifier(W)}.${N.identifier("data")}`.as(I);l.push({on:N`true`,table:new Ee(F.sql,{},W),alias:W,joinType:"left",lateral:!0}),f.push({dbKey:I,tsKey:I,field:J,relationTableTsKey:Z,isJson:!0,selection:F.selection})}}if(f.length===0)throw new Ir({message:`No fields selected for table "${i.tsName}" ("${o}")`});let v;if(g=Lt(p,g),h){let S=N`json_build_array(${N.join(f.map(({field:O,tsKey:L,isJson:_})=>_?N`${N.identifier(`${o}_${L}`)}.${N.identifier("data")}`:B(O,V.Aliased)?O.sql:O),N`, `)})`;B(h,Qr)&&(S=N`coalesce(json_agg(${S}${w.length>0?N` order by ${N.join(w,N`, `)}`:void 0}), '[]'::json)`);let x=[{dbKey:"data",tsKey:"data",field:S.as("data"),isJson:!0,relationTableTsKey:i.tsName,selection:f}];y!==void 0||b!==void 0||w.length>0?(v=this.buildSelectQuery({table:Er(s,o),fields:{},fieldsFlat:[{path:[],field:N.raw("*")}],where:g,limit:y,offset:b,orderBy:w,setOperators:[]}),g=void 0,y=void 0,b=void 0,w=[]):v=Er(s,o),v=this.buildSelectQuery({table:B(v,Oe)?v:new Ee(v,{},o),fields:{},fieldsFlat:x.map(({field:O})=>({path:[],field:B(O,de)?rt(O,o):O})),joins:l,where:g,limit:y,offset:b,orderBy:w,setOperators:[]})}else v=this.buildSelectQuery({table:Er(s,o),fields:{},fieldsFlat:f.map(({field:S})=>({path:[],field:B(S,de)?rt(S,o):S})),joins:l,where:g,limit:y,offset:b,orderBy:w,setOperators:[]});return{tableTsKey:i.tsName,sql:v,selection:f}}};var xn=class{static[C]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}};var Re=class{static[C]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let t=!!this.fields,n=e,s;return this.fields?s=this.fields:B(n,Ee)?s=Object.fromEntries(Object.keys(n._.selectedFields).map(i=>[i,n[i]])):B(n,or)?s=n[ge].selectedFields:B(n,V)?s={}:s=pn(n),new Cn({table:n,fields:s,isPartialSelect:t,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},zi=class extends xn{static[C]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:e,fields:t,isPartialSelect:n,session:s,dialect:i,withList:a,distinct:o}){super(),this.config={withList:a,table:e,fields:{...t},distinct:o,setOperators:[]},this.isPartialSelect=n,this.session=s,this.dialect=i,this._={selectedFields:t},this.tableName=ht(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(e){return(t,n)=>{let s=this.tableName,i=ht(t);if(typeof i=="string"&&this.config.joins?.some(a=>a.alias===i))throw new Error(`Alias "${i}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof s=="string"&&(this.config.fields={[s]:this.config.fields}),typeof i=="string"&&!B(t,V))){let a=B(t,Ee)?t._.selectedFields:B(t,$e)?t[ge].selectedFields:t[z.Symbol.Columns];this.config.fields[i]=a}if(typeof n=="function"&&(n=n(new Proxy(this.config.fields,new xe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:t,joinType:e,alias:i}),typeof i=="string")switch(e){case"left":{this.joinsNotNullableMap[i]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!0;break}case"inner":{this.joinsNotNullableMap[i]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(e,t){return n=>{let s=typeof n=="function"?n(Vl()):n;if(!Nr(this.getSelectedFields(),s.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:s}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new xe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new xe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new xe({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new xe({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),n=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}else{let t=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=t:this.config.orderBy=t}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){return new Proxy(new Ee(this.getSQL(),this.config.fields,e),new xe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new xe({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}},Cn=class extends zi{static[C]="PgSelect";_prepare(e){let{session:t,config:n,dialect:s,joinsNotNullableMap:i,authToken:a}=this;if(!t)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return Ae.startActiveSpan("drizzle.prepareQuery",()=>{let o=Ze(n.fields),h=t.prepareQuery(s.sqlToQuery(this.getSQL()),o,e,!0);return h.joinsNotNullableMap=i,h.setToken(a)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>Ae.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};ba(Cn,[Me]);function ar(r,e){return(t,n,...s)=>{let i=[n,...s].map(a=>({type:r,isAll:e,rightSelect:a}));for(let a of i)if(!Nr(t.getSelectedFields(),a.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return t.addSetOperators(i)}}var Vl=()=>({union:Kl,unionAll:Zl,intersect:Wl,intersectAll:Gl,except:Hl,exceptAll:Jl}),Kl=ar("union",!1),Zl=ar("union",!0),Wl=ar("intersect",!1),Gl=ar("intersect",!0),Hl=ar("except",!1),Jl=ar("except",!0);var ur=class{static[C]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=B(e,Ct)?e:void 0,this.dialectConfig=B(e,Ct)?void 0:e}$with=(e,t)=>{let n=this;return{as:i=>(typeof i=="function"&&(i=i(n)),new Proxy(new sr(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new xe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...e){let t=this;function n(a){return new Re({fields:a??void 0,session:void 0,dialect:t.getDialect(),withList:e})}function s(a){return new Re({fields:a??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})}function i(a,o){return new Re({fields:o??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:a}})}return{select:n,selectDistinct:s,selectDistinctOn:i}}select(e){return new Re({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new Re({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new Re({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new Ct(this.dialectConfig)),this.dialect}};var qr=class{constructor(e,t,n,s,i){this.table=e,this.session=t,this.dialect=n,this.withList=s,this.overridingSystemValue_=i}static[C]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let t=e.map(n=>{let s={},i=this.table[z.Symbol.Columns];for(let a of Object.keys(n)){let o=n[a];s[a]=B(o,V)?o:new qe(o,i[a])}return s});return new Tn(this.table,t,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let t=typeof e=="function"?e(new ur):e;if(!B(t,V)&&!Nr(this.table[hn],t._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new Tn(this.table,t,this.session,this.dialect,this.withList,!0)}},Tn=class extends Me{constructor(e,t,n,s,i,a,o){super(),this.session=n,this.dialect=s,this.config={table:e,values:t,withList:i,select:a,overridingSystemValue_:o}}static[C]="PgInsert";config;returning(e=this.config.table[z.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Ze(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=N`do nothing`;else{let t="";t=Array.isArray(e.target)?e.target.map(s=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(s))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let n=e.where?N` where ${e.where}`:void 0;this.config.onConflict=N`(${N.raw(t)})${n} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let t=e.where?N` where ${e.where}`:void 0,n=e.targetWhere?N` where ${e.targetWhere}`:void 0,s=e.setWhere?N` where ${e.setWhere}`:void 0,i=this.dialect.buildUpdateSet(this.config.table,dn(this.config.table,e.set)),a="";return a=Array.isArray(e.target)?e.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=N`(${N.raw(a)})${n} do update set ${i}${t}${s}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return Ae.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>Ae.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new xe({alias:Qe(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var En=class extends Me{constructor(e,t,n){super(),this.session=t,this.dialect=n,this.config={view:e}}static[C]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return Ae.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>Ae.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken))};var Fr=class{constructor(e,t,n,s){this.table=e,this.session=t,this.dialect=n,this.withList=s}static[C]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new Vi(this.table,dn(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},Vi=class extends Me{constructor(e,t,n,s,i){super(),this.session=n,this.dialect=s,this.config={set:t,table:e,withList:i,joins:[]},this.tableName=ht(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[C]="PgUpdate";config;tableName;joinsNotNullableMap;from(e){let t=e,n=ht(t);return typeof n=="string"&&(this.joinsNotNullableMap[n]=!0),this.config.from=t,this}getTableLikeFields(e){return B(e,Oe)?e[z.Symbol.Columns]:B(e,Ee)?e._.selectedFields:e[ge].selectedFields}createJoin(e){return(t,n)=>{let s=ht(t);if(typeof s=="string"&&this.config.joins.some(i=>i.alias===s))throw new Error(`Alias "${s}" is already used in this query`);if(typeof n=="function"){let i=this.config.from&&!B(this.config.from,V)?this.getTableLikeFields(this.config.from):void 0;n=n(new Proxy(this.config.table[z.Symbol.Columns],new xe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),i&&new Proxy(i,new xe({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:n,table:t,joinType:e,alias:s}),typeof s=="string")switch(e){case"left":{this.joinsNotNullableMap[s]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[s]=!0;break}case"inner":{this.joinsNotNullableMap[s]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([i])=>[i,!1])),this.joinsNotNullableMap[s]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[z.Symbol.Columns]),this.config.from)){let t=ht(this.config.from);if(typeof t=="string"&&this.config.from&&!B(this.config.from,V)){let n=this.getTableLikeFields(this.config.from);e[t]=n}for(let n of this.config.joins){let s=ht(n.table);if(typeof s=="string"&&!B(n.table,V)){let i=this.getTableLikeFields(n.table);e[s]=i}}}return this.config.returningFields=e,this.config.returning=Ze(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){let t=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0);return t.joinsNotNullableMap=this.joinsNotNullableMap,t}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>this._prepare().execute(e,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new xe({alias:Qe(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};var An=class r extends V{constructor(e){super(r.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=r.buildCount(e.source,e.filters)}sql;token;static[C]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,t){return N`(select count(*) from ${e}${N.raw(" where ").if(t)}${t})`}static buildCount(e,t){return N`select count(*) as count from ${e}${N.raw(" where ").if(t)}${t};`}setToken(e){return this.token=e,this}then(e,t){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}};var Nn=class{constructor(e,t,n,s,i,a,o){this.fullSchema=e,this.schema=t,this.tableNamesMap=n,this.table=s,this.tableConfig=i,this.dialect=a,this.session=o}static[C]="PgRelationalQueryBuilder";findMany(e){return new Pn(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new Pn(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},Pn=class extends Me{constructor(e,t,n,s,i,a,o,h,p){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=n,this.table=s,this.tableConfig=i,this.dialect=a,this.session=o,this.config=h,this.mode=p}static[C]="PgRelationalQuery";_prepare(e){return Ae.startActiveSpan("drizzle.prepareQuery",()=>{let{query:t,builtQuery:n}=this._toSQL();return this.session.prepareQuery(n,void 0,e,!0,(s,i)=>{let a=s.map(o=>_n(this.schema,this.tableConfig,o,t.selection,i));return this.mode==="first"?a[0]:a})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return Ae.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};var In=class extends Me{constructor(e,t,n,s){super(),this.execute=e,this.sql=t,this.query=n,this.mapBatchResult=s}static[C]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var lr=class{constructor(e,t,n){if(this.dialect=e,this.session=t,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:t},this.query={},this._.schema)for(let[s,i]of Object.entries(this._.schema))this.query[s]=new Nn(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[s],i,e,t)}static[C]="PgDatabase";query;$with=(e,t)=>{let n=this;return{as:i=>(typeof i=="function"&&(i=i(new ur(n.dialect))),new Proxy(new sr(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new xe({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(e,t){return new An({source:e,filters:t,session:this.session})}with(...e){let t=this;function n(p){return new Re({fields:p??void 0,session:t.session,dialect:t.dialect,withList:e})}function s(p){return new Re({fields:p??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})}function i(p,f){return new Re({fields:f??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:p}})}function a(p){return new Fr(p,t.session,t.dialect,e)}function o(p){return new qr(p,t.session,t.dialect,e)}function h(p){return new Pr(p,t.session,t.dialect,e)}return{select:n,selectDistinct:s,selectDistinctOn:i,update:a,insert:o,delete:h}}select(e){return new Re({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new Re({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new Re({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Fr(e,this.session,this.dialect)}insert(e){return new qr(e,this.session,this.dialect)}delete(e){return new Pr(e,this.session,this.dialect)}refreshMaterializedView(e){return new En(e,this.session,this.dialect)}authToken;execute(e){let t=typeof e=="string"?N.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(t),s=this.session.prepareQuery(n,void 0,void 0,!1);return new In(()=>s.execute(void 0,this.authToken),t,n,i=>s.mapResult(i,!0))}transaction(e,t){return this.session.transaction(e,t)}};var Ki=class{constructor(e,t){this.unique=e,this.name=t}static[C]="PgIndexBuilderOn";on(...e){return new Ur(e.map(t=>{if(B(t,V))return t;t=t;let n=new nr(t.name,!!t.keyAsName,t.columnType,t.indexConfig);return t.indexConfig=JSON.parse(JSON.stringify(t.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new Ur(e.map(t=>{if(B(t,V))return t;t=t;let n=new nr(t.name,!!t.keyAsName,t.columnType,t.indexConfig);return t.indexConfig=t.defaultConfig,n}),this.unique,!0,this.name)}using(e,...t){return new Ur(t.map(n=>{if(B(n,V))return n;n=n;let s=new nr(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),s}),this.unique,!0,this.name,e)}},Ur=class{static[C]="PgIndexBuilder";config;constructor(e,t,n,s,i="btree"){this.config={name:s,columns:e,unique:t,only:n,method:i}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new Zi(this.config,e)}},Zi=class{static[C]="PgIndex";config;constructor(e,t){this.config={...e,table:t}}};function wu(r){return new Ki(!1,r)}var kn=class{constructor(e){this.query=e}authToken;getQuery(){return this.query}mapResult(e,t){return e}setToken(e){return this.authToken=e,this}static[C]="PgPreparedQuery";joinsNotNullableMap},On=class{constructor(e){this.dialect=e}static[C]="PgSession";execute(e,t){return Ae.startActiveSpan("drizzle.operation",()=>Ae.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(t).execute(void 0,t))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,t){let n=await this.execute(e,t);return Number(n[0].count)}},Ln=class extends lr{constructor(e,t,n,s=0){super(e,t,n),this.schema=n,this.nestedIndex=s}static[C]="PgTransaction";rollback(){throw new gn}getTransactionConfigSQL(e){let t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),typeof e.deferrable=="boolean"&&t.push(e.deferrable?"deferrable":"not deferrable"),N.raw(t.join(" "))}setTransaction(e){return this.session.execute(N`set transaction ${this.getTransactionConfigSQL(e)}`)}};var Wi=class extends kn{constructor(e,t,n,s,i,a,o,h){super({sql:t,params:n}),this.client=e,this.params=n,this.logger=s,this.fields=i,this._isResponseInArrayMode=o,this.customResultMapper=h,this.rawQueryConfig={name:a,text:t,types:{getTypeParser:(p,f)=>p===Xe.builtins.TIMESTAMPTZ?y=>y:p===Xe.builtins.TIMESTAMP?y=>y:p===Xe.builtins.DATE?y=>y:p===Xe.builtins.INTERVAL?y=>y:Xe.getTypeParser(p,f)}},this.queryConfig={name:a,text:t,rowMode:"array",types:{getTypeParser:(p,f)=>p===Xe.builtins.TIMESTAMPTZ?y=>y:p===Xe.builtins.TIMESTAMP?y=>y:p===Xe.builtins.DATE?y=>y:p===Xe.builtins.INTERVAL?y=>y:Xe.getTypeParser(p,f)}}}static[C]="NeonPreparedQuery";rawQueryConfig;queryConfig;async execute(e={}){let t=fn(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,t);let{fields:n,client:s,rawQueryConfig:i,queryConfig:a,joinsNotNullableMap:o,customResultMapper:h}=this;if(!n&&!h)return s.query(i,t);let p=await s.query(a,t);return h?h(p.rows):p.rows.map(f=>ya(n,f,o))}all(e={}){let t=fn(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,t),this.client.query(this.rawQueryConfig,t).then(n=>n.rows)}values(e={}){let t=fn(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,t),this.client.query(this.queryConfig,t).then(n=>n.rows)}isResponseInArrayMode(){return this._isResponseInArrayMode}},Mn=class r extends On{constructor(e,t,n,s={}){super(t),this.client=e,this.schema=n,this.options=s,this.logger=s.logger??new on}static[C]="NeonSession";logger;prepareQuery(e,t,n,s,i){return new Wi(this.client,e.sql,e.params,this.logger,t,n,s,i)}async query(e,t){return this.logger.logQuery(e,t),await this.client.query({rowMode:"array",text:e,values:t})}async queryObjects(e,t){return this.client.query(e,t)}async count(e){let t=await this.execute(e);return Number(t.rows[0].count)}async transaction(e,t={}){let n=this.client instanceof lt?new r(await this.client.connect(),this.dialect,this.schema,this.options):this,s=new Gi(this.dialect,n,this.schema);await s.execute(N`begin ${s.getTransactionConfigSQL(t)}`);try{let i=await e(s);return await s.execute(N`commit`),i}catch(i){throw await s.execute(N`rollback`),i}finally{this.client instanceof lt&&n.client.release()}}},Gi=class r extends Ln{static[C]="NeonTransaction";async transaction(e){let t=`sp${this.nestedIndex+1}`,n=new r(this.dialect,this.session,this.schema,this.nestedIndex+1);await n.execute(N.raw(`savepoint ${t}`));try{let s=await e(n);return await n.execute(N.raw(`release savepoint ${t}`)),s}catch(s){throw await n.execute(N.raw(`rollback to savepoint ${t}`)),s}}};var Hi=class{constructor(e,t,n={}){this.client=e,this.dialect=t,this.options=n}static[C]="NeonDriver";createSession(e){return new Mn(this.client,this.dialect,e,{logger:this.options.logger})}},Ji=class extends lr{static[C]="NeonServerlessDatabase"};function zr(r,e={}){let t=new Ct({casing:e.casing}),n;e.logger===!0?n=new sn:e.logger!==!1&&(n=e.logger);let s;if(e.schema){let h=yu(e.schema,vu);s={fullSchema:e.schema,schema:h.tables,tableNamesMap:h.tableNamesMap}}let a=new Hi(r,t,{logger:n}).createSession(s),o=new Ji(t,a,s);return o.$client=r,o}function Rn(...r){if(typeof r[0]=="string"){let e=new lt({connectionString:r[0]});return zr(e,r[1])}if(wa(r[0])){let{connection:e,client:t,ws:n,...s}=r[0];if(n&&(wt.webSocketConstructor=n),t)return zr(t,s);let i=typeof e=="string"?new lt({connectionString:e}):new lt(e);return zr(i,s)}return zr(r[0],r[1])}(r=>{function e(t){return zr({},t)}r.mock=e})(Rn||(Rn={}));var he;(function(r){r.assertEqual=s=>s;function e(s){}r.assertIs=e;function t(s){throw new Error}r.assertNever=t,r.arrayToEnum=s=>{let i={};for(let a of s)i[a]=a;return i},r.getValidEnumValues=s=>{let i=r.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(let o of i)a[o]=s[o];return r.objectValues(a)},r.objectValues=s=>r.objectKeys(s).map(function(i){return s[i]}),r.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{let i=[];for(let a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},r.find=(s,i)=>{for(let a of s)if(i(a))return a},r.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}r.joinValues=n,r.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(he||(he={}));var Yi;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(Yi||(Yi={}));var K=he.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),gt=r=>{switch(typeof r){case"undefined":return K.undefined;case"string":return K.string;case"number":return isNaN(r)?K.nan:K.number;case"boolean":return K.boolean;case"function":return K.function;case"bigint":return K.bigint;case"symbol":return K.symbol;case"object":return Array.isArray(r)?K.array:r===null?K.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?K.promise:typeof Map<"u"&&r instanceof Map?K.map:typeof Set<"u"&&r instanceof Set?K.set:typeof Date<"u"&&r instanceof Date?K.date:K.object;default:return K.unknown}},j=he.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Xl=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:"),ze=class r extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(i){return i.message},n={_errors:[]},s=i=>{for(let a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)n._errors.push(t(a));else{let o=n,h=0;for(;h<a.path.length;){let p=a.path[h];h===a.path.length-1?(o[p]=o[p]||{_errors:[]},o[p]._errors.push(t(a))):o[p]=o[p]||{_errors:[]},o=o[p],h++}}};return s(this),n}static assert(e){if(!(e instanceof r))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,he.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},n=[];for(let s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}};ze.create=r=>new ze(r);var fr=(r,e)=>{let t;switch(r.code){case j.invalid_type:r.received===K.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case j.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,he.jsonStringifyReplacer)}`;break;case j.unrecognized_keys:t=`Unrecognized key(s) in object: ${he.joinValues(r.keys,", ")}`;break;case j.invalid_union:t="Invalid input";break;case j.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${he.joinValues(r.options)}`;break;case j.invalid_enum_value:t=`Invalid enum value. Expected ${he.joinValues(r.options)}, received '${r.received}'`;break;case j.invalid_arguments:t="Invalid function arguments";break;case j.invalid_return_type:t="Invalid function return type";break;case j.invalid_date:t="Invalid date";break;case j.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:he.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case j.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case j.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case j.custom:t="Invalid input";break;case j.invalid_intersection_types:t="Intersection results could not be merged";break;case j.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case j.not_finite:t="Number must be finite";break;default:t=e.defaultError,he.assertNever(r)}return{message:t}},Cu=fr;function Yl(r){Cu=r}function Bn(){return Cu}var $n=r=>{let{data:e,path:t,errorMaps:n,issueData:s}=r,i=[...t,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="",h=n.filter(p=>!!p).slice().reverse();for(let p of h)o=p(a,{data:e,defaultError:o}).message;return{...s,path:i,message:o}},ec=[];function U(r,e){let t=Bn(),n=$n({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===fr?void 0:fr].filter(s=>!!s)});r.common.issues.push(n)}var Be=class r{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let s of t){if(s.status==="aborted")return re;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let s of t){let i=await s.key,a=await s.value;n.push({key:i,value:a})}return r.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let s of t){let{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return re;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(n[i.value]=a.value)}return{status:e.value,value:n}}},re=Object.freeze({status:"aborted"}),hr=r=>({status:"dirty",value:r}),De=r=>({status:"valid",value:r}),eo=r=>r.status==="aborted",to=r=>r.status==="dirty",Mt=r=>r.status==="valid",Zr=r=>typeof Promise<"u"&&r instanceof Promise;function Dn(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}function Tu(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t}var H;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e?.message})(H||(H={}));var Vr,Kr,Ge=class{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Su=(r,e)=>{if(Mt(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new ze(r.common.issues);return this._error=t,this._error}}};function oe(r){if(!r)return{};let{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(a,o)=>{var h,p;let{message:f}=r;return a.code==="invalid_enum_value"?{message:f??o.defaultError}:typeof o.data>"u"?{message:(h=f??n)!==null&&h!==void 0?h:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(p=f??t)!==null&&p!==void 0?p:o.defaultError}},description:s}}var ae=class{get description(){return this._def.description}_getType(e){return gt(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:gt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Be,ctx:{common:e.parent.common,data:e.data,parsedType:gt(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(Zr(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;let s={common:{issues:[],async:(n=t?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:gt(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Su(s,i)}"~validate"(e){var t,n;let s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:gt(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:s});return Mt(i)?{value:i.value}:{issues:s.common.issues}}catch(i){!((n=(t=i?.message)===null||t===void 0?void 0:t.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(i=>Mt(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:gt(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(Zr(s)?s:Promise.resolve(s));return Su(n,i)}refine(e,t){let n=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{let a=e(s),o=()=>i.addIssue({code:j.custom,...n(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(h=>h?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof t=="function"?t(n,s):t),!1))}_refinement(e){return new Ve({schema:this,typeName:te.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return We.create(this,this._def)}nullable(){return ot.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return bt.create(this)}promise(){return At.create(this,this._def)}or(e){return qt.create([this,e],this._def)}and(e){return Ft.create(this,e,this._def)}transform(e){return new Ve({...oe(this._def),schema:this,typeName:te.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new Zt({...oe(this._def),innerType:this,defaultValue:t,typeName:te.ZodDefault})}brand(){return new Wr({typeName:te.ZodBranded,type:this,...oe(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new Wt({...oe(this._def),innerType:this,catchValue:t,typeName:te.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Gr.create(this,e)}readonly(){return Gt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},tc=/^c[^\s-]{8,}$/i,rc=/^[0-9a-z]+$/,nc=/^[0-9A-HJKMNP-TV-Z]{26}$/i,sc=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ic=/^[a-z0-9_-]{21}$/i,oc=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,ac=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,uc=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,lc="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Xi,cc=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,hc=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,fc=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,dc=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,pc=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,mc=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Eu="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",gc=new RegExp(`^${Eu}$`);function Au(r){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`),e}function yc(r){return new RegExp(`^${Au(r)}$`)}function Nu(r){let e=`${Eu}T${Au(r)}`,t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function bc(r,e){return!!((e==="v4"||!e)&&cc.test(r)||(e==="v6"||!e)&&fc.test(r))}function vc(r,e){if(!oc.test(r))return!1;try{let[t]=r.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||!s.typ||!s.alg||e&&s.alg!==e)}catch{return!1}}function wc(r,e){return!!((e==="v4"||!e)&&hc.test(r)||(e==="v6"||!e)&&dc.test(r))}var Tt=class r extends ae{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==K.string){let i=this._getOrReturnCtx(e);return U(i,{code:j.invalid_type,expected:K.string,received:i.parsedType}),re}let n=new Be,s;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),U(s,{code:j.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),U(s,{code:j.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let a=e.data.length>i.value,o=e.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(e,s),a?U(s,{code:j.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&U(s,{code:j.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")uc.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"email",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")Xi||(Xi=new RegExp(lc,"u")),Xi.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"emoji",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")sc.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"uuid",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")ic.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"nanoid",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")tc.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"cuid",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")rc.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"cuid2",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")nc.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"ulid",code:j.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),U(s,{validation:"url",code:j.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"regex",code:j.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),U(s,{code:j.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),U(s,{code:j.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),U(s,{code:j.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?Nu(i).test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{code:j.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?gc.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{code:j.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?yc(i).test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{code:j.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?ac.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"duration",code:j.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?bc(e.data,i.version)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"ip",code:j.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?vc(e.data,i.alg)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"jwt",code:j.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?wc(e.data,i.version)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"cidr",code:j.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?pc.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"base64",code:j.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?mc.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"base64url",code:j.invalid_string,message:i.message}),n.dirty()):he.assertNever(i);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(s=>e.test(s),{validation:t,code:j.invalid_string,...H.errToObj(n)})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...H.errToObj(e)})}url(e){return this._addCheck({kind:"url",...H.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...H.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...H.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...H.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...H.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...H.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...H.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...H.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...H.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...H.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...H.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...H.errToObj(e)})}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...H.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...H.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...H.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...H.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...H.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...H.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...H.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...H.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...H.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...H.errToObj(t)})}nonempty(e){return this.min(1,H.errToObj(e))}trim(){return new r({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new r({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new r({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Tt.create=r=>{var e;return new Tt({checks:[],typeName:te.ZodString,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...oe(r)})};function Sc(r,e){let t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=t>n?t:n,i=parseInt(r.toFixed(s).replace(".","")),a=parseInt(e.toFixed(s).replace(".",""));return i%a/Math.pow(10,s)}var Rt=class r extends ae{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==K.number){let i=this._getOrReturnCtx(e);return U(i,{code:j.invalid_type,expected:K.number,received:i.parsedType}),re}let n,s=new Be;for(let i of this._def.checks)i.kind==="int"?he.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),U(n,{code:j.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),U(n,{code:j.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),U(n,{code:j.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?Sc(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),U(n,{code:j.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),U(n,{code:j.not_finite,message:i.message}),s.dirty()):he.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,H.toString(t))}gt(e,t){return this.setLimit("min",e,!1,H.toString(t))}lte(e,t){return this.setLimit("max",e,!0,H.toString(t))}lt(e,t){return this.setLimit("max",e,!1,H.toString(t))}setLimit(e,t,n,s){return new r({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:H.toString(s)}]})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:H.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:H.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:H.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:H.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:H.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:H.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:H.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:H.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:H.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&he.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}};Rt.create=r=>new Rt({checks:[],typeName:te.ZodNumber,coerce:r?.coerce||!1,...oe(r)});var Bt=class r extends ae{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==K.bigint)return this._getInvalidInput(e);let n,s=new Be;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),U(n,{code:j.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),U(n,{code:j.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),U(n,{code:j.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):he.assertNever(i);return{status:s.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return U(t,{code:j.invalid_type,expected:K.bigint,received:t.parsedType}),re}gte(e,t){return this.setLimit("min",e,!0,H.toString(t))}gt(e,t){return this.setLimit("min",e,!1,H.toString(t))}lte(e,t){return this.setLimit("max",e,!0,H.toString(t))}lt(e,t){return this.setLimit("max",e,!1,H.toString(t))}setLimit(e,t,n,s){return new r({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:H.toString(s)}]})}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:H.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:H.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:H.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:H.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:H.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Bt.create=r=>{var e;return new Bt({checks:[],typeName:te.ZodBigInt,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...oe(r)})};var $t=class extends ae{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==K.boolean){let n=this._getOrReturnCtx(e);return U(n,{code:j.invalid_type,expected:K.boolean,received:n.parsedType}),re}return De(e.data)}};$t.create=r=>new $t({typeName:te.ZodBoolean,coerce:r?.coerce||!1,...oe(r)});var Dt=class r extends ae{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==K.date){let i=this._getOrReturnCtx(e);return U(i,{code:j.invalid_type,expected:K.date,received:i.parsedType}),re}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return U(i,{code:j.invalid_date}),re}let n=new Be,s;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),U(s,{code:j.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),U(s,{code:j.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):he.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new r({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:H.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:H.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};Dt.create=r=>new Dt({checks:[],coerce:r?.coerce||!1,typeName:te.ZodDate,...oe(r)});var dr=class extends ae{_parse(e){if(this._getType(e)!==K.symbol){let n=this._getOrReturnCtx(e);return U(n,{code:j.invalid_type,expected:K.symbol,received:n.parsedType}),re}return De(e.data)}};dr.create=r=>new dr({typeName:te.ZodSymbol,...oe(r)});var jt=class extends ae{_parse(e){if(this._getType(e)!==K.undefined){let n=this._getOrReturnCtx(e);return U(n,{code:j.invalid_type,expected:K.undefined,received:n.parsedType}),re}return De(e.data)}};jt.create=r=>new jt({typeName:te.ZodUndefined,...oe(r)});var Qt=class extends ae{_parse(e){if(this._getType(e)!==K.null){let n=this._getOrReturnCtx(e);return U(n,{code:j.invalid_type,expected:K.null,received:n.parsedType}),re}return De(e.data)}};Qt.create=r=>new Qt({typeName:te.ZodNull,...oe(r)});var Et=class extends ae{constructor(){super(...arguments),this._any=!0}_parse(e){return De(e.data)}};Et.create=r=>new Et({typeName:te.ZodAny,...oe(r)});var yt=class extends ae{constructor(){super(...arguments),this._unknown=!0}_parse(e){return De(e.data)}};yt.create=r=>new yt({typeName:te.ZodUnknown,...oe(r)});var tt=class extends ae{_parse(e){let t=this._getOrReturnCtx(e);return U(t,{code:j.invalid_type,expected:K.never,received:t.parsedType}),re}};tt.create=r=>new tt({typeName:te.ZodNever,...oe(r)});var pr=class extends ae{_parse(e){if(this._getType(e)!==K.undefined){let n=this._getOrReturnCtx(e);return U(n,{code:j.invalid_type,expected:K.void,received:n.parsedType}),re}return De(e.data)}};pr.create=r=>new pr({typeName:te.ZodVoid,...oe(r)});var bt=class r extends ae{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==K.array)return U(t,{code:j.invalid_type,expected:K.array,received:t.parsedType}),re;if(s.exactLength!==null){let a=t.data.length>s.exactLength.value,o=t.data.length<s.exactLength.value;(a||o)&&(U(t,{code:a?j.too_big:j.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(U(t,{code:j.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(U(t,{code:j.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((a,o)=>s.type._parseAsync(new Ge(t,a,t.path,o)))).then(a=>Be.mergeArray(n,a));let i=[...t.data].map((a,o)=>s.type._parseSync(new Ge(t,a,t.path,o)));return Be.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new r({...this._def,minLength:{value:e,message:H.toString(t)}})}max(e,t){return new r({...this._def,maxLength:{value:e,message:H.toString(t)}})}length(e,t){return new r({...this._def,exactLength:{value:e,message:H.toString(t)}})}nonempty(e){return this.min(1,e)}};bt.create=(r,e)=>new bt({type:r,minLength:null,maxLength:null,exactLength:null,typeName:te.ZodArray,...oe(e)});function cr(r){if(r instanceof Ue){let e={};for(let t in r.shape){let n=r.shape[t];e[t]=We.create(cr(n))}return new Ue({...r._def,shape:()=>e})}else return r instanceof bt?new bt({...r._def,type:cr(r.element)}):r instanceof We?We.create(cr(r.unwrap())):r instanceof ot?ot.create(cr(r.unwrap())):r instanceof it?it.create(r.items.map(e=>cr(e))):r}var Ue=class r extends ae{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=he.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==K.object){let p=this._getOrReturnCtx(e);return U(p,{code:j.invalid_type,expected:K.object,received:p.parsedType}),re}let{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof tt&&this._def.unknownKeys==="strip"))for(let p in s.data)a.includes(p)||o.push(p);let h=[];for(let p of a){let f=i[p],y=s.data[p];h.push({key:{status:"valid",value:p},value:f._parse(new Ge(s,y,s.path,p)),alwaysSet:p in s.data})}if(this._def.catchall instanceof tt){let p=this._def.unknownKeys;if(p==="passthrough")for(let f of o)h.push({key:{status:"valid",value:f},value:{status:"valid",value:s.data[f]}});else if(p==="strict")o.length>0&&(U(s,{code:j.unrecognized_keys,keys:o}),n.dirty());else if(p!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let p=this._def.catchall;for(let f of o){let y=s.data[f];h.push({key:{status:"valid",value:f},value:p._parse(new Ge(s,y,s.path,f)),alwaysSet:f in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let p=[];for(let f of h){let y=await f.key,b=await f.value;p.push({key:y,value:b,alwaysSet:f.alwaysSet})}return p}).then(p=>Be.mergeObjectSync(n,p)):Be.mergeObjectSync(n,h)}get shape(){return this._def.shape()}strict(e){return H.errToObj,new r({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var s,i,a,o;let h=(a=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,t,n).message)!==null&&a!==void 0?a:n.defaultError;return t.code==="unrecognized_keys"?{message:(o=H.errToObj(e).message)!==null&&o!==void 0?o:h}:{message:h}}}:{}})}strip(){return new r({...this._def,unknownKeys:"strip"})}passthrough(){return new r({...this._def,unknownKeys:"passthrough"})}extend(e){return new r({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new r({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:te.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new r({...this._def,catchall:e})}pick(e){let t={};return he.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new r({...this._def,shape:()=>t})}omit(e){let t={};return he.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new r({...this._def,shape:()=>t})}deepPartial(){return cr(this)}partial(e){let t={};return he.objectKeys(this.shape).forEach(n=>{let s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}),new r({...this._def,shape:()=>t})}required(e){let t={};return he.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof We;)i=i._def.innerType;t[n]=i}}),new r({...this._def,shape:()=>t})}keyof(){return Pu(he.objectKeys(this.shape))}};Ue.create=(r,e)=>new Ue({shape:()=>r,unknownKeys:"strip",catchall:tt.create(),typeName:te.ZodObject,...oe(e)});Ue.strictCreate=(r,e)=>new Ue({shape:()=>r,unknownKeys:"strict",catchall:tt.create(),typeName:te.ZodObject,...oe(e)});Ue.lazycreate=(r,e)=>new Ue({shape:r,unknownKeys:"strip",catchall:tt.create(),typeName:te.ZodObject,...oe(e)});var qt=class extends ae{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;function s(i){for(let o of i)if(o.result.status==="valid")return o.result;for(let o of i)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;let a=i.map(o=>new ze(o.ctx.common.issues));return U(t,{code:j.invalid_union,unionErrors:a}),re}if(t.common.async)return Promise.all(n.map(async i=>{let a={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(s);{let i,a=[];for(let h of n){let p={...t,common:{...t.common,issues:[]},parent:null},f=h._parseSync({data:t.data,path:t.path,parent:p});if(f.status==="valid")return f;f.status==="dirty"&&!i&&(i={result:f,ctx:p}),p.common.issues.length&&a.push(p.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;let o=a.map(h=>new ze(h));return U(t,{code:j.invalid_union,unionErrors:o}),re}}get options(){return this._def.options}};qt.create=(r,e)=>new qt({options:r,typeName:te.ZodUnion,...oe(e)});var mt=r=>r instanceof Ut?mt(r.schema):r instanceof Ve?mt(r.innerType()):r instanceof zt?[r.value]:r instanceof Vt?r.options:r instanceof Kt?he.objectValues(r.enum):r instanceof Zt?mt(r._def.innerType):r instanceof jt?[void 0]:r instanceof Qt?[null]:r instanceof We?[void 0,...mt(r.unwrap())]:r instanceof ot?[null,...mt(r.unwrap())]:r instanceof Wr||r instanceof Gt?mt(r.unwrap()):r instanceof Wt?mt(r._def.innerType):[],jn=class r extends ae{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==K.object)return U(t,{code:j.invalid_type,expected:K.object,received:t.parsedType}),re;let n=this.discriminator,s=t.data[n],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(U(t,{code:j.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),re)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let s=new Map;for(let i of t){let a=mt(i.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let o of a){if(s.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);s.set(o,i)}}return new r({typeName:te.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...oe(n)})}};function ro(r,e){let t=gt(r),n=gt(e);if(r===e)return{valid:!0,data:r};if(t===K.object&&n===K.object){let s=he.objectKeys(e),i=he.objectKeys(r).filter(o=>s.indexOf(o)!==-1),a={...r,...e};for(let o of i){let h=ro(r[o],e[o]);if(!h.valid)return{valid:!1};a[o]=h.data}return{valid:!0,data:a}}else if(t===K.array&&n===K.array){if(r.length!==e.length)return{valid:!1};let s=[];for(let i=0;i<r.length;i++){let a=r[i],o=e[i],h=ro(a,o);if(!h.valid)return{valid:!1};s.push(h.data)}return{valid:!0,data:s}}else return t===K.date&&n===K.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}var Ft=class extends ae{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),s=(i,a)=>{if(eo(i)||eo(a))return re;let o=ro(i.value,a.value);return o.valid?((to(i)||to(a))&&t.dirty(),{status:t.value,value:o.data}):(U(n,{code:j.invalid_intersection_types}),re)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};Ft.create=(r,e,t)=>new Ft({left:r,right:e,typeName:te.ZodIntersection,...oe(t)});var it=class r extends ae{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==K.array)return U(n,{code:j.invalid_type,expected:K.array,received:n.parsedType}),re;if(n.data.length<this._def.items.length)return U(n,{code:j.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),re;!this._def.rest&&n.data.length>this._def.items.length&&(U(n,{code:j.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let i=[...n.data].map((a,o)=>{let h=this._def.items[o]||this._def.rest;return h?h._parse(new Ge(n,a,n.path,o)):null}).filter(a=>!!a);return n.common.async?Promise.all(i).then(a=>Be.mergeArray(t,a)):Be.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new r({...this._def,rest:e})}};it.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new it({items:r,typeName:te.ZodTuple,rest:null,...oe(e)})};var Qn=class r extends ae{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==K.object)return U(n,{code:j.invalid_type,expected:K.object,received:n.parsedType}),re;let s=[],i=this._def.keyType,a=this._def.valueType;for(let o in n.data)s.push({key:i._parse(new Ge(n,o,n.path,o)),value:a._parse(new Ge(n,n.data[o],n.path,o)),alwaysSet:o in n.data});return n.common.async?Be.mergeObjectAsync(t,s):Be.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof ae?new r({keyType:e,valueType:t,typeName:te.ZodRecord,...oe(n)}):new r({keyType:Tt.create(),valueType:e,typeName:te.ZodRecord,...oe(t)})}},mr=class extends ae{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==K.map)return U(n,{code:j.invalid_type,expected:K.map,received:n.parsedType}),re;let s=this._def.keyType,i=this._def.valueType,a=[...n.data.entries()].map(([o,h],p)=>({key:s._parse(new Ge(n,o,n.path,[p,"key"])),value:i._parse(new Ge(n,h,n.path,[p,"value"]))}));if(n.common.async){let o=new Map;return Promise.resolve().then(async()=>{for(let h of a){let p=await h.key,f=await h.value;if(p.status==="aborted"||f.status==="aborted")return re;(p.status==="dirty"||f.status==="dirty")&&t.dirty(),o.set(p.value,f.value)}return{status:t.value,value:o}})}else{let o=new Map;for(let h of a){let p=h.key,f=h.value;if(p.status==="aborted"||f.status==="aborted")return re;(p.status==="dirty"||f.status==="dirty")&&t.dirty(),o.set(p.value,f.value)}return{status:t.value,value:o}}}};mr.create=(r,e,t)=>new mr({valueType:e,keyType:r,typeName:te.ZodMap,...oe(t)});var gr=class r extends ae{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==K.set)return U(n,{code:j.invalid_type,expected:K.set,received:n.parsedType}),re;let s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(U(n,{code:j.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(U(n,{code:j.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());let i=this._def.valueType;function a(h){let p=new Set;for(let f of h){if(f.status==="aborted")return re;f.status==="dirty"&&t.dirty(),p.add(f.value)}return{status:t.value,value:p}}let o=[...n.data.values()].map((h,p)=>i._parse(new Ge(n,h,n.path,p)));return n.common.async?Promise.all(o).then(h=>a(h)):a(o)}min(e,t){return new r({...this._def,minSize:{value:e,message:H.toString(t)}})}max(e,t){return new r({...this._def,maxSize:{value:e,message:H.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};gr.create=(r,e)=>new gr({valueType:r,minSize:null,maxSize:null,typeName:te.ZodSet,...oe(e)});var qn=class r extends ae{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==K.function)return U(t,{code:j.invalid_type,expected:K.function,received:t.parsedType}),re;function n(o,h){return $n({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Bn(),fr].filter(p=>!!p),issueData:{code:j.invalid_arguments,argumentsError:h}})}function s(o,h){return $n({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Bn(),fr].filter(p=>!!p),issueData:{code:j.invalid_return_type,returnTypeError:h}})}let i={errorMap:t.common.contextualErrorMap},a=t.data;if(this._def.returns instanceof At){let o=this;return De(async function(...h){let p=new ze([]),f=await o._def.args.parseAsync(h,i).catch(w=>{throw p.addIssue(n(h,w)),p}),y=await Reflect.apply(a,this,f);return await o._def.returns._def.type.parseAsync(y,i).catch(w=>{throw p.addIssue(s(y,w)),p})})}else{let o=this;return De(function(...h){let p=o._def.args.safeParse(h,i);if(!p.success)throw new ze([n(h,p.error)]);let f=Reflect.apply(a,this,p.data),y=o._def.returns.safeParse(f,i);if(!y.success)throw new ze([s(f,y.error)]);return y.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new r({...this._def,args:it.create(e).rest(yt.create())})}returns(e){return new r({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new r({args:e||it.create([]).rest(yt.create()),returns:t||yt.create(),typeName:te.ZodFunction,...oe(n)})}},Ut=class extends ae{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};Ut.create=(r,e)=>new Ut({getter:r,typeName:te.ZodLazy,...oe(e)});var zt=class extends ae{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return U(t,{received:t.data,code:j.invalid_literal,expected:this._def.value}),re}return{status:"valid",value:e.data}}get value(){return this._def.value}};zt.create=(r,e)=>new zt({value:r,typeName:te.ZodLiteral,...oe(e)});function Pu(r,e){return new Vt({values:r,typeName:te.ZodEnum,...oe(e)})}var Vt=class r extends ae{constructor(){super(...arguments),Vr.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),n=this._def.values;return U(t,{expected:he.joinValues(n),received:t.parsedType,code:j.invalid_type}),re}if(Dn(this,Vr,"f")||Tu(this,Vr,new Set(this._def.values),"f"),!Dn(this,Vr,"f").has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return U(t,{received:t.data,code:j.invalid_enum_value,options:n}),re}return De(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return r.create(e,{...this._def,...t})}exclude(e,t=this._def){return r.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}};Vr=new WeakMap;Vt.create=Pu;var Kt=class extends ae{constructor(){super(...arguments),Kr.set(this,void 0)}_parse(e){let t=he.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==K.string&&n.parsedType!==K.number){let s=he.objectValues(t);return U(n,{expected:he.joinValues(s),received:n.parsedType,code:j.invalid_type}),re}if(Dn(this,Kr,"f")||Tu(this,Kr,new Set(he.getValidEnumValues(this._def.values)),"f"),!Dn(this,Kr,"f").has(e.data)){let s=he.objectValues(t);return U(n,{received:n.data,code:j.invalid_enum_value,options:s}),re}return De(e.data)}get enum(){return this._def.values}};Kr=new WeakMap;Kt.create=(r,e)=>new Kt({values:r,typeName:te.ZodNativeEnum,...oe(e)});var At=class extends ae{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==K.promise&&t.common.async===!1)return U(t,{code:j.invalid_type,expected:K.promise,received:t.parsedType}),re;let n=t.parsedType===K.promise?t.data:Promise.resolve(t.data);return De(n.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}};At.create=(r,e)=>new At({type:r,typeName:te.ZodPromise,...oe(e)});var Ve=class extends ae{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===te.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:a=>{U(n,a),a.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){let a=s.transform(n.data,i);if(n.common.async)return Promise.resolve(a).then(async o=>{if(t.value==="aborted")return re;let h=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return h.status==="aborted"?re:h.status==="dirty"||t.value==="dirty"?hr(h.value):h});{if(t.value==="aborted")return re;let o=this._def.schema._parseSync({data:a,path:n.path,parent:n});return o.status==="aborted"?re:o.status==="dirty"||t.value==="dirty"?hr(o.value):o}}if(s.type==="refinement"){let a=o=>{let h=s.refinement(o,i);if(n.common.async)return Promise.resolve(h);if(h instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){let o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?re:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?re:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(s.type==="transform")if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Mt(a))return a;let o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>Mt(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:t.value,value:o})):a);he.assertNever(s)}};Ve.create=(r,e,t)=>new Ve({schema:r,typeName:te.ZodEffects,effect:e,...oe(t)});Ve.createWithPreprocess=(r,e,t)=>new Ve({schema:e,effect:{type:"preprocess",transform:r},typeName:te.ZodEffects,...oe(t)});var We=class extends ae{_parse(e){return this._getType(e)===K.undefined?De(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};We.create=(r,e)=>new We({innerType:r,typeName:te.ZodOptional,...oe(e)});var ot=class extends ae{_parse(e){return this._getType(e)===K.null?De(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};ot.create=(r,e)=>new ot({innerType:r,typeName:te.ZodNullable,...oe(e)});var Zt=class extends ae{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===K.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};Zt.create=(r,e)=>new Zt({innerType:r,typeName:te.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...oe(e)});var Wt=class extends ae{_parse(e){let{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Zr(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ze(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ze(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};Wt.create=(r,e)=>new Wt({innerType:r,typeName:te.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...oe(e)});var yr=class extends ae{_parse(e){if(this._getType(e)!==K.nan){let n=this._getOrReturnCtx(e);return U(n,{code:j.invalid_type,expected:K.nan,received:n.parsedType}),re}return{status:"valid",value:e.data}}};yr.create=r=>new yr({typeName:te.ZodNaN,...oe(r)});var _c=Symbol("zod_brand"),Wr=class extends ae{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}},Gr=class r extends ae{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?re:i.status==="dirty"?(t.dirty(),hr(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{let s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?re:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,t){return new r({in:e,out:t,typeName:te.ZodPipeline})}},Gt=class extends ae{_parse(e){let t=this._def.innerType._parse(e),n=s=>(Mt(s)&&(s.value=Object.freeze(s.value)),s);return Zr(t)?t.then(s=>n(s)):n(t)}unwrap(){return this._def.innerType}};Gt.create=(r,e)=>new Gt({innerType:r,typeName:te.ZodReadonly,...oe(e)});function _u(r,e){let t=typeof r=="function"?r(e):typeof r=="string"?{message:r}:r;return typeof t=="string"?{message:t}:t}function Iu(r,e={},t){return r?Et.create().superRefine((n,s)=>{var i,a;let o=r(n);if(o instanceof Promise)return o.then(h=>{var p,f;if(!h){let y=_u(e,n),b=(f=(p=y.fatal)!==null&&p!==void 0?p:t)!==null&&f!==void 0?f:!0;s.addIssue({code:"custom",...y,fatal:b})}});if(!o){let h=_u(e,n),p=(a=(i=h.fatal)!==null&&i!==void 0?i:t)!==null&&a!==void 0?a:!0;s.addIssue({code:"custom",...h,fatal:p})}}):Et.create()}var xc={object:Ue.lazycreate},te;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(te||(te={}));var Cc=(r,e={message:`Input not instance of ${r.name}`})=>Iu(t=>t instanceof r,e),ku=Tt.create,Ou=Rt.create,Tc=yr.create,Ec=Bt.create,Lu=$t.create,Ac=Dt.create,Nc=dr.create,Pc=jt.create,Ic=Qt.create,kc=Et.create,Oc=yt.create,Lc=tt.create,Mc=pr.create,Rc=bt.create,Bc=Ue.create,$c=Ue.strictCreate,Dc=qt.create,jc=jn.create,Qc=Ft.create,qc=it.create,Fc=Qn.create,Uc=mr.create,zc=gr.create,Vc=qn.create,Kc=Ut.create,Zc=zt.create,Wc=Vt.create,Gc=Kt.create,Hc=At.create,xu=Ve.create,Jc=We.create,Xc=ot.create,Yc=Ve.createWithPreprocess,eh=Gr.create,th=()=>ku().optional(),rh=()=>Ou().optional(),nh=()=>Lu().optional(),sh={string:r=>Tt.create({...r,coerce:!0}),number:r=>Rt.create({...r,coerce:!0}),boolean:r=>$t.create({...r,coerce:!0}),bigint:r=>Bt.create({...r,coerce:!0}),date:r=>Dt.create({...r,coerce:!0})},ih=re,me=Object.freeze({__proto__:null,defaultErrorMap:fr,setErrorMap:Yl,getErrorMap:Bn,makeIssue:$n,EMPTY_PATH:ec,addIssueToContext:U,ParseStatus:Be,INVALID:re,DIRTY:hr,OK:De,isAborted:eo,isDirty:to,isValid:Mt,isAsync:Zr,get util(){return he},get objectUtil(){return Yi},ZodParsedType:K,getParsedType:gt,ZodType:ae,datetimeRegex:Nu,ZodString:Tt,ZodNumber:Rt,ZodBigInt:Bt,ZodBoolean:$t,ZodDate:Dt,ZodSymbol:dr,ZodUndefined:jt,ZodNull:Qt,ZodAny:Et,ZodUnknown:yt,ZodNever:tt,ZodVoid:pr,ZodArray:bt,ZodObject:Ue,ZodUnion:qt,ZodDiscriminatedUnion:jn,ZodIntersection:Ft,ZodTuple:it,ZodRecord:Qn,ZodMap:mr,ZodSet:gr,ZodFunction:qn,ZodLazy:Ut,ZodLiteral:zt,ZodEnum:Vt,ZodNativeEnum:Kt,ZodPromise:At,ZodEffects:Ve,ZodTransformer:Ve,ZodOptional:We,ZodNullable:ot,ZodDefault:Zt,ZodCatch:Wt,ZodNaN:yr,BRAND:_c,ZodBranded:Wr,ZodPipeline:Gr,ZodReadonly:Gt,custom:Iu,Schema:ae,ZodSchema:ae,late:xc,get ZodFirstPartyTypeKind(){return te},coerce:sh,any:kc,array:Rc,bigint:Ec,boolean:Lu,date:Ac,discriminatedUnion:jc,effect:xu,enum:Wc,function:Vc,instanceof:Cc,intersection:Qc,lazy:Kc,literal:Zc,map:Uc,nan:Tc,nativeEnum:Gc,never:Lc,null:Ic,nullable:Xc,number:Ou,object:Bc,oboolean:nh,onumber:rh,optional:Jc,ostring:th,pipeline:eh,preprocess:Yc,promise:Hc,record:Fc,set:zc,strictObject:$c,string:ku,symbol:Nc,transformer:xu,tuple:qc,undefined:Pc,union:Dc,unknown:Oc,void:Mc,NEVER:ih,ZodIssueCode:j,quotelessJson:Xl,ZodError:ze});var _e={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function Ce(r,e){return e.includes(r.columnType)}function oh(r){return"enumValues"in r&&Array.isArray(r.enumValues)&&r.enumValues.length>0}var ah=me.union([me.string(),me.number(),me.boolean(),me.null()]),uh=me.union([ah,me.record(me.any()),me.array(me.any())]),lh=me.custom(r=>r instanceof Buffer);function Mu(r,e){let t=e?.zodInstance??me,n=e?.coerce??{},s;return oh(r)&&(s=r.enumValues.length?t.enum(r.enumValues):t.string()),s||(Ce(r,["PgGeometry","PgPointTuple"])?s=t.tuple([t.number(),t.number()]):Ce(r,["PgGeometryObject","PgPointObject"])?s=t.object({x:t.number(),y:t.number()}):Ce(r,["PgHalfVector","PgVector"])?(s=t.array(t.number()),s=r.dimensions?s.length(r.dimensions):s):Ce(r,["PgLine"])?s=t.tuple([t.number(),t.number(),t.number()]):Ce(r,["PgLineABC"])?s=t.object({a:t.number(),b:t.number(),c:t.number()}):Ce(r,["PgArray"])?(s=t.array(Mu(r.baseColumn,t)),s=r.size?s.length(r.size):s):r.dataType==="array"?s=t.array(t.any()):r.dataType==="number"?s=ch(r,t,n):r.dataType==="bigint"?s=hh(r,t,n):r.dataType==="boolean"?s=n===!0||n.boolean?t.coerce.boolean():t.boolean():r.dataType==="date"?s=n===!0||n.date?t.coerce.date():t.date():r.dataType==="string"?s=fh(r,t,n):r.dataType==="json"?s=uh:r.dataType==="custom"?s=t.any():r.dataType==="buffer"&&(s=lh)),s||(s=t.any()),s}function ch(r,e,t){let n=r.getSQLType().includes("unsigned"),s,i,a=!1;Ce(r,["MySqlTinyInt","SingleStoreTinyInt"])?(s=n?0:_e.INT8_MIN,i=n?_e.INT8_UNSIGNED_MAX:_e.INT8_MAX,a=!0):Ce(r,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(s=n?0:_e.INT16_MIN,i=n?_e.INT16_UNSIGNED_MAX:_e.INT16_MAX,a=!0):Ce(r,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(s=n?0:_e.INT24_MIN,i=n?_e.INT24_UNSIGNED_MAX:_e.INT24_MAX,a=Ce(r,["MySqlMediumInt","SingleStoreMediumInt"])):Ce(r,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(s=n?0:_e.INT32_MIN,i=n?_e.INT32_UNSIGNED_MAX:_e.INT32_MAX,a=!0):Ce(r,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(s=n?0:_e.INT48_MIN,i=n?_e.INT48_UNSIGNED_MAX:_e.INT48_MAX):Ce(r,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(n=n||Ce(r,["MySqlSerial","SingleStoreSerial"]),s=n?0:Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,a=!0):Ce(r,["MySqlYear","SingleStoreYear"])?(s=1901,i=2155,a=!0):(s=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER);let o=t===!0||t?.number?e.coerce.number():e.number();return o=o.min(s).max(i),a?o.int():o}function hh(r,e,t){let n=r.getSQLType().includes("unsigned"),s=n?0n:_e.INT64_MIN,i=n?_e.INT64_UNSIGNED_MAX:_e.INT64_MAX;return(t===!0||t?.bigint?e.coerce.bigint():e.bigint()).min(s).max(i)}function fh(r,e,t){if(Ce(r,["PgUUID"]))return e.string().uuid();let n,s,i=!1;Ce(r,["PgVarchar","SQLiteText"])?n=r.length:Ce(r,["MySqlVarChar","SingleStoreVarChar"])?n=r.length??_e.INT16_UNSIGNED_MAX:Ce(r,["MySqlText","SingleStoreText"])&&(r.textType==="longtext"?n=_e.INT32_UNSIGNED_MAX:r.textType==="mediumtext"?n=_e.INT24_UNSIGNED_MAX:r.textType==="text"?n=_e.INT16_UNSIGNED_MAX:n=_e.INT8_UNSIGNED_MAX),Ce(r,["PgChar","MySqlChar","SingleStoreChar"])&&(n=r.length,i=!0),Ce(r,["PgBinaryVector"])&&(s=/^[01]+$/,n=r.dimensions);let a=t===!0||t?.string?e.coerce.string():e.string();return a=s?a.regex(s):a,n&&i?a.length(n):n?a.max(n):a}function Ru(r){return _s(r)?pn(r):va(r)}function Bu(r,e,t,n){let s={};for(let[i,a]of Object.entries(r)){if(!B(a,de)&&!B(a,V)&&!B(a,V.Aliased)&&typeof a=="object"){let y=_s(a)||ma(a)?Ru(a):a;s[i]=Bu(y,e[i]??{},t,n);continue}let o=e[i];if(o!==void 0&&typeof o!="function"){s[i]=o;continue}let h=B(a,de)?a:void 0,p=h?Mu(h,n):me.any(),f=typeof o=="function"?o(p):p;t.never(h)||(s[i]=f,h&&(t.nullable(h)&&(s[i]=s[i].nullable()),t.optional(h)&&(s[i]=s[i].optional())))}return me.object(s)}var dh={never:r=>r?.generated?.type==="always"||r?.generatedIdentity?.type==="always",optional:r=>!r.notNull||r.notNull&&r.hasDefault,nullable:r=>!r.notNull};var Ht=(r,e)=>{let t=Ru(r);return Bu(t,e??{},dh)};var no=_t("users",{id:dt("id").primaryKey(),email:ee("email").notNull().unique(),password:ee("password").notNull(),firstName:ee("first_name"),lastName:ee("last_name"),isActive:St("is_active").default(!0),createdAt:et("created_at").defaultNow()}),ph=_t("password_reset_tokens",{id:dt("id").primaryKey(),email:ee("email").notNull(),token:ee("token").notNull().unique(),expiresAt:et("expires_at").notNull(),used:St("used").default(!1),createdAt:et("created_at").defaultNow()}),mh=_t("franchises",{id:dt("id").primaryKey(),name:ee("name").notNull(),description:ee("description"),category:ee("category").notNull(),country:ee("country").notNull(),state:ee("state"),investmentRange:ee("investment_range"),imageUrl:ee("image_url"),contactEmail:ee("contact_email"),investmentMin:st("investment_min"),investmentMax:st("investment_max"),isActive:St("is_active").default(!0),createdAt:et("created_at").defaultNow()}),vt=_t("businesses",{id:dt("id").primaryKey(),userId:st("user_id").references(()=>no.id),name:ee("name").notNull(),description:ee("description"),category:ee("category").notNull(),country:ee("country").notNull(),state:ee("state"),price:st("price"),imageUrl:ee("image_url"),contactEmail:ee("contact_email"),package:ee("package"),yearEstablished:ee("year_established"),employees:ee("employees"),revenue:ee("revenue"),reason:ee("reason"),assets:ee("assets"),status:ee("status").default("pending"),paymentStatus:ee("payment_status").default("unpaid"),isActive:St("is_active").default(!1),createdAt:et("created_at").defaultNow()}),gh=_t("advertisements",{id:dt("id").primaryKey(),userId:st("user_id").references(()=>no.id),title:ee("title").notNull(),description:ee("description"),imageUrl:ee("image_url").notNull(),targetUrl:ee("target_url"),package:ee("package"),company:ee("company"),contactEmail:ee("contact_email"),contactPhone:ee("contact_phone"),budget:ee("budget"),status:ee("status").default("pending"),paymentStatus:ee("payment_status").default("unpaid"),isActive:St("is_active").default(!1),createdAt:et("created_at").defaultNow()}),yh=_t("inquiries",{id:dt("id").primaryKey(),name:ee("name").notNull(),email:ee("email").notNull(),phone:ee("phone"),subject:ee("subject").notNull(),message:ee("message").notNull(),franchiseId:st("franchise_id"),businessId:st("business_id"),status:ee("status").default("pending"),createdAt:et("created_at").defaultNow()}),c0=_t("sessions",{sid:bn("sid").primaryKey(),sess:yn("sess").notNull(),expire:et("expire").notNull()},r=>[wu("IDX_session_expire").on(r.expire)]),h0=Ht(no).pick({email:!0,password:!0,firstName:!0,lastName:!0}),f0=me.object({email:me.string().email(),password:me.string().min(6)}),d0=me.object({email:me.string().email(),password:me.string().min(6),firstName:me.string().min(1),lastName:me.string().min(1)}),p0=me.object({email:me.string().email()}),m0=me.object({token:me.string(),password:me.string().min(6)}),g0=Ht(ph).pick({email:!0,token:!0,expiresAt:!0}),y0=Ht(mh).omit({id:!0,createdAt:!0}),b0=Ht(vt).omit({id:!0,createdAt:!0}),v0=Ht(gh).omit({id:!0,createdAt:!0}),w0=Ht(yh).omit({id:!0,createdAt:!0});wt.fetchConnectionCache=!0;var bh=new lt({connectionString:process.env.DATABASE_URL,max:1}),$u=Rn(bh),vh=async r=>{let e={"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Content-Type","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Content-Type":"application/json"};if(r.httpMethod==="OPTIONS")return{statusCode:200,headers:e};try{if(r.httpMethod==="GET"){let{category:t,country:n,state:s,maxPrice:i}=r.queryStringParameters||{},a=$u.select().from(vt).where(pt(vt.isActive,!0)),o=[];t&&o.push(pt(vt.category,t)),n&&o.push(pt(vt.country,n)),s&&o.push(pt(vt.state,s)),i&&o.push(wn(vt.price,parseInt(i))),o.length>0&&(a=a.where(Lt(...o)));let h=await a;return{statusCode:200,headers:e,body:JSON.stringify(h)}}if(r.httpMethod==="POST"){let t=JSON.parse(r.body||"{}"),n=await $u.insert(vt).values(t).returning();return{statusCode:201,headers:e,body:JSON.stringify(n[0])}}return{statusCode:405,headers:e,body:JSON.stringify({error:"Method not allowed"})}}catch(t){return console.error("Error:",t),{statusCode:500,headers:e,body:JSON.stringify({error:"Internal server error"})}}};0&&(module.exports={handler});
/*! Bundled license information:

@neondatabase/serverless/index.mjs:
  (*! Bundled license information:
  
  ieee754/index.js:
    (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  
  buffer/index.js:
    (*!
     * The buffer module from node.js, for the browser.
     *
     * @author   Feross Aboukhadijeh <https://feross.org>
     * @license  MIT
     *)
  *)
*/
